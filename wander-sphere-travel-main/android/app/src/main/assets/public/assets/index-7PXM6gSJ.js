import{j as s,X as gr,T as ap,C as an,a as Yr,b as np,G as nn,A as ur,m as Q,L as op,B as Dr,H as Ht,M as us,U as go,c as ip,S as ei,d as zc,e as lp,f as ze,g as Ie,h as qc,W as Qr,i as cp,k as lt,l as dp,R as Wc,n as ti,P as Qe,o as ge,E as up,p as Xr,q as Hc,r as za,s as hp,t as mp,F as fp,u as pp,v as Wt,w as si,x as Vc,y as gp,z as xp,D as Be,N as vp,I as yp,J as ct,K as wp,O as ir,Q as Or,V as Da,Y as il,Z as ll,_ as bp,$ as cl,a0 as dl,a1 as Gc,a2 as jp,a3 as Kc,a4 as da,a5 as Np,a6 as Sp,a7 as _p,a8 as Cp,a9 as Oa,aa as ri,ab as Un,ac as Ep,ad as xo,ae as vo,af as yo,ag as kp,ah as Tp,ai as Pp,aj as ua,ak as Ap}from"./ui-vendor-C3ffZw99.js";import{c as Rp,a as u,R as F,b as Zr,v as Jc,d as Yc,e as Ip,g as Dp,r as Op,u as Ls,L as Ne,f as ai,N as Hs,h as Qc,i as on,B as Mp,j as Lp,k as $e}from"./react-vendor-CqcOUMrk.js";import{L as ea,M as $p,T as Fp,a as Er,P as Bn,u as Up}from"./map-vendor-cUMO2_P7.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}})();var ha={},ul;function Bp(){if(ul)return ha;ul=1;var t=Rp();return ha.createRoot=t.createRoot,ha.hydrateRoot=t.hydrateRoot,ha}var zp=Bp();const qp=1,Wp=1e6;let zn=0;function Hp(){return zn=(zn+1)%Number.MAX_SAFE_INTEGER,zn.toString()}const qn=new Map,hl=t=>{if(qn.has(t))return;const e=setTimeout(()=>{qn.delete(t),Mr({type:"REMOVE_TOAST",toastId:t})},Wp);qn.set(t,e)},Vp=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,qp)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(r=>r.id===e.toast.id?{...r,...e.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=e;return r?hl(r):t.toasts.forEach(a=>{hl(a.id)}),{...t,toasts:t.toasts.map(a=>a.id===r||r===void 0?{...a,open:!1}:a)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(r=>r.id!==e.toastId)}}},Ma=[];let La={toasts:[]};function Mr(t){La=Vp(La,t),Ma.forEach(e=>{e(La)})}function ee({...t}){const e=Hp(),r=n=>Mr({type:"UPDATE_TOAST",toast:{...n,id:e}}),a=()=>Mr({type:"DISMISS_TOAST",toastId:e});return Mr({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:n=>{n||a()}}}),{id:e,dismiss:a,update:r}}function Ct(){const[t,e]=u.useState(La);return u.useEffect(()=>(Ma.push(e),()=>{const r=Ma.indexOf(e);r>-1&&Ma.splice(r,1)}),[t]),{...t,toast:ee,dismiss:r=>Mr({type:"DISMISS_TOAST",toastId:r})}}function W(t,e,{checkForDefaultPrevented:r=!0}={}){return function(n){if(t?.(n),r===!1||!n.defaultPrevented)return e?.(n)}}function ml(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function ln(...t){return e=>{let r=!1;const a=t.map(n=>{const o=ml(n,e);return!r&&typeof o=="function"&&(r=!0),o});if(r)return()=>{for(let n=0;n<a.length;n++){const o=a[n];typeof o=="function"?o():ml(t[n],null)}}}}function xe(...t){return u.useCallback(ln(...t),t)}function Gp(t,e){const r=u.createContext(e),a=o=>{const{children:i,...l}=o,c=u.useMemo(()=>l,Object.values(l));return s.jsx(r.Provider,{value:c,children:i})};a.displayName=t+"Provider";function n(o){const i=u.useContext(r);if(i)return i;if(e!==void 0)return e;throw new Error(`\`${o}\` must be used within \`${t}\``)}return[a,n]}function Xe(t,e=[]){let r=[];function a(o,i){const l=u.createContext(i),c=r.length;r=[...r,i];const d=m=>{const{scope:p,children:f,...b}=m,g=p?.[t]?.[c]||l,y=u.useMemo(()=>b,Object.values(b));return s.jsx(g.Provider,{value:y,children:f})};d.displayName=o+"Provider";function h(m,p){const f=p?.[t]?.[c]||l,b=u.useContext(f);if(b)return b;if(i!==void 0)return i;throw new Error(`\`${m}\` must be used within \`${o}\``)}return[d,h]}const n=()=>{const o=r.map(i=>u.createContext(i));return function(l){const c=l?.[t]||o;return u.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return n.scopeName=t,[a,Kp(n,...e)]}function Kp(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const a=t.map(n=>({useScope:n(),scopeName:n.scopeName}));return function(o){const i=a.reduce((l,{useScope:c,scopeName:d})=>{const m=c(o)[`__scope${d}`];return{...l,...m}},{});return u.useMemo(()=>({[`__scope${e.scopeName}`]:i}),[i])}};return r.scopeName=e.scopeName,r}function Rs(t){const e=Yp(t),r=u.forwardRef((a,n)=>{const{children:o,...i}=a,l=u.Children.toArray(o),c=l.find(Xp);if(c){const d=c.props.children,h=l.map(m=>m===c?u.Children.count(d)>1?u.Children.only(null):u.isValidElement(d)?d.props.children:null:m);return s.jsx(e,{...i,ref:n,children:u.isValidElement(d)?u.cloneElement(d,void 0,h):null})}return s.jsx(e,{...i,ref:n,children:o})});return r.displayName=`${t}.Slot`,r}var Jp=Rs("Slot");function Yp(t){const e=u.forwardRef((r,a)=>{const{children:n,...o}=r;if(u.isValidElement(n)){const i=eg(n),l=Zp(o,n.props);return n.type!==u.Fragment&&(l.ref=a?ln(a,i):i),u.cloneElement(n,l)}return u.Children.count(n)>1?u.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var Xc=Symbol("radix.slottable");function Qp(t){const e=({children:r})=>s.jsx(s.Fragment,{children:r});return e.displayName=`${t}.Slottable`,e.__radixId=Xc,e}function Xp(t){return u.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===Xc}function Zp(t,e){const r={...e};for(const a in e){const n=t[a],o=e[a];/^on[A-Z]/.test(a)?n&&o?r[a]=(...l)=>{const c=o(...l);return n(...l),c}:n&&(r[a]=n):a==="style"?r[a]={...n,...o}:a==="className"&&(r[a]=[n,o].filter(Boolean).join(" "))}return{...t,...r}}function eg(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}function cn(t){const e=t+"CollectionProvider",[r,a]=Xe(e),[n,o]=r(e,{collectionRef:{current:null},itemMap:new Map}),i=g=>{const{scope:y,children:w}=g,v=F.useRef(null),x=F.useRef(new Map).current;return s.jsx(n,{scope:y,itemMap:x,collectionRef:v,children:w})};i.displayName=e;const l=t+"CollectionSlot",c=Rs(l),d=F.forwardRef((g,y)=>{const{scope:w,children:v}=g,x=o(l,w),j=xe(y,x.collectionRef);return s.jsx(c,{ref:j,children:v})});d.displayName=l;const h=t+"CollectionItemSlot",m="data-radix-collection-item",p=Rs(h),f=F.forwardRef((g,y)=>{const{scope:w,children:v,...x}=g,j=F.useRef(null),N=xe(y,j),S=o(h,w);return F.useEffect(()=>(S.itemMap.set(j,{ref:j,...x}),()=>void S.itemMap.delete(j))),s.jsx(p,{[m]:"",ref:N,children:v})});f.displayName=h;function b(g){const y=o(t+"CollectionConsumer",g);return F.useCallback(()=>{const v=y.collectionRef.current;if(!v)return[];const x=Array.from(v.querySelectorAll(`[${m}]`));return Array.from(y.itemMap.values()).sort((S,_)=>x.indexOf(S.ref.current)-x.indexOf(_.ref.current))},[y.collectionRef,y.itemMap])}return[{Provider:i,Slot:d,ItemSlot:f},b,a]}var tg=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ne=tg.reduce((t,e)=>{const r=Rs(`Primitive.${e}`),a=u.forwardRef((n,o)=>{const{asChild:i,...l}=n,c=i?r:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),s.jsx(c,{...l,ref:o})});return a.displayName=`Primitive.${e}`,{...t,[e]:a}},{});function ni(t,e){t&&Zr.flushSync(()=>t.dispatchEvent(e))}function Ke(t){const e=u.useRef(t);return u.useEffect(()=>{e.current=t}),u.useMemo(()=>(...r)=>e.current?.(...r),[])}function sg(t,e=globalThis?.document){const r=Ke(t);u.useEffect(()=>{const a=n=>{n.key==="Escape"&&r(n)};return e.addEventListener("keydown",a,{capture:!0}),()=>e.removeEventListener("keydown",a,{capture:!0})},[r,e])}var rg="DismissableLayer",wo="dismissableLayer.update",ag="dismissableLayer.pointerDownOutside",ng="dismissableLayer.focusOutside",fl,Zc=u.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),xr=u.forwardRef((t,e)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:a,onPointerDownOutside:n,onFocusOutside:o,onInteractOutside:i,onDismiss:l,...c}=t,d=u.useContext(Zc),[h,m]=u.useState(null),p=h?.ownerDocument??globalThis?.document,[,f]=u.useState({}),b=xe(e,_=>m(_)),g=Array.from(d.layers),[y]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),w=g.indexOf(y),v=h?g.indexOf(h):-1,x=d.layersWithOutsidePointerEventsDisabled.size>0,j=v>=w,N=ig(_=>{const E=_.target,k=[...d.branches].some(A=>A.contains(E));!j||k||(n?.(_),i?.(_),_.defaultPrevented||l?.())},p),S=lg(_=>{const E=_.target;[...d.branches].some(A=>A.contains(E))||(o?.(_),i?.(_),_.defaultPrevented||l?.())},p);return sg(_=>{v===d.layers.size-1&&(a?.(_),!_.defaultPrevented&&l&&(_.preventDefault(),l()))},p),u.useEffect(()=>{if(h)return r&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(fl=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(h)),d.layers.add(h),pl(),()=>{r&&d.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=fl)}},[h,p,r,d]),u.useEffect(()=>()=>{h&&(d.layers.delete(h),d.layersWithOutsidePointerEventsDisabled.delete(h),pl())},[h,d]),u.useEffect(()=>{const _=()=>f({});return document.addEventListener(wo,_),()=>document.removeEventListener(wo,_)},[]),s.jsx(ne.div,{...c,ref:b,style:{pointerEvents:x?j?"auto":"none":void 0,...t.style},onFocusCapture:W(t.onFocusCapture,S.onFocusCapture),onBlurCapture:W(t.onBlurCapture,S.onBlurCapture),onPointerDownCapture:W(t.onPointerDownCapture,N.onPointerDownCapture)})});xr.displayName=rg;var og="DismissableLayerBranch",ed=u.forwardRef((t,e)=>{const r=u.useContext(Zc),a=u.useRef(null),n=xe(e,a);return u.useEffect(()=>{const o=a.current;if(o)return r.branches.add(o),()=>{r.branches.delete(o)}},[r.branches]),s.jsx(ne.div,{...t,ref:n})});ed.displayName=og;function ig(t,e=globalThis?.document){const r=Ke(t),a=u.useRef(!1),n=u.useRef(()=>{});return u.useEffect(()=>{const o=l=>{if(l.target&&!a.current){let c=function(){td(ag,r,d,{discrete:!0})};const d={originalEvent:l};l.pointerType==="touch"?(e.removeEventListener("click",n.current),n.current=c,e.addEventListener("click",n.current,{once:!0})):c()}else e.removeEventListener("click",n.current);a.current=!1},i=window.setTimeout(()=>{e.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(i),e.removeEventListener("pointerdown",o),e.removeEventListener("click",n.current)}},[e,r]),{onPointerDownCapture:()=>a.current=!0}}function lg(t,e=globalThis?.document){const r=Ke(t),a=u.useRef(!1);return u.useEffect(()=>{const n=o=>{o.target&&!a.current&&td(ng,r,{originalEvent:o},{discrete:!1})};return e.addEventListener("focusin",n),()=>e.removeEventListener("focusin",n)},[e,r]),{onFocusCapture:()=>a.current=!0,onBlurCapture:()=>a.current=!1}}function pl(){const t=new CustomEvent(wo);document.dispatchEvent(t)}function td(t,e,r,{discrete:a}){const n=r.originalEvent.target,o=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});e&&n.addEventListener(t,e,{once:!0}),a?ni(n,o):n.dispatchEvent(o)}var cg=xr,dg=ed,De=globalThis?.document?u.useLayoutEffect:()=>{},ug="Portal",ta=u.forwardRef((t,e)=>{const{container:r,...a}=t,[n,o]=u.useState(!1);De(()=>o(!0),[]);const i=r||n&&globalThis?.document?.body;return i?Jc.createPortal(s.jsx(ne.div,{...a,ref:e}),i):null});ta.displayName=ug;function hg(t,e){return u.useReducer((r,a)=>e[r][a]??r,t)}var ht=t=>{const{present:e,children:r}=t,a=mg(e),n=typeof r=="function"?r({present:a.isPresent}):u.Children.only(r),o=xe(a.ref,fg(n));return typeof r=="function"||a.isPresent?u.cloneElement(n,{ref:o}):null};ht.displayName="Presence";function mg(t){const[e,r]=u.useState(),a=u.useRef(null),n=u.useRef(t),o=u.useRef("none"),i=t?"mounted":"unmounted",[l,c]=hg(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return u.useEffect(()=>{const d=ma(a.current);o.current=l==="mounted"?d:"none"},[l]),De(()=>{const d=a.current,h=n.current;if(h!==t){const p=o.current,f=ma(d);t?c("MOUNT"):f==="none"||d?.display==="none"?c("UNMOUNT"):c(h&&p!==f?"ANIMATION_OUT":"UNMOUNT"),n.current=t}},[t,c]),De(()=>{if(e){let d;const h=e.ownerDocument.defaultView??window,m=f=>{const g=ma(a.current).includes(f.animationName);if(f.target===e&&g&&(c("ANIMATION_END"),!n.current)){const y=e.style.animationFillMode;e.style.animationFillMode="forwards",d=h.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=y)})}},p=f=>{f.target===e&&(o.current=ma(a.current))};return e.addEventListener("animationstart",p),e.addEventListener("animationcancel",m),e.addEventListener("animationend",m),()=>{h.clearTimeout(d),e.removeEventListener("animationstart",p),e.removeEventListener("animationcancel",m),e.removeEventListener("animationend",m)}}else c("ANIMATION_END")},[e,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:u.useCallback(d=>{a.current=d?getComputedStyle(d):null,r(d)},[])}}function ma(t){return t?.animationName||"none"}function fg(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var pg=Yc[" useInsertionEffect ".trim().toString()]||De;function Vt({prop:t,defaultProp:e,onChange:r=()=>{},caller:a}){const[n,o,i]=gg({defaultProp:e,onChange:r}),l=t!==void 0,c=l?t:n;{const h=u.useRef(t!==void 0);u.useEffect(()=>{const m=h.current;m!==l&&console.warn(`${a} is changing from ${m?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),h.current=l},[l,a])}const d=u.useCallback(h=>{if(l){const m=xg(h)?h(t):h;m!==t&&i.current?.(m)}else o(h)},[l,t,o,i]);return[c,d]}function gg({defaultProp:t,onChange:e}){const[r,a]=u.useState(t),n=u.useRef(r),o=u.useRef(e);return pg(()=>{o.current=e},[e]),u.useEffect(()=>{n.current!==r&&(o.current?.(r),n.current=r)},[r,n]),[r,a,o]}function xg(t){return typeof t=="function"}var sd=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),vg="VisuallyHidden",dn=u.forwardRef((t,e)=>s.jsx(ne.span,{...t,ref:e,style:{...sd,...t.style}}));dn.displayName=vg;var yg=dn,oi="ToastProvider",[ii,wg,bg]=cn("Toast"),[rd,LC]=Xe("Toast",[bg]),[jg,un]=rd(oi),ad=t=>{const{__scopeToast:e,label:r="Notification",duration:a=5e3,swipeDirection:n="right",swipeThreshold:o=50,children:i}=t,[l,c]=u.useState(null),[d,h]=u.useState(0),m=u.useRef(!1),p=u.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${oi}\`. Expected non-empty \`string\`.`),s.jsx(ii.Provider,{scope:e,children:s.jsx(jg,{scope:e,label:r,duration:a,swipeDirection:n,swipeThreshold:o,toastCount:d,viewport:l,onViewportChange:c,onToastAdd:u.useCallback(()=>h(f=>f+1),[]),onToastRemove:u.useCallback(()=>h(f=>f-1),[]),isFocusedToastEscapeKeyDownRef:m,isClosePausedRef:p,children:i})})};ad.displayName=oi;var nd="ToastViewport",Ng=["F8"],bo="toast.viewportPause",jo="toast.viewportResume",od=u.forwardRef((t,e)=>{const{__scopeToast:r,hotkey:a=Ng,label:n="Notifications ({hotkey})",...o}=t,i=un(nd,r),l=wg(r),c=u.useRef(null),d=u.useRef(null),h=u.useRef(null),m=u.useRef(null),p=xe(e,m,i.onViewportChange),f=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),b=i.toastCount>0;u.useEffect(()=>{const y=w=>{a.length!==0&&a.every(x=>w[x]||w.code===x)&&m.current?.focus()};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[a]),u.useEffect(()=>{const y=c.current,w=m.current;if(b&&y&&w){const v=()=>{if(!i.isClosePausedRef.current){const S=new CustomEvent(bo);w.dispatchEvent(S),i.isClosePausedRef.current=!0}},x=()=>{if(i.isClosePausedRef.current){const S=new CustomEvent(jo);w.dispatchEvent(S),i.isClosePausedRef.current=!1}},j=S=>{!y.contains(S.relatedTarget)&&x()},N=()=>{y.contains(document.activeElement)||x()};return y.addEventListener("focusin",v),y.addEventListener("focusout",j),y.addEventListener("pointermove",v),y.addEventListener("pointerleave",N),window.addEventListener("blur",v),window.addEventListener("focus",x),()=>{y.removeEventListener("focusin",v),y.removeEventListener("focusout",j),y.removeEventListener("pointermove",v),y.removeEventListener("pointerleave",N),window.removeEventListener("blur",v),window.removeEventListener("focus",x)}}},[b,i.isClosePausedRef]);const g=u.useCallback(({tabbingDirection:y})=>{const v=l().map(x=>{const j=x.ref.current,N=[j,...Mg(j)];return y==="forwards"?N:N.reverse()});return(y==="forwards"?v.reverse():v).flat()},[l]);return u.useEffect(()=>{const y=m.current;if(y){const w=v=>{const x=v.altKey||v.ctrlKey||v.metaKey;if(v.key==="Tab"&&!x){const N=document.activeElement,S=v.shiftKey;if(v.target===y&&S){d.current?.focus();return}const k=g({tabbingDirection:S?"backwards":"forwards"}),A=k.findIndex(B=>B===N);Wn(k.slice(A+1))?v.preventDefault():S?d.current?.focus():h.current?.focus()}};return y.addEventListener("keydown",w),()=>y.removeEventListener("keydown",w)}},[l,g]),s.jsxs(dg,{ref:c,role:"region","aria-label":n.replace("{hotkey}",f),tabIndex:-1,style:{pointerEvents:b?void 0:"none"},children:[b&&s.jsx(No,{ref:d,onFocusFromOutsideViewport:()=>{const y=g({tabbingDirection:"forwards"});Wn(y)}}),s.jsx(ii.Slot,{scope:r,children:s.jsx(ne.ol,{tabIndex:-1,...o,ref:p})}),b&&s.jsx(No,{ref:h,onFocusFromOutsideViewport:()=>{const y=g({tabbingDirection:"backwards"});Wn(y)}})]})});od.displayName=nd;var id="ToastFocusProxy",No=u.forwardRef((t,e)=>{const{__scopeToast:r,onFocusFromOutsideViewport:a,...n}=t,o=un(id,r);return s.jsx(dn,{"aria-hidden":!0,tabIndex:0,...n,ref:e,style:{position:"fixed"},onFocus:i=>{const l=i.relatedTarget;!o.viewport?.contains(l)&&a()}})});No.displayName=id;var sa="Toast",Sg="toast.swipeStart",_g="toast.swipeMove",Cg="toast.swipeCancel",Eg="toast.swipeEnd",ld=u.forwardRef((t,e)=>{const{forceMount:r,open:a,defaultOpen:n,onOpenChange:o,...i}=t,[l,c]=Vt({prop:a,defaultProp:n??!0,onChange:o,caller:sa});return s.jsx(ht,{present:r||l,children:s.jsx(Pg,{open:l,...i,ref:e,onClose:()=>c(!1),onPause:Ke(t.onPause),onResume:Ke(t.onResume),onSwipeStart:W(t.onSwipeStart,d=>{d.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:W(t.onSwipeMove,d=>{const{x:h,y:m}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","move"),d.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${h}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${m}px`)}),onSwipeCancel:W(t.onSwipeCancel,d=>{d.currentTarget.setAttribute("data-swipe","cancel"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:W(t.onSwipeEnd,d=>{const{x:h,y:m}=d.detail.delta;d.currentTarget.setAttribute("data-swipe","end"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),d.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),d.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${h}px`),d.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${m}px`),c(!1)})})})});ld.displayName=sa;var[kg,Tg]=rd(sa,{onClose(){}}),Pg=u.forwardRef((t,e)=>{const{__scopeToast:r,type:a="foreground",duration:n,open:o,onClose:i,onEscapeKeyDown:l,onPause:c,onResume:d,onSwipeStart:h,onSwipeMove:m,onSwipeCancel:p,onSwipeEnd:f,...b}=t,g=un(sa,r),[y,w]=u.useState(null),v=xe(e,O=>w(O)),x=u.useRef(null),j=u.useRef(null),N=n||g.duration,S=u.useRef(0),_=u.useRef(N),E=u.useRef(0),{onToastAdd:k,onToastRemove:A}=g,B=Ke(()=>{y?.contains(document.activeElement)&&g.viewport?.focus(),i()}),$=u.useCallback(O=>{!O||O===1/0||(window.clearTimeout(E.current),S.current=new Date().getTime(),E.current=window.setTimeout(B,O))},[B]);u.useEffect(()=>{const O=g.viewport;if(O){const Y=()=>{$(_.current),d?.()},z=()=>{const R=new Date().getTime()-S.current;_.current=_.current-R,window.clearTimeout(E.current),c?.()};return O.addEventListener(bo,z),O.addEventListener(jo,Y),()=>{O.removeEventListener(bo,z),O.removeEventListener(jo,Y)}}},[g.viewport,N,c,d,$]),u.useEffect(()=>{o&&!g.isClosePausedRef.current&&$(N)},[o,N,g.isClosePausedRef,$]),u.useEffect(()=>(k(),()=>A()),[k,A]);const H=u.useMemo(()=>y?pd(y):null,[y]);return g.viewport?s.jsxs(s.Fragment,{children:[H&&s.jsx(Ag,{__scopeToast:r,role:"status","aria-live":a==="foreground"?"assertive":"polite","aria-atomic":!0,children:H}),s.jsx(kg,{scope:r,onClose:B,children:Zr.createPortal(s.jsx(ii.ItemSlot,{scope:r,children:s.jsx(cg,{asChild:!0,onEscapeKeyDown:W(l,()=>{g.isFocusedToastEscapeKeyDownRef.current||B(),g.isFocusedToastEscapeKeyDownRef.current=!1}),children:s.jsx(ne.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":o?"open":"closed","data-swipe-direction":g.swipeDirection,...b,ref:v,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:W(t.onKeyDown,O=>{O.key==="Escape"&&(l?.(O.nativeEvent),O.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,B()))}),onPointerDown:W(t.onPointerDown,O=>{O.button===0&&(x.current={x:O.clientX,y:O.clientY})}),onPointerMove:W(t.onPointerMove,O=>{if(!x.current)return;const Y=O.clientX-x.current.x,z=O.clientY-x.current.y,R=!!j.current,M=["left","right"].includes(g.swipeDirection),C=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,q=M?C(0,Y):0,T=M?0:C(0,z),U=O.pointerType==="touch"?10:2,X={x:q,y:T},de={originalEvent:O,delta:X};R?(j.current=X,fa(_g,m,de,{discrete:!1})):gl(X,g.swipeDirection,U)?(j.current=X,fa(Sg,h,de,{discrete:!1}),O.target.setPointerCapture(O.pointerId)):(Math.abs(Y)>U||Math.abs(z)>U)&&(x.current=null)}),onPointerUp:W(t.onPointerUp,O=>{const Y=j.current,z=O.target;if(z.hasPointerCapture(O.pointerId)&&z.releasePointerCapture(O.pointerId),j.current=null,x.current=null,Y){const R=O.currentTarget,M={originalEvent:O,delta:Y};gl(Y,g.swipeDirection,g.swipeThreshold)?fa(Eg,f,M,{discrete:!0}):fa(Cg,p,M,{discrete:!0}),R.addEventListener("click",C=>C.preventDefault(),{once:!0})}})})})}),g.viewport)})]}):null}),Ag=t=>{const{__scopeToast:e,children:r,...a}=t,n=un(sa,e),[o,i]=u.useState(!1),[l,c]=u.useState(!1);return Dg(()=>i(!0)),u.useEffect(()=>{const d=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(d)},[]),l?null:s.jsx(ta,{asChild:!0,children:s.jsx(dn,{...a,children:o&&s.jsxs(s.Fragment,{children:[n.label," ",r]})})})},Rg="ToastTitle",cd=u.forwardRef((t,e)=>{const{__scopeToast:r,...a}=t;return s.jsx(ne.div,{...a,ref:e})});cd.displayName=Rg;var Ig="ToastDescription",dd=u.forwardRef((t,e)=>{const{__scopeToast:r,...a}=t;return s.jsx(ne.div,{...a,ref:e})});dd.displayName=Ig;var ud="ToastAction",hd=u.forwardRef((t,e)=>{const{altText:r,...a}=t;return r.trim()?s.jsx(fd,{altText:r,asChild:!0,children:s.jsx(li,{...a,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${ud}\`. Expected non-empty \`string\`.`),null)});hd.displayName=ud;var md="ToastClose",li=u.forwardRef((t,e)=>{const{__scopeToast:r,...a}=t,n=Tg(md,r);return s.jsx(fd,{asChild:!0,children:s.jsx(ne.button,{type:"button",...a,ref:e,onClick:W(t.onClick,n.onClose)})})});li.displayName=md;var fd=u.forwardRef((t,e)=>{const{__scopeToast:r,altText:a,...n}=t;return s.jsx(ne.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":a||void 0,...n,ref:e})});function pd(t){const e=[];return Array.from(t.childNodes).forEach(a=>{if(a.nodeType===a.TEXT_NODE&&a.textContent&&e.push(a.textContent),Og(a)){const n=a.ariaHidden||a.hidden||a.style.display==="none",o=a.dataset.radixToastAnnounceExclude==="";if(!n)if(o){const i=a.dataset.radixToastAnnounceAlt;i&&e.push(i)}else e.push(...pd(a))}}),e}function fa(t,e,r,{discrete:a}){const n=r.originalEvent.currentTarget,o=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:r});e&&n.addEventListener(t,e,{once:!0}),a?ni(n,o):n.dispatchEvent(o)}var gl=(t,e,r=0)=>{const a=Math.abs(t.x),n=Math.abs(t.y),o=a>n;return e==="left"||e==="right"?o&&a>r:!o&&n>r};function Dg(t=()=>{}){const e=Ke(t);De(()=>{let r=0,a=0;return r=window.requestAnimationFrame(()=>a=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(a)}},[e])}function Og(t){return t.nodeType===t.ELEMENT_NODE}function Mg(t){const e=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:a=>{const n=a.tagName==="INPUT"&&a.type==="hidden";return a.disabled||a.hidden||n?NodeFilter.FILTER_SKIP:a.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)e.push(r.currentNode);return e}function Wn(t){const e=document.activeElement;return t.some(r=>r===e?!0:(r.focus(),document.activeElement!==e))}var Lg=ad,gd=od,xd=ld,vd=cd,yd=dd,wd=hd,bd=li;function jd(t){var e,r,a="";if(typeof t=="string"||typeof t=="number")a+=t;else if(typeof t=="object")if(Array.isArray(t)){var n=t.length;for(e=0;e<n;e++)t[e]&&(r=jd(t[e]))&&(a&&(a+=" "),a+=r)}else for(r in t)t[r]&&(a&&(a+=" "),a+=r);return a}function Nd(){for(var t,e,r=0,a="",n=arguments.length;r<n;r++)(t=arguments[r])&&(e=jd(t))&&(a&&(a+=" "),a+=e);return a}const xl=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,vl=Nd,ra=(t,e)=>r=>{var a;if(e?.variants==null)return vl(t,r?.class,r?.className);const{variants:n,defaultVariants:o}=e,i=Object.keys(n).map(d=>{const h=r?.[d],m=o?.[d];if(h===null)return null;const p=xl(h)||xl(m);return n[d][p]}),l=r&&Object.entries(r).reduce((d,h)=>{let[m,p]=h;return p===void 0||(d[m]=p),d},{}),c=e==null||(a=e.compoundVariants)===null||a===void 0?void 0:a.reduce((d,h)=>{let{class:m,className:p,...f}=h;return Object.entries(f).every(b=>{let[g,y]=b;return Array.isArray(y)?y.includes({...o,...l}[g]):{...o,...l}[g]===y})?[...d,m,p]:d},[]);return vl(t,i,c,r?.class,r?.className)},ci="-",$g=t=>{const e=Ug(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:a}=t;return{getClassGroupId:i=>{const l=i.split(ci);return l[0]===""&&l.length!==1&&l.shift(),Sd(l,e)||Fg(i)},getConflictingClassGroupIds:(i,l)=>{const c=r[i]||[];return l&&a[i]?[...c,...a[i]]:c}}},Sd=(t,e)=>{if(t.length===0)return e.classGroupId;const r=t[0],a=e.nextPart.get(r),n=a?Sd(t.slice(1),a):void 0;if(n)return n;if(e.validators.length===0)return;const o=t.join(ci);return e.validators.find(({validator:i})=>i(o))?.classGroupId},yl=/^\[(.+)\]$/,Fg=t=>{if(yl.test(t)){const e=yl.exec(t)[1],r=e?.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},Ug=t=>{const{theme:e,prefix:r}=t,a={nextPart:new Map,validators:[]};return zg(Object.entries(t.classGroups),r).forEach(([o,i])=>{So(i,a,o,e)}),a},So=(t,e,r,a)=>{t.forEach(n=>{if(typeof n=="string"){const o=n===""?e:wl(e,n);o.classGroupId=r;return}if(typeof n=="function"){if(Bg(n)){So(n(a),e,r,a);return}e.validators.push({validator:n,classGroupId:r});return}Object.entries(n).forEach(([o,i])=>{So(i,wl(e,o),r,a)})})},wl=(t,e)=>{let r=t;return e.split(ci).forEach(a=>{r.nextPart.has(a)||r.nextPart.set(a,{nextPart:new Map,validators:[]}),r=r.nextPart.get(a)}),r},Bg=t=>t.isThemeGetter,zg=(t,e)=>e?t.map(([r,a])=>{const n=a.map(o=>typeof o=="string"?e+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(([i,l])=>[e+i,l])):o);return[r,n]}):t,qg=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,a=new Map;const n=(o,i)=>{r.set(o,i),e++,e>t&&(e=0,a=r,r=new Map)};return{get(o){let i=r.get(o);if(i!==void 0)return i;if((i=a.get(o))!==void 0)return n(o,i),i},set(o,i){r.has(o)?r.set(o,i):n(o,i)}}},_d="!",Wg=t=>{const{separator:e,experimentalParseClassName:r}=t,a=e.length===1,n=e[0],o=e.length,i=l=>{const c=[];let d=0,h=0,m;for(let y=0;y<l.length;y++){let w=l[y];if(d===0){if(w===n&&(a||l.slice(y,y+o)===e)){c.push(l.slice(h,y)),h=y+o;continue}if(w==="/"){m=y;continue}}w==="["?d++:w==="]"&&d--}const p=c.length===0?l:l.substring(h),f=p.startsWith(_d),b=f?p.substring(1):p,g=m&&m>h?m-h:void 0;return{modifiers:c,hasImportantModifier:f,baseClassName:b,maybePostfixModifierPosition:g}};return r?l=>r({className:l,parseClassName:i}):i},Hg=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(a=>{a[0]==="["?(e.push(...r.sort(),a),r=[]):r.push(a)}),e.push(...r.sort()),e},Vg=t=>({cache:qg(t.cacheSize),parseClassName:Wg(t),...$g(t)}),Gg=/\s+/,Kg=(t,e)=>{const{parseClassName:r,getClassGroupId:a,getConflictingClassGroupIds:n}=e,o=[],i=t.trim().split(Gg);let l="";for(let c=i.length-1;c>=0;c-=1){const d=i[c],{modifiers:h,hasImportantModifier:m,baseClassName:p,maybePostfixModifierPosition:f}=r(d);let b=!!f,g=a(b?p.substring(0,f):p);if(!g){if(!b){l=d+(l.length>0?" "+l:l);continue}if(g=a(p),!g){l=d+(l.length>0?" "+l:l);continue}b=!1}const y=Hg(h).join(":"),w=m?y+_d:y,v=w+g;if(o.includes(v))continue;o.push(v);const x=n(g,b);for(let j=0;j<x.length;++j){const N=x[j];o.push(w+N)}l=d+(l.length>0?" "+l:l)}return l};function Jg(){let t=0,e,r,a="";for(;t<arguments.length;)(e=arguments[t++])&&(r=Cd(e))&&(a&&(a+=" "),a+=r);return a}const Cd=t=>{if(typeof t=="string")return t;let e,r="";for(let a=0;a<t.length;a++)t[a]&&(e=Cd(t[a]))&&(r&&(r+=" "),r+=e);return r};function Yg(t,...e){let r,a,n,o=i;function i(c){const d=e.reduce((h,m)=>m(h),t());return r=Vg(d),a=r.cache.get,n=r.cache.set,o=l,l(c)}function l(c){const d=a(c);if(d)return d;const h=Kg(c,r);return n(c,h),h}return function(){return o(Jg.apply(null,arguments))}}const Ce=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},Ed=/^\[(?:([a-z-]+):)?(.+)\]$/i,Qg=/^\d+\/\d+$/,Xg=new Set(["px","full","screen"]),Zg=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,ex=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,tx=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,sx=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,rx=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Ut=t=>lr(t)||Xg.has(t)||Qg.test(t),rs=t=>vr(t,"length",ux),lr=t=>!!t&&!Number.isNaN(Number(t)),Hn=t=>vr(t,"number",lr),kr=t=>!!t&&Number.isInteger(Number(t)),ax=t=>t.endsWith("%")&&lr(t.slice(0,-1)),me=t=>Ed.test(t),as=t=>Zg.test(t),nx=new Set(["length","size","percentage"]),ox=t=>vr(t,nx,kd),ix=t=>vr(t,"position",kd),lx=new Set(["image","url"]),cx=t=>vr(t,lx,mx),dx=t=>vr(t,"",hx),Tr=()=>!0,vr=(t,e,r)=>{const a=Ed.exec(t);return a?a[1]?typeof e=="string"?a[1]===e:e.has(a[1]):r(a[2]):!1},ux=t=>ex.test(t)&&!tx.test(t),kd=()=>!1,hx=t=>sx.test(t),mx=t=>rx.test(t),fx=()=>{const t=Ce("colors"),e=Ce("spacing"),r=Ce("blur"),a=Ce("brightness"),n=Ce("borderColor"),o=Ce("borderRadius"),i=Ce("borderSpacing"),l=Ce("borderWidth"),c=Ce("contrast"),d=Ce("grayscale"),h=Ce("hueRotate"),m=Ce("invert"),p=Ce("gap"),f=Ce("gradientColorStops"),b=Ce("gradientColorStopPositions"),g=Ce("inset"),y=Ce("margin"),w=Ce("opacity"),v=Ce("padding"),x=Ce("saturate"),j=Ce("scale"),N=Ce("sepia"),S=Ce("skew"),_=Ce("space"),E=Ce("translate"),k=()=>["auto","contain","none"],A=()=>["auto","hidden","clip","visible","scroll"],B=()=>["auto",me,e],$=()=>[me,e],H=()=>["",Ut,rs],O=()=>["auto",lr,me],Y=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],z=()=>["solid","dashed","dotted","double","none"],R=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],M=()=>["start","end","center","between","around","evenly","stretch"],C=()=>["","0",me],q=()=>["auto","avoid","all","avoid-page","page","left","right","column"],T=()=>[lr,me];return{cacheSize:500,separator:":",theme:{colors:[Tr],spacing:[Ut,rs],blur:["none","",as,me],brightness:T(),borderColor:[t],borderRadius:["none","","full",as,me],borderSpacing:$(),borderWidth:H(),contrast:T(),grayscale:C(),hueRotate:T(),invert:C(),gap:$(),gradientColorStops:[t],gradientColorStopPositions:[ax,rs],inset:B(),margin:B(),opacity:T(),padding:$(),saturate:T(),scale:T(),sepia:C(),skew:T(),space:$(),translate:$()},classGroups:{aspect:[{aspect:["auto","square","video",me]}],container:["container"],columns:[{columns:[as]}],"break-after":[{"break-after":q()}],"break-before":[{"break-before":q()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Y(),me]}],overflow:[{overflow:A()}],"overflow-x":[{"overflow-x":A()}],"overflow-y":[{"overflow-y":A()}],overscroll:[{overscroll:k()}],"overscroll-x":[{"overscroll-x":k()}],"overscroll-y":[{"overscroll-y":k()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",kr,me]}],basis:[{basis:B()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",me]}],grow:[{grow:C()}],shrink:[{shrink:C()}],order:[{order:["first","last","none",kr,me]}],"grid-cols":[{"grid-cols":[Tr]}],"col-start-end":[{col:["auto",{span:["full",kr,me]},me]}],"col-start":[{"col-start":O()}],"col-end":[{"col-end":O()}],"grid-rows":[{"grid-rows":[Tr]}],"row-start-end":[{row:["auto",{span:[kr,me]},me]}],"row-start":[{"row-start":O()}],"row-end":[{"row-end":O()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",me]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",me]}],gap:[{gap:[p]}],"gap-x":[{"gap-x":[p]}],"gap-y":[{"gap-y":[p]}],"justify-content":[{justify:["normal",...M()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...M(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...M(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[v]}],px:[{px:[v]}],py:[{py:[v]}],ps:[{ps:[v]}],pe:[{pe:[v]}],pt:[{pt:[v]}],pr:[{pr:[v]}],pb:[{pb:[v]}],pl:[{pl:[v]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[_]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[_]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",me,e]}],"min-w":[{"min-w":[me,e,"min","max","fit"]}],"max-w":[{"max-w":[me,e,"none","full","min","max","fit","prose",{screen:[as]},as]}],h:[{h:[me,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[me,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[me,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[me,e,"auto","min","max","fit"]}],"font-size":[{text:["base",as,rs]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Hn]}],"font-family":[{font:[Tr]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",me]}],"line-clamp":[{"line-clamp":["none",lr,Hn]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Ut,me]}],"list-image":[{"list-image":["none",me]}],"list-style-type":[{list:["none","disc","decimal",me]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[w]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[w]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...z(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Ut,rs]}],"underline-offset":[{"underline-offset":["auto",Ut,me]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:$()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",me]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",me]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[w]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Y(),ix]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",ox]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},cx]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[b]}],"gradient-via-pos":[{via:[b]}],"gradient-to-pos":[{to:[b]}],"gradient-from":[{from:[f]}],"gradient-via":[{via:[f]}],"gradient-to":[{to:[f]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[w]}],"border-style":[{border:[...z(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[w]}],"divide-style":[{divide:z()}],"border-color":[{border:[n]}],"border-color-x":[{"border-x":[n]}],"border-color-y":[{"border-y":[n]}],"border-color-s":[{"border-s":[n]}],"border-color-e":[{"border-e":[n]}],"border-color-t":[{"border-t":[n]}],"border-color-r":[{"border-r":[n]}],"border-color-b":[{"border-b":[n]}],"border-color-l":[{"border-l":[n]}],"divide-color":[{divide:[n]}],"outline-style":[{outline:["",...z()]}],"outline-offset":[{"outline-offset":[Ut,me]}],"outline-w":[{outline:[Ut,rs]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:H()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[w]}],"ring-offset-w":[{"ring-offset":[Ut,rs]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",as,dx]}],"shadow-color":[{shadow:[Tr]}],opacity:[{opacity:[w]}],"mix-blend":[{"mix-blend":[...R(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":R()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[a]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",as,me]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[h]}],invert:[{invert:[m]}],saturate:[{saturate:[x]}],sepia:[{sepia:[N]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[a]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[h]}],"backdrop-invert":[{"backdrop-invert":[m]}],"backdrop-opacity":[{"backdrop-opacity":[w]}],"backdrop-saturate":[{"backdrop-saturate":[x]}],"backdrop-sepia":[{"backdrop-sepia":[N]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",me]}],duration:[{duration:T()}],ease:[{ease:["linear","in","out","in-out",me]}],delay:[{delay:T()}],animate:[{animate:["none","spin","ping","pulse","bounce",me]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[j]}],"scale-x":[{"scale-x":[j]}],"scale-y":[{"scale-y":[j]}],rotate:[{rotate:[kr,me]}],"translate-x":[{"translate-x":[E]}],"translate-y":[{"translate-y":[E]}],"skew-x":[{"skew-x":[S]}],"skew-y":[{"skew-y":[S]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",me]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",me]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":$()}],"scroll-mx":[{"scroll-mx":$()}],"scroll-my":[{"scroll-my":$()}],"scroll-ms":[{"scroll-ms":$()}],"scroll-me":[{"scroll-me":$()}],"scroll-mt":[{"scroll-mt":$()}],"scroll-mr":[{"scroll-mr":$()}],"scroll-mb":[{"scroll-mb":$()}],"scroll-ml":[{"scroll-ml":$()}],"scroll-p":[{"scroll-p":$()}],"scroll-px":[{"scroll-px":$()}],"scroll-py":[{"scroll-py":$()}],"scroll-ps":[{"scroll-ps":$()}],"scroll-pe":[{"scroll-pe":$()}],"scroll-pt":[{"scroll-pt":$()}],"scroll-pr":[{"scroll-pr":$()}],"scroll-pb":[{"scroll-pb":$()}],"scroll-pl":[{"scroll-pl":$()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",me]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Ut,rs,Hn]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},px=Yg(fx);function Z(...t){return px(Nd(t))}const gx=Lg,Td=u.forwardRef(({className:t,...e},r)=>s.jsx(gd,{ref:r,className:Z("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));Td.displayName=gd.displayName;const xx=ra("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Pd=u.forwardRef(({className:t,variant:e,...r},a)=>s.jsx(xd,{ref:a,className:Z(xx({variant:e}),t),...r}));Pd.displayName=xd.displayName;const vx=u.forwardRef(({className:t,...e},r)=>s.jsx(wd,{ref:r,className:Z("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...e}));vx.displayName=wd.displayName;const Ad=u.forwardRef(({className:t,...e},r)=>s.jsx(bd,{ref:r,className:Z("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:s.jsx(gr,{className:"h-4 w-4"})}));Ad.displayName=bd.displayName;const Rd=u.forwardRef(({className:t,...e},r)=>s.jsx(vd,{ref:r,className:Z("text-sm font-semibold",t),...e}));Rd.displayName=vd.displayName;const Id=u.forwardRef(({className:t,...e},r)=>s.jsx(yd,{ref:r,className:Z("text-sm opacity-90",t),...e}));Id.displayName=yd.displayName;function yx(){const{toasts:t}=Ct();return s.jsxs(gx,{children:[t.map(function({id:e,title:r,description:a,action:n,...o}){return s.jsxs(Pd,{...o,children:[s.jsxs("div",{className:"grid gap-1",children:[r&&s.jsx(Rd,{children:r}),a&&s.jsx(Id,{children:a})]}),n,s.jsx(Ad,{})]},e)}),s.jsx(Td,{})]})}const wx=ra("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),P=u.forwardRef(({className:t,variant:e,size:r,asChild:a=!1,...n},o)=>{const i=a?Jp:"button";return s.jsx(i,{className:Z(wx({variant:e,size:r,className:t})),ref:o,...n})});P.displayName="Button";const V=u.forwardRef(({className:t,...e},r)=>s.jsx("div",{ref:r,className:Z("rounded-lg border bg-card text-card-foreground shadow-sm",t),...e}));V.displayName="Card";const _e=u.forwardRef(({className:t,...e},r)=>s.jsx("div",{ref:r,className:Z("flex flex-col space-y-1.5 p-6",t),...e}));_e.displayName="CardHeader";const Ee=u.forwardRef(({className:t,...e},r)=>s.jsx("h3",{ref:r,className:Z("text-2xl font-semibold leading-none tracking-tight",t),...e}));Ee.displayName="CardTitle";const bx=u.forwardRef(({className:t,...e},r)=>s.jsx("p",{ref:r,className:Z("text-sm text-muted-foreground",t),...e}));bx.displayName="CardDescription";const G=u.forwardRef(({className:t,...e},r)=>s.jsx("div",{ref:r,className:Z("p-6 pt-0",t),...e}));G.displayName="CardContent";const Dd=u.forwardRef(({className:t,...e},r)=>s.jsx("div",{ref:r,className:Z("flex items-center p-6 pt-0",t),...e}));Dd.displayName="CardFooter";class jx extends u.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e,errorInfo:null}}componentDidCatch(e,r){console.error("ErrorBoundary caught an error",e,r),this.setState({error:e,errorInfo:r})}resetErrorBoundary=()=>{this.setState({hasError:!1,error:null,errorInfo:null})};render(){return this.state.hasError?this.props.fallback?this.props.fallback:s.jsxs(V,{className:"w-full max-w-md mx-auto my-8 bg-red-50/50 shadow-lg",children:[s.jsx(_e,{className:"bg-red-50 text-red-700",children:s.jsxs(Ee,{className:"flex items-center gap-2",children:[s.jsx(ap,{className:"h-5 w-5"}),"Something went wrong"]})}),s.jsx(G,{className:"pt-6",children:s.jsxs("div",{className:"text-sm text-gray-600 mb-4",children:[this.state.error&&s.jsx("p",{className:"font-medium mb-2",children:this.state.error.toString()}),!1]})}),s.jsxs(Dd,{className:"flex justify-end gap-2 bg-gray-50",children:[s.jsx(P,{variant:"outline",onClick:()=>window.location.reload(),children:"Reload Page"}),s.jsx(P,{onClick:this.resetErrorBoundary,children:"Try Again"})]})]}):this.props.children}}var bl=["light","dark"],Nx="(prefers-color-scheme: dark)",Sx=u.createContext(void 0),_x={setTheme:t=>{},themes:[]},Cx=()=>{var t;return(t=u.useContext(Sx))!=null?t:_x};u.memo(({forcedTheme:t,storageKey:e,attribute:r,enableSystem:a,enableColorScheme:n,defaultTheme:o,value:i,attrs:l,nonce:c})=>{let d=o==="system",h=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${l.map(b=>`'${b}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,m=n?bl.includes(o)&&o?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${o}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",p=(b,g=!1,y=!0)=>{let w=i?i[b]:b,v=g?b+"|| ''":`'${w}'`,x="";return n&&y&&!g&&bl.includes(b)&&(x+=`d.style.colorScheme = '${b}';`),r==="class"?g||w?x+=`c.add(${v})`:x+="null":w&&(x+=`d[s](n,${v})`),x},f=t?`!function(){${h}${p(t)}}()`:a?`!function(){try{${h}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${d})){var t='${Nx}',m=window.matchMedia(t);if(m.media!==t||m.matches){${p("dark")}}else{${p("light")}}}else if(e){${i?`var x=${JSON.stringify(i)};`:""}${p(i?"x[e]":"e",!0)}}${d?"":"else{"+p(o,!1,!1)+"}"}${m}}catch(e){}}()`:`!function(){try{${h}var e=localStorage.getItem('${e}');if(e){${i?`var x=${JSON.stringify(i)};`:""}${p(i?"x[e]":"e",!0)}}else{${p(o,!1,!1)};}${m}}catch(t){}}();`;return u.createElement("script",{nonce:c,dangerouslySetInnerHTML:{__html:f}})});var Ex=t=>{switch(t){case"success":return Px;case"info":return Rx;case"warning":return Ax;case"error":return Ix;default:return null}},kx=Array(12).fill(0),Tx=({visible:t,className:e})=>F.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":t},F.createElement("div",{className:"sonner-spinner"},kx.map((r,a)=>F.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${a}`})))),Px=F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},F.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Ax=F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},F.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),Rx=F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},F.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Ix=F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},F.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Dx=F.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},F.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),F.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),Ox=()=>{let[t,e]=F.useState(document.hidden);return F.useEffect(()=>{let r=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),t},_o=1,Mx=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let e=this.subscribers.indexOf(t);this.subscribers.splice(e,1)}),this.publish=t=>{this.subscribers.forEach(e=>e(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var e;let{message:r,...a}=t,n=typeof t?.id=="number"||((e=t.id)==null?void 0:e.length)>0?t.id:_o++,o=this.toasts.find(l=>l.id===n),i=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(n)&&this.dismissedToasts.delete(n),o?this.toasts=this.toasts.map(l=>l.id===n?(this.publish({...l,...t,id:n,title:r}),{...l,...t,id:n,dismissible:i,title:r}):l):this.addToast({title:r,...a,dismissible:i,id:n}),n},this.dismiss=t=>(this.dismissedToasts.add(t),t||this.toasts.forEach(e=>{this.subscribers.forEach(r=>r({id:e.id,dismiss:!0}))}),this.subscribers.forEach(e=>e({id:t,dismiss:!0})),t),this.message=(t,e)=>this.create({...e,message:t}),this.error=(t,e)=>this.create({...e,message:t,type:"error"}),this.success=(t,e)=>this.create({...e,type:"success",message:t}),this.info=(t,e)=>this.create({...e,type:"info",message:t}),this.warning=(t,e)=>this.create({...e,type:"warning",message:t}),this.loading=(t,e)=>this.create({...e,type:"loading",message:t}),this.promise=(t,e)=>{if(!e)return;let r;e.loading!==void 0&&(r=this.create({...e,promise:t,type:"loading",message:e.loading,description:typeof e.description!="function"?e.description:void 0}));let a=t instanceof Promise?t:t(),n=r!==void 0,o,i=a.then(async c=>{if(o=["resolve",c],F.isValidElement(c))n=!1,this.create({id:r,type:"default",message:c});else if($x(c)&&!c.ok){n=!1;let d=typeof e.error=="function"?await e.error(`HTTP error! status: ${c.status}`):e.error,h=typeof e.description=="function"?await e.description(`HTTP error! status: ${c.status}`):e.description;this.create({id:r,type:"error",message:d,description:h})}else if(e.success!==void 0){n=!1;let d=typeof e.success=="function"?await e.success(c):e.success,h=typeof e.description=="function"?await e.description(c):e.description;this.create({id:r,type:"success",message:d,description:h})}}).catch(async c=>{if(o=["reject",c],e.error!==void 0){n=!1;let d=typeof e.error=="function"?await e.error(c):e.error,h=typeof e.description=="function"?await e.description(c):e.description;this.create({id:r,type:"error",message:d,description:h})}}).finally(()=>{var c;n&&(this.dismiss(r),r=void 0),(c=e.finally)==null||c.call(e)}),l=()=>new Promise((c,d)=>i.then(()=>o[0]==="reject"?d(o[1]):c(o[1])).catch(d));return typeof r!="string"&&typeof r!="number"?{unwrap:l}:Object.assign(r,{unwrap:l})},this.custom=(t,e)=>{let r=e?.id||_o++;return this.create({jsx:t(r),id:r,...e}),r},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Ye=new Mx,Lx=(t,e)=>{let r=e?.id||_o++;return Ye.addToast({title:t,...e,id:r}),r},$x=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",Fx=Lx,Ux=()=>Ye.toasts,Bx=()=>Ye.getActiveToasts();Object.assign(Fx,{success:Ye.success,info:Ye.info,warning:Ye.warning,error:Ye.error,custom:Ye.custom,message:Ye.message,promise:Ye.promise,dismiss:Ye.dismiss,loading:Ye.loading},{getHistory:Ux,getToasts:Bx});function zx(t,{insertAt:e}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",e==="top"&&r.firstChild?r.insertBefore(a,r.firstChild):r.appendChild(a),a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t))}zx(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function pa(t){return t.label!==void 0}var qx=3,Wx="32px",Hx="16px",jl=4e3,Vx=356,Gx=14,Kx=20,Jx=200;function xt(...t){return t.filter(Boolean).join(" ")}function Yx(t){let[e,r]=t.split("-"),a=[];return e&&a.push(e),r&&a.push(r),a}var Qx=t=>{var e,r,a,n,o,i,l,c,d,h,m;let{invert:p,toast:f,unstyled:b,interacting:g,setHeights:y,visibleToasts:w,heights:v,index:x,toasts:j,expanded:N,removeToast:S,defaultRichColors:_,closeButton:E,style:k,cancelButtonStyle:A,actionButtonStyle:B,className:$="",descriptionClassName:H="",duration:O,position:Y,gap:z,loadingIcon:R,expandByDefault:M,classNames:C,icons:q,closeButtonAriaLabel:T="Close toast",pauseWhenPageIsHidden:U}=t,[X,de]=F.useState(null),[I,L]=F.useState(null),[D,ie]=F.useState(!1),[oe,ce]=F.useState(!1),[ve,ke]=F.useState(!1),[qe,Ft]=F.useState(!1),[Sr,Bs]=F.useState(!1),[_r,Ln]=F.useState(0),[Kf,tl]=F.useState(0),Cr=F.useRef(f.duration||O||jl),sl=F.useRef(null),ws=F.useRef(null),Jf=x===0,Yf=x+1<=w,nt=f.type,zs=f.dismissible!==!1,Qf=f.className||"",Xf=f.descriptionClassName||"",ca=F.useMemo(()=>v.findIndex(ue=>ue.toastId===f.id)||0,[v,f.id]),Zf=F.useMemo(()=>{var ue;return(ue=f.closeButton)!=null?ue:E},[f.closeButton,E]),rl=F.useMemo(()=>f.duration||O||jl,[f.duration,O]),$n=F.useRef(0),qs=F.useRef(0),al=F.useRef(0),Ws=F.useRef(null),[ep,tp]=Y.split("-"),nl=F.useMemo(()=>v.reduce((ue,je,Te)=>Te>=ca?ue:ue+je.height,0),[v,ca]),ol=Ox(),sp=f.invert||p,Fn=nt==="loading";qs.current=F.useMemo(()=>ca*z+nl,[ca,nl]),F.useEffect(()=>{Cr.current=rl},[rl]),F.useEffect(()=>{ie(!0)},[]),F.useEffect(()=>{let ue=ws.current;if(ue){let je=ue.getBoundingClientRect().height;return tl(je),y(Te=>[{toastId:f.id,height:je,position:f.position},...Te]),()=>y(Te=>Te.filter(ft=>ft.toastId!==f.id))}},[y,f.id]),F.useLayoutEffect(()=>{if(!D)return;let ue=ws.current,je=ue.style.height;ue.style.height="auto";let Te=ue.getBoundingClientRect().height;ue.style.height=je,tl(Te),y(ft=>ft.find(pt=>pt.toastId===f.id)?ft.map(pt=>pt.toastId===f.id?{...pt,height:Te}:pt):[{toastId:f.id,height:Te,position:f.position},...ft])},[D,f.title,f.description,y,f.id]);let es=F.useCallback(()=>{ce(!0),Ln(qs.current),y(ue=>ue.filter(je=>je.toastId!==f.id)),setTimeout(()=>{S(f)},Jx)},[f,S,y,qs]);F.useEffect(()=>{if(f.promise&&nt==="loading"||f.duration===1/0||f.type==="loading")return;let ue;return N||g||U&&ol?(()=>{if(al.current<$n.current){let je=new Date().getTime()-$n.current;Cr.current=Cr.current-je}al.current=new Date().getTime()})():Cr.current!==1/0&&($n.current=new Date().getTime(),ue=setTimeout(()=>{var je;(je=f.onAutoClose)==null||je.call(f,f),es()},Cr.current)),()=>clearTimeout(ue)},[N,g,f,nt,U,ol,es]),F.useEffect(()=>{f.delete&&es()},[es,f.delete]);function rp(){var ue,je,Te;return q!=null&&q.loading?F.createElement("div",{className:xt(C?.loader,(ue=f?.classNames)==null?void 0:ue.loader,"sonner-loader"),"data-visible":nt==="loading"},q.loading):R?F.createElement("div",{className:xt(C?.loader,(je=f?.classNames)==null?void 0:je.loader,"sonner-loader"),"data-visible":nt==="loading"},R):F.createElement(Tx,{className:xt(C?.loader,(Te=f?.classNames)==null?void 0:Te.loader),visible:nt==="loading"})}return F.createElement("li",{tabIndex:0,ref:ws,className:xt($,Qf,C?.toast,(e=f?.classNames)==null?void 0:e.toast,C?.default,C?.[nt],(r=f?.classNames)==null?void 0:r[nt]),"data-sonner-toast":"","data-rich-colors":(a=f.richColors)!=null?a:_,"data-styled":!(f.jsx||f.unstyled||b),"data-mounted":D,"data-promise":!!f.promise,"data-swiped":Sr,"data-removed":oe,"data-visible":Yf,"data-y-position":ep,"data-x-position":tp,"data-index":x,"data-front":Jf,"data-swiping":ve,"data-dismissible":zs,"data-type":nt,"data-invert":sp,"data-swipe-out":qe,"data-swipe-direction":I,"data-expanded":!!(N||M&&D),style:{"--index":x,"--toasts-before":x,"--z-index":j.length-x,"--offset":`${oe?_r:qs.current}px`,"--initial-height":M?"auto":`${Kf}px`,...k,...f.style},onDragEnd:()=>{ke(!1),de(null),Ws.current=null},onPointerDown:ue=>{Fn||!zs||(sl.current=new Date,Ln(qs.current),ue.target.setPointerCapture(ue.pointerId),ue.target.tagName!=="BUTTON"&&(ke(!0),Ws.current={x:ue.clientX,y:ue.clientY}))},onPointerUp:()=>{var ue,je,Te,ft;if(qe||!zs)return;Ws.current=null;let pt=Number(((ue=ws.current)==null?void 0:ue.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),ts=Number(((je=ws.current)==null?void 0:je.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),bs=new Date().getTime()-((Te=sl.current)==null?void 0:Te.getTime()),gt=X==="x"?pt:ts,ss=Math.abs(gt)/bs;if(Math.abs(gt)>=Kx||ss>.11){Ln(qs.current),(ft=f.onDismiss)==null||ft.call(f,f),L(X==="x"?pt>0?"right":"left":ts>0?"down":"up"),es(),Ft(!0),Bs(!1);return}ke(!1),de(null)},onPointerMove:ue=>{var je,Te,ft,pt;if(!Ws.current||!zs||((je=window.getSelection())==null?void 0:je.toString().length)>0)return;let ts=ue.clientY-Ws.current.y,bs=ue.clientX-Ws.current.x,gt=(Te=t.swipeDirections)!=null?Te:Yx(Y);!X&&(Math.abs(bs)>1||Math.abs(ts)>1)&&de(Math.abs(bs)>Math.abs(ts)?"x":"y");let ss={x:0,y:0};X==="y"?(gt.includes("top")||gt.includes("bottom"))&&(gt.includes("top")&&ts<0||gt.includes("bottom")&&ts>0)&&(ss.y=ts):X==="x"&&(gt.includes("left")||gt.includes("right"))&&(gt.includes("left")&&bs<0||gt.includes("right")&&bs>0)&&(ss.x=bs),(Math.abs(ss.x)>0||Math.abs(ss.y)>0)&&Bs(!0),(ft=ws.current)==null||ft.style.setProperty("--swipe-amount-x",`${ss.x}px`),(pt=ws.current)==null||pt.style.setProperty("--swipe-amount-y",`${ss.y}px`)}},Zf&&!f.jsx?F.createElement("button",{"aria-label":T,"data-disabled":Fn,"data-close-button":!0,onClick:Fn||!zs?()=>{}:()=>{var ue;es(),(ue=f.onDismiss)==null||ue.call(f,f)},className:xt(C?.closeButton,(n=f?.classNames)==null?void 0:n.closeButton)},(o=q?.close)!=null?o:Dx):null,f.jsx||u.isValidElement(f.title)?f.jsx?f.jsx:typeof f.title=="function"?f.title():f.title:F.createElement(F.Fragment,null,nt||f.icon||f.promise?F.createElement("div",{"data-icon":"",className:xt(C?.icon,(i=f?.classNames)==null?void 0:i.icon)},f.promise||f.type==="loading"&&!f.icon?f.icon||rp():null,f.type!=="loading"?f.icon||q?.[nt]||Ex(nt):null):null,F.createElement("div",{"data-content":"",className:xt(C?.content,(l=f?.classNames)==null?void 0:l.content)},F.createElement("div",{"data-title":"",className:xt(C?.title,(c=f?.classNames)==null?void 0:c.title)},typeof f.title=="function"?f.title():f.title),f.description?F.createElement("div",{"data-description":"",className:xt(H,Xf,C?.description,(d=f?.classNames)==null?void 0:d.description)},typeof f.description=="function"?f.description():f.description):null),u.isValidElement(f.cancel)?f.cancel:f.cancel&&pa(f.cancel)?F.createElement("button",{"data-button":!0,"data-cancel":!0,style:f.cancelButtonStyle||A,onClick:ue=>{var je,Te;pa(f.cancel)&&zs&&((Te=(je=f.cancel).onClick)==null||Te.call(je,ue),es())},className:xt(C?.cancelButton,(h=f?.classNames)==null?void 0:h.cancelButton)},f.cancel.label):null,u.isValidElement(f.action)?f.action:f.action&&pa(f.action)?F.createElement("button",{"data-button":!0,"data-action":!0,style:f.actionButtonStyle||B,onClick:ue=>{var je,Te;pa(f.action)&&((Te=(je=f.action).onClick)==null||Te.call(je,ue),!ue.defaultPrevented&&es())},className:xt(C?.actionButton,(m=f?.classNames)==null?void 0:m.actionButton)},f.action.label):null))};function Nl(){if(typeof window>"u"||typeof document>"u")return"ltr";let t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function Xx(t,e){let r={};return[t,e].forEach((a,n)=>{let o=n===1,i=o?"--mobile-offset":"--offset",l=o?Hx:Wx;function c(d){["top","right","bottom","left"].forEach(h=>{r[`${i}-${h}`]=typeof d=="number"?`${d}px`:d})}typeof a=="number"||typeof a=="string"?c(a):typeof a=="object"?["top","right","bottom","left"].forEach(d=>{a[d]===void 0?r[`${i}-${d}`]=l:r[`${i}-${d}`]=typeof a[d]=="number"?`${a[d]}px`:a[d]}):c(l)}),r}var Zx=u.forwardRef(function(t,e){let{invert:r,position:a="bottom-right",hotkey:n=["altKey","KeyT"],expand:o,closeButton:i,className:l,offset:c,mobileOffset:d,theme:h="light",richColors:m,duration:p,style:f,visibleToasts:b=qx,toastOptions:g,dir:y=Nl(),gap:w=Gx,loadingIcon:v,icons:x,containerAriaLabel:j="Notifications",pauseWhenPageIsHidden:N}=t,[S,_]=F.useState([]),E=F.useMemo(()=>Array.from(new Set([a].concat(S.filter(U=>U.position).map(U=>U.position)))),[S,a]),[k,A]=F.useState([]),[B,$]=F.useState(!1),[H,O]=F.useState(!1),[Y,z]=F.useState(h!=="system"?h:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),R=F.useRef(null),M=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),C=F.useRef(null),q=F.useRef(!1),T=F.useCallback(U=>{_(X=>{var de;return(de=X.find(I=>I.id===U.id))!=null&&de.delete||Ye.dismiss(U.id),X.filter(({id:I})=>I!==U.id)})},[]);return F.useEffect(()=>Ye.subscribe(U=>{if(U.dismiss){_(X=>X.map(de=>de.id===U.id?{...de,delete:!0}:de));return}setTimeout(()=>{Jc.flushSync(()=>{_(X=>{let de=X.findIndex(I=>I.id===U.id);return de!==-1?[...X.slice(0,de),{...X[de],...U},...X.slice(de+1)]:[U,...X]})})})}),[]),F.useEffect(()=>{if(h!=="system"){z(h);return}if(h==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?z("dark"):z("light")),typeof window>"u")return;let U=window.matchMedia("(prefers-color-scheme: dark)");try{U.addEventListener("change",({matches:X})=>{z(X?"dark":"light")})}catch{U.addListener(({matches:de})=>{try{z(de?"dark":"light")}catch(I){console.error(I)}})}},[h]),F.useEffect(()=>{S.length<=1&&$(!1)},[S]),F.useEffect(()=>{let U=X=>{var de,I;n.every(L=>X[L]||X.code===L)&&($(!0),(de=R.current)==null||de.focus()),X.code==="Escape"&&(document.activeElement===R.current||(I=R.current)!=null&&I.contains(document.activeElement))&&$(!1)};return document.addEventListener("keydown",U),()=>document.removeEventListener("keydown",U)},[n]),F.useEffect(()=>{if(R.current)return()=>{C.current&&(C.current.focus({preventScroll:!0}),C.current=null,q.current=!1)}},[R.current]),F.createElement("section",{ref:e,"aria-label":`${j} ${M}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},E.map((U,X)=>{var de;let[I,L]=U.split("-");return S.length?F.createElement("ol",{key:U,dir:y==="auto"?Nl():y,tabIndex:-1,ref:R,className:l,"data-sonner-toaster":!0,"data-theme":Y,"data-y-position":I,"data-lifted":B&&S.length>1&&!o,"data-x-position":L,style:{"--front-toast-height":`${((de=k[0])==null?void 0:de.height)||0}px`,"--width":`${Vx}px`,"--gap":`${w}px`,...f,...Xx(c,d)},onBlur:D=>{q.current&&!D.currentTarget.contains(D.relatedTarget)&&(q.current=!1,C.current&&(C.current.focus({preventScroll:!0}),C.current=null))},onFocus:D=>{D.target instanceof HTMLElement&&D.target.dataset.dismissible==="false"||q.current||(q.current=!0,C.current=D.relatedTarget)},onMouseEnter:()=>$(!0),onMouseMove:()=>$(!0),onMouseLeave:()=>{H||$(!1)},onDragEnd:()=>$(!1),onPointerDown:D=>{D.target instanceof HTMLElement&&D.target.dataset.dismissible==="false"||O(!0)},onPointerUp:()=>O(!1)},S.filter(D=>!D.position&&X===0||D.position===U).map((D,ie)=>{var oe,ce;return F.createElement(Qx,{key:D.id,icons:x,index:ie,toast:D,defaultRichColors:m,duration:(oe=g?.duration)!=null?oe:p,className:g?.className,descriptionClassName:g?.descriptionClassName,invert:r,visibleToasts:b,closeButton:(ce=g?.closeButton)!=null?ce:i,interacting:H,position:U,style:g?.style,unstyled:g?.unstyled,classNames:g?.classNames,cancelButtonStyle:g?.cancelButtonStyle,actionButtonStyle:g?.actionButtonStyle,removeToast:T,toasts:S.filter(ve=>ve.position==D.position),heights:k.filter(ve=>ve.position==D.position),setHeights:A,expandByDefault:o,gap:w,loadingIcon:v,expanded:B,pauseWhenPageIsHidden:N,swipeDirections:t.swipeDirections})})):null}))});const ev=({...t})=>{const{theme:e="system"}=Cx();return s.jsx(Zx,{theme:e,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})};var tv=Yc[" useId ".trim().toString()]||(()=>{}),sv=0;function Dt(t){const[e,r]=u.useState(tv());return De(()=>{r(a=>a??String(sv++))},[t]),e?`radix-${e}`:""}const rv=["top","right","bottom","left"],hs=Math.min,Ze=Math.max,qa=Math.round,ga=Math.floor,Ot=t=>({x:t,y:t}),av={left:"right",right:"left",bottom:"top",top:"bottom"},nv={start:"end",end:"start"};function Co(t,e,r){return Ze(t,hs(e,r))}function Gt(t,e){return typeof t=="function"?t(e):t}function Kt(t){return t.split("-")[0]}function yr(t){return t.split("-")[1]}function di(t){return t==="x"?"y":"x"}function ui(t){return t==="y"?"height":"width"}const ov=new Set(["top","bottom"]);function Rt(t){return ov.has(Kt(t))?"y":"x"}function hi(t){return di(Rt(t))}function iv(t,e,r){r===void 0&&(r=!1);const a=yr(t),n=hi(t),o=ui(n);let i=n==="x"?a===(r?"end":"start")?"right":"left":a==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(i=Wa(i)),[i,Wa(i)]}function lv(t){const e=Wa(t);return[Eo(t),e,Eo(e)]}function Eo(t){return t.replace(/start|end/g,e=>nv[e])}const Sl=["left","right"],_l=["right","left"],cv=["top","bottom"],dv=["bottom","top"];function uv(t,e,r){switch(t){case"top":case"bottom":return r?e?_l:Sl:e?Sl:_l;case"left":case"right":return e?cv:dv;default:return[]}}function hv(t,e,r,a){const n=yr(t);let o=uv(Kt(t),r==="start",a);return n&&(o=o.map(i=>i+"-"+n),e&&(o=o.concat(o.map(Eo)))),o}function Wa(t){return t.replace(/left|right|bottom|top/g,e=>av[e])}function mv(t){return{top:0,right:0,bottom:0,left:0,...t}}function Od(t){return typeof t!="number"?mv(t):{top:t,right:t,bottom:t,left:t}}function Ha(t){const{x:e,y:r,width:a,height:n}=t;return{width:a,height:n,top:r,left:e,right:e+a,bottom:r+n,x:e,y:r}}function Cl(t,e,r){let{reference:a,floating:n}=t;const o=Rt(e),i=hi(e),l=ui(i),c=Kt(e),d=o==="y",h=a.x+a.width/2-n.width/2,m=a.y+a.height/2-n.height/2,p=a[l]/2-n[l]/2;let f;switch(c){case"top":f={x:h,y:a.y-n.height};break;case"bottom":f={x:h,y:a.y+a.height};break;case"right":f={x:a.x+a.width,y:m};break;case"left":f={x:a.x-n.width,y:m};break;default:f={x:a.x,y:a.y}}switch(yr(e)){case"start":f[i]-=p*(r&&d?-1:1);break;case"end":f[i]+=p*(r&&d?-1:1);break}return f}const fv=async(t,e,r)=>{const{placement:a="bottom",strategy:n="absolute",middleware:o=[],platform:i}=r,l=o.filter(Boolean),c=await(i.isRTL==null?void 0:i.isRTL(e));let d=await i.getElementRects({reference:t,floating:e,strategy:n}),{x:h,y:m}=Cl(d,a,c),p=a,f={},b=0;for(let g=0;g<l.length;g++){const{name:y,fn:w}=l[g],{x:v,y:x,data:j,reset:N}=await w({x:h,y:m,initialPlacement:a,placement:p,strategy:n,middlewareData:f,rects:d,platform:i,elements:{reference:t,floating:e}});h=v??h,m=x??m,f={...f,[y]:{...f[y],...j}},N&&b<=50&&(b++,typeof N=="object"&&(N.placement&&(p=N.placement),N.rects&&(d=N.rects===!0?await i.getElementRects({reference:t,floating:e,strategy:n}):N.rects),{x:h,y:m}=Cl(d,p,c)),g=-1)}return{x:h,y:m,placement:p,strategy:n,middlewareData:f}};async function Ur(t,e){var r;e===void 0&&(e={});const{x:a,y:n,platform:o,rects:i,elements:l,strategy:c}=t,{boundary:d="clippingAncestors",rootBoundary:h="viewport",elementContext:m="floating",altBoundary:p=!1,padding:f=0}=Gt(e,t),b=Od(f),y=l[p?m==="floating"?"reference":"floating":m],w=Ha(await o.getClippingRect({element:(r=await(o.isElement==null?void 0:o.isElement(y)))==null||r?y:y.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(l.floating)),boundary:d,rootBoundary:h,strategy:c})),v=m==="floating"?{x:a,y:n,width:i.floating.width,height:i.floating.height}:i.reference,x=await(o.getOffsetParent==null?void 0:o.getOffsetParent(l.floating)),j=await(o.isElement==null?void 0:o.isElement(x))?await(o.getScale==null?void 0:o.getScale(x))||{x:1,y:1}:{x:1,y:1},N=Ha(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:v,offsetParent:x,strategy:c}):v);return{top:(w.top-N.top+b.top)/j.y,bottom:(N.bottom-w.bottom+b.bottom)/j.y,left:(w.left-N.left+b.left)/j.x,right:(N.right-w.right+b.right)/j.x}}const pv=t=>({name:"arrow",options:t,async fn(e){const{x:r,y:a,placement:n,rects:o,platform:i,elements:l,middlewareData:c}=e,{element:d,padding:h=0}=Gt(t,e)||{};if(d==null)return{};const m=Od(h),p={x:r,y:a},f=hi(n),b=ui(f),g=await i.getDimensions(d),y=f==="y",w=y?"top":"left",v=y?"bottom":"right",x=y?"clientHeight":"clientWidth",j=o.reference[b]+o.reference[f]-p[f]-o.floating[b],N=p[f]-o.reference[f],S=await(i.getOffsetParent==null?void 0:i.getOffsetParent(d));let _=S?S[x]:0;(!_||!await(i.isElement==null?void 0:i.isElement(S)))&&(_=l.floating[x]||o.floating[b]);const E=j/2-N/2,k=_/2-g[b]/2-1,A=hs(m[w],k),B=hs(m[v],k),$=A,H=_-g[b]-B,O=_/2-g[b]/2+E,Y=Co($,O,H),z=!c.arrow&&yr(n)!=null&&O!==Y&&o.reference[b]/2-(O<$?A:B)-g[b]/2<0,R=z?O<$?O-$:O-H:0;return{[f]:p[f]+R,data:{[f]:Y,centerOffset:O-Y-R,...z&&{alignmentOffset:R}},reset:z}}}),gv=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var r,a;const{placement:n,middlewareData:o,rects:i,initialPlacement:l,platform:c,elements:d}=e,{mainAxis:h=!0,crossAxis:m=!0,fallbackPlacements:p,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:b="none",flipAlignment:g=!0,...y}=Gt(t,e);if((r=o.arrow)!=null&&r.alignmentOffset)return{};const w=Kt(n),v=Rt(l),x=Kt(l)===l,j=await(c.isRTL==null?void 0:c.isRTL(d.floating)),N=p||(x||!g?[Wa(l)]:lv(l)),S=b!=="none";!p&&S&&N.push(...hv(l,g,b,j));const _=[l,...N],E=await Ur(e,y),k=[];let A=((a=o.flip)==null?void 0:a.overflows)||[];if(h&&k.push(E[w]),m){const O=iv(n,i,j);k.push(E[O[0]],E[O[1]])}if(A=[...A,{placement:n,overflows:k}],!k.every(O=>O<=0)){var B,$;const O=(((B=o.flip)==null?void 0:B.index)||0)+1,Y=_[O];if(Y&&(!(m==="alignment"?v!==Rt(Y):!1)||A.every(M=>M.overflows[0]>0&&Rt(M.placement)===v)))return{data:{index:O,overflows:A},reset:{placement:Y}};let z=($=A.filter(R=>R.overflows[0]<=0).sort((R,M)=>R.overflows[1]-M.overflows[1])[0])==null?void 0:$.placement;if(!z)switch(f){case"bestFit":{var H;const R=(H=A.filter(M=>{if(S){const C=Rt(M.placement);return C===v||C==="y"}return!0}).map(M=>[M.placement,M.overflows.filter(C=>C>0).reduce((C,q)=>C+q,0)]).sort((M,C)=>M[1]-C[1])[0])==null?void 0:H[0];R&&(z=R);break}case"initialPlacement":z=l;break}if(n!==z)return{reset:{placement:z}}}return{}}}};function El(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function kl(t){return rv.some(e=>t[e]>=0)}const xv=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:r}=e,{strategy:a="referenceHidden",...n}=Gt(t,e);switch(a){case"referenceHidden":{const o=await Ur(e,{...n,elementContext:"reference"}),i=El(o,r.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:kl(i)}}}case"escaped":{const o=await Ur(e,{...n,altBoundary:!0}),i=El(o,r.floating);return{data:{escapedOffsets:i,escaped:kl(i)}}}default:return{}}}}},Md=new Set(["left","top"]);async function vv(t,e){const{placement:r,platform:a,elements:n}=t,o=await(a.isRTL==null?void 0:a.isRTL(n.floating)),i=Kt(r),l=yr(r),c=Rt(r)==="y",d=Md.has(i)?-1:1,h=o&&c?-1:1,m=Gt(e,t);let{mainAxis:p,crossAxis:f,alignmentAxis:b}=typeof m=="number"?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return l&&typeof b=="number"&&(f=l==="end"?b*-1:b),c?{x:f*h,y:p*d}:{x:p*d,y:f*h}}const yv=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var r,a;const{x:n,y:o,placement:i,middlewareData:l}=e,c=await vv(e,t);return i===((r=l.offset)==null?void 0:r.placement)&&(a=l.arrow)!=null&&a.alignmentOffset?{}:{x:n+c.x,y:o+c.y,data:{...c,placement:i}}}}},wv=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:r,y:a,placement:n}=e,{mainAxis:o=!0,crossAxis:i=!1,limiter:l={fn:y=>{let{x:w,y:v}=y;return{x:w,y:v}}},...c}=Gt(t,e),d={x:r,y:a},h=await Ur(e,c),m=Rt(Kt(n)),p=di(m);let f=d[p],b=d[m];if(o){const y=p==="y"?"top":"left",w=p==="y"?"bottom":"right",v=f+h[y],x=f-h[w];f=Co(v,f,x)}if(i){const y=m==="y"?"top":"left",w=m==="y"?"bottom":"right",v=b+h[y],x=b-h[w];b=Co(v,b,x)}const g=l.fn({...e,[p]:f,[m]:b});return{...g,data:{x:g.x-r,y:g.y-a,enabled:{[p]:o,[m]:i}}}}}},bv=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:r,y:a,placement:n,rects:o,middlewareData:i}=e,{offset:l=0,mainAxis:c=!0,crossAxis:d=!0}=Gt(t,e),h={x:r,y:a},m=Rt(n),p=di(m);let f=h[p],b=h[m];const g=Gt(l,e),y=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(c){const x=p==="y"?"height":"width",j=o.reference[p]-o.floating[x]+y.mainAxis,N=o.reference[p]+o.reference[x]-y.mainAxis;f<j?f=j:f>N&&(f=N)}if(d){var w,v;const x=p==="y"?"width":"height",j=Md.has(Kt(n)),N=o.reference[m]-o.floating[x]+(j&&((w=i.offset)==null?void 0:w[m])||0)+(j?0:y.crossAxis),S=o.reference[m]+o.reference[x]+(j?0:((v=i.offset)==null?void 0:v[m])||0)-(j?y.crossAxis:0);b<N?b=N:b>S&&(b=S)}return{[p]:f,[m]:b}}}},jv=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var r,a;const{placement:n,rects:o,platform:i,elements:l}=e,{apply:c=()=>{},...d}=Gt(t,e),h=await Ur(e,d),m=Kt(n),p=yr(n),f=Rt(n)==="y",{width:b,height:g}=o.floating;let y,w;m==="top"||m==="bottom"?(y=m,w=p===(await(i.isRTL==null?void 0:i.isRTL(l.floating))?"start":"end")?"left":"right"):(w=m,y=p==="end"?"top":"bottom");const v=g-h.top-h.bottom,x=b-h.left-h.right,j=hs(g-h[y],v),N=hs(b-h[w],x),S=!e.middlewareData.shift;let _=j,E=N;if((r=e.middlewareData.shift)!=null&&r.enabled.x&&(E=x),(a=e.middlewareData.shift)!=null&&a.enabled.y&&(_=v),S&&!p){const A=Ze(h.left,0),B=Ze(h.right,0),$=Ze(h.top,0),H=Ze(h.bottom,0);f?E=b-2*(A!==0||B!==0?A+B:Ze(h.left,h.right)):_=g-2*($!==0||H!==0?$+H:Ze(h.top,h.bottom))}await c({...e,availableWidth:E,availableHeight:_});const k=await i.getDimensions(l.floating);return b!==k.width||g!==k.height?{reset:{rects:!0}}:{}}}};function hn(){return typeof window<"u"}function wr(t){return Ld(t)?(t.nodeName||"").toLowerCase():"#document"}function tt(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Lt(t){var e;return(e=(Ld(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function Ld(t){return hn()?t instanceof Node||t instanceof tt(t).Node:!1}function St(t){return hn()?t instanceof Element||t instanceof tt(t).Element:!1}function Mt(t){return hn()?t instanceof HTMLElement||t instanceof tt(t).HTMLElement:!1}function Tl(t){return!hn()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof tt(t).ShadowRoot}const Nv=new Set(["inline","contents"]);function aa(t){const{overflow:e,overflowX:r,overflowY:a,display:n}=_t(t);return/auto|scroll|overlay|hidden|clip/.test(e+a+r)&&!Nv.has(n)}const Sv=new Set(["table","td","th"]);function _v(t){return Sv.has(wr(t))}const Cv=[":popover-open",":modal"];function mn(t){return Cv.some(e=>{try{return t.matches(e)}catch{return!1}})}const Ev=["transform","translate","scale","rotate","perspective"],kv=["transform","translate","scale","rotate","perspective","filter"],Tv=["paint","layout","strict","content"];function mi(t){const e=fi(),r=St(t)?_t(t):t;return Ev.some(a=>r[a]?r[a]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!e&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!e&&(r.filter?r.filter!=="none":!1)||kv.some(a=>(r.willChange||"").includes(a))||Tv.some(a=>(r.contain||"").includes(a))}function Pv(t){let e=ms(t);for(;Mt(e)&&!hr(e);){if(mi(e))return e;if(mn(e))return null;e=ms(e)}return null}function fi(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const Av=new Set(["html","body","#document"]);function hr(t){return Av.has(wr(t))}function _t(t){return tt(t).getComputedStyle(t)}function fn(t){return St(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function ms(t){if(wr(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Tl(t)&&t.host||Lt(t);return Tl(e)?e.host:e}function $d(t){const e=ms(t);return hr(e)?t.ownerDocument?t.ownerDocument.body:t.body:Mt(e)&&aa(e)?e:$d(e)}function Br(t,e,r){var a;e===void 0&&(e=[]),r===void 0&&(r=!0);const n=$d(t),o=n===((a=t.ownerDocument)==null?void 0:a.body),i=tt(n);if(o){const l=ko(i);return e.concat(i,i.visualViewport||[],aa(n)?n:[],l&&r?Br(l):[])}return e.concat(n,Br(n,[],r))}function ko(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function Fd(t){const e=_t(t);let r=parseFloat(e.width)||0,a=parseFloat(e.height)||0;const n=Mt(t),o=n?t.offsetWidth:r,i=n?t.offsetHeight:a,l=qa(r)!==o||qa(a)!==i;return l&&(r=o,a=i),{width:r,height:a,$:l}}function pi(t){return St(t)?t:t.contextElement}function cr(t){const e=pi(t);if(!Mt(e))return Ot(1);const r=e.getBoundingClientRect(),{width:a,height:n,$:o}=Fd(e);let i=(o?qa(r.width):r.width)/a,l=(o?qa(r.height):r.height)/n;return(!i||!Number.isFinite(i))&&(i=1),(!l||!Number.isFinite(l))&&(l=1),{x:i,y:l}}const Rv=Ot(0);function Ud(t){const e=tt(t);return!fi()||!e.visualViewport?Rv:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Iv(t,e,r){return e===void 0&&(e=!1),!r||e&&r!==tt(t)?!1:e}function Is(t,e,r,a){e===void 0&&(e=!1),r===void 0&&(r=!1);const n=t.getBoundingClientRect(),o=pi(t);let i=Ot(1);e&&(a?St(a)&&(i=cr(a)):i=cr(t));const l=Iv(o,r,a)?Ud(o):Ot(0);let c=(n.left+l.x)/i.x,d=(n.top+l.y)/i.y,h=n.width/i.x,m=n.height/i.y;if(o){const p=tt(o),f=a&&St(a)?tt(a):a;let b=p,g=ko(b);for(;g&&a&&f!==b;){const y=cr(g),w=g.getBoundingClientRect(),v=_t(g),x=w.left+(g.clientLeft+parseFloat(v.paddingLeft))*y.x,j=w.top+(g.clientTop+parseFloat(v.paddingTop))*y.y;c*=y.x,d*=y.y,h*=y.x,m*=y.y,c+=x,d+=j,b=tt(g),g=ko(b)}}return Ha({width:h,height:m,x:c,y:d})}function gi(t,e){const r=fn(t).scrollLeft;return e?e.left+r:Is(Lt(t)).left+r}function Bd(t,e,r){r===void 0&&(r=!1);const a=t.getBoundingClientRect(),n=a.left+e.scrollLeft-(r?0:gi(t,a)),o=a.top+e.scrollTop;return{x:n,y:o}}function Dv(t){let{elements:e,rect:r,offsetParent:a,strategy:n}=t;const o=n==="fixed",i=Lt(a),l=e?mn(e.floating):!1;if(a===i||l&&o)return r;let c={scrollLeft:0,scrollTop:0},d=Ot(1);const h=Ot(0),m=Mt(a);if((m||!m&&!o)&&((wr(a)!=="body"||aa(i))&&(c=fn(a)),Mt(a))){const f=Is(a);d=cr(a),h.x=f.x+a.clientLeft,h.y=f.y+a.clientTop}const p=i&&!m&&!o?Bd(i,c,!0):Ot(0);return{width:r.width*d.x,height:r.height*d.y,x:r.x*d.x-c.scrollLeft*d.x+h.x+p.x,y:r.y*d.y-c.scrollTop*d.y+h.y+p.y}}function Ov(t){return Array.from(t.getClientRects())}function Mv(t){const e=Lt(t),r=fn(t),a=t.ownerDocument.body,n=Ze(e.scrollWidth,e.clientWidth,a.scrollWidth,a.clientWidth),o=Ze(e.scrollHeight,e.clientHeight,a.scrollHeight,a.clientHeight);let i=-r.scrollLeft+gi(t);const l=-r.scrollTop;return _t(a).direction==="rtl"&&(i+=Ze(e.clientWidth,a.clientWidth)-n),{width:n,height:o,x:i,y:l}}function Lv(t,e){const r=tt(t),a=Lt(t),n=r.visualViewport;let o=a.clientWidth,i=a.clientHeight,l=0,c=0;if(n){o=n.width,i=n.height;const d=fi();(!d||d&&e==="fixed")&&(l=n.offsetLeft,c=n.offsetTop)}return{width:o,height:i,x:l,y:c}}const $v=new Set(["absolute","fixed"]);function Fv(t,e){const r=Is(t,!0,e==="fixed"),a=r.top+t.clientTop,n=r.left+t.clientLeft,o=Mt(t)?cr(t):Ot(1),i=t.clientWidth*o.x,l=t.clientHeight*o.y,c=n*o.x,d=a*o.y;return{width:i,height:l,x:c,y:d}}function Pl(t,e,r){let a;if(e==="viewport")a=Lv(t,r);else if(e==="document")a=Mv(Lt(t));else if(St(e))a=Fv(e,r);else{const n=Ud(t);a={x:e.x-n.x,y:e.y-n.y,width:e.width,height:e.height}}return Ha(a)}function zd(t,e){const r=ms(t);return r===e||!St(r)||hr(r)?!1:_t(r).position==="fixed"||zd(r,e)}function Uv(t,e){const r=e.get(t);if(r)return r;let a=Br(t,[],!1).filter(l=>St(l)&&wr(l)!=="body"),n=null;const o=_t(t).position==="fixed";let i=o?ms(t):t;for(;St(i)&&!hr(i);){const l=_t(i),c=mi(i);!c&&l.position==="fixed"&&(n=null),(o?!c&&!n:!c&&l.position==="static"&&!!n&&$v.has(n.position)||aa(i)&&!c&&zd(t,i))?a=a.filter(h=>h!==i):n=l,i=ms(i)}return e.set(t,a),a}function Bv(t){let{element:e,boundary:r,rootBoundary:a,strategy:n}=t;const i=[...r==="clippingAncestors"?mn(e)?[]:Uv(e,this._c):[].concat(r),a],l=i[0],c=i.reduce((d,h)=>{const m=Pl(e,h,n);return d.top=Ze(m.top,d.top),d.right=hs(m.right,d.right),d.bottom=hs(m.bottom,d.bottom),d.left=Ze(m.left,d.left),d},Pl(e,l,n));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function zv(t){const{width:e,height:r}=Fd(t);return{width:e,height:r}}function qv(t,e,r){const a=Mt(e),n=Lt(e),o=r==="fixed",i=Is(t,!0,o,e);let l={scrollLeft:0,scrollTop:0};const c=Ot(0);function d(){c.x=gi(n)}if(a||!a&&!o)if((wr(e)!=="body"||aa(n))&&(l=fn(e)),a){const f=Is(e,!0,o,e);c.x=f.x+e.clientLeft,c.y=f.y+e.clientTop}else n&&d();o&&!a&&n&&d();const h=n&&!a&&!o?Bd(n,l):Ot(0),m=i.left+l.scrollLeft-c.x-h.x,p=i.top+l.scrollTop-c.y-h.y;return{x:m,y:p,width:i.width,height:i.height}}function Vn(t){return _t(t).position==="static"}function Al(t,e){if(!Mt(t)||_t(t).position==="fixed")return null;if(e)return e(t);let r=t.offsetParent;return Lt(t)===r&&(r=r.ownerDocument.body),r}function qd(t,e){const r=tt(t);if(mn(t))return r;if(!Mt(t)){let n=ms(t);for(;n&&!hr(n);){if(St(n)&&!Vn(n))return n;n=ms(n)}return r}let a=Al(t,e);for(;a&&_v(a)&&Vn(a);)a=Al(a,e);return a&&hr(a)&&Vn(a)&&!mi(a)?r:a||Pv(t)||r}const Wv=async function(t){const e=this.getOffsetParent||qd,r=this.getDimensions,a=await r(t.floating);return{reference:qv(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:a.width,height:a.height}}};function Hv(t){return _t(t).direction==="rtl"}const Vv={convertOffsetParentRelativeRectToViewportRelativeRect:Dv,getDocumentElement:Lt,getClippingRect:Bv,getOffsetParent:qd,getElementRects:Wv,getClientRects:Ov,getDimensions:zv,getScale:cr,isElement:St,isRTL:Hv};function Wd(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function Gv(t,e){let r=null,a;const n=Lt(t);function o(){var l;clearTimeout(a),(l=r)==null||l.disconnect(),r=null}function i(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),o();const d=t.getBoundingClientRect(),{left:h,top:m,width:p,height:f}=d;if(l||e(),!p||!f)return;const b=ga(m),g=ga(n.clientWidth-(h+p)),y=ga(n.clientHeight-(m+f)),w=ga(h),x={rootMargin:-b+"px "+-g+"px "+-y+"px "+-w+"px",threshold:Ze(0,hs(1,c))||1};let j=!0;function N(S){const _=S[0].intersectionRatio;if(_!==c){if(!j)return i();_?i(!1,_):a=setTimeout(()=>{i(!1,1e-7)},1e3)}_===1&&!Wd(d,t.getBoundingClientRect())&&i(),j=!1}try{r=new IntersectionObserver(N,{...x,root:n.ownerDocument})}catch{r=new IntersectionObserver(N,x)}r.observe(t)}return i(!0),o}function Kv(t,e,r,a){a===void 0&&(a={});const{ancestorScroll:n=!0,ancestorResize:o=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=a,d=pi(t),h=n||o?[...d?Br(d):[],...Br(e)]:[];h.forEach(w=>{n&&w.addEventListener("scroll",r,{passive:!0}),o&&w.addEventListener("resize",r)});const m=d&&l?Gv(d,r):null;let p=-1,f=null;i&&(f=new ResizeObserver(w=>{let[v]=w;v&&v.target===d&&f&&(f.unobserve(e),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var x;(x=f)==null||x.observe(e)})),r()}),d&&!c&&f.observe(d),f.observe(e));let b,g=c?Is(t):null;c&&y();function y(){const w=Is(t);g&&!Wd(g,w)&&r(),g=w,b=requestAnimationFrame(y)}return r(),()=>{var w;h.forEach(v=>{n&&v.removeEventListener("scroll",r),o&&v.removeEventListener("resize",r)}),m?.(),(w=f)==null||w.disconnect(),f=null,c&&cancelAnimationFrame(b)}}const Jv=yv,Yv=wv,Qv=gv,Xv=jv,Zv=xv,Rl=pv,ey=bv,ty=(t,e,r)=>{const a=new Map,n={platform:Vv,...r},o={...n.platform,_c:a};return fv(t,e,{...n,platform:o})};var sy=typeof document<"u",ry=function(){},$a=sy?u.useLayoutEffect:ry;function Va(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let r,a,n;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(r=t.length,r!==e.length)return!1;for(a=r;a--!==0;)if(!Va(t[a],e[a]))return!1;return!0}if(n=Object.keys(t),r=n.length,r!==Object.keys(e).length)return!1;for(a=r;a--!==0;)if(!{}.hasOwnProperty.call(e,n[a]))return!1;for(a=r;a--!==0;){const o=n[a];if(!(o==="_owner"&&t.$$typeof)&&!Va(t[o],e[o]))return!1}return!0}return t!==t&&e!==e}function Hd(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function Il(t,e){const r=Hd(t);return Math.round(e*r)/r}function Gn(t){const e=u.useRef(t);return $a(()=>{e.current=t}),e}function ay(t){t===void 0&&(t={});const{placement:e="bottom",strategy:r="absolute",middleware:a=[],platform:n,elements:{reference:o,floating:i}={},transform:l=!0,whileElementsMounted:c,open:d}=t,[h,m]=u.useState({x:0,y:0,strategy:r,placement:e,middlewareData:{},isPositioned:!1}),[p,f]=u.useState(a);Va(p,a)||f(a);const[b,g]=u.useState(null),[y,w]=u.useState(null),v=u.useCallback(M=>{M!==S.current&&(S.current=M,g(M))},[]),x=u.useCallback(M=>{M!==_.current&&(_.current=M,w(M))},[]),j=o||b,N=i||y,S=u.useRef(null),_=u.useRef(null),E=u.useRef(h),k=c!=null,A=Gn(c),B=Gn(n),$=Gn(d),H=u.useCallback(()=>{if(!S.current||!_.current)return;const M={placement:e,strategy:r,middleware:p};B.current&&(M.platform=B.current),ty(S.current,_.current,M).then(C=>{const q={...C,isPositioned:$.current!==!1};O.current&&!Va(E.current,q)&&(E.current=q,Zr.flushSync(()=>{m(q)}))})},[p,e,r,B,$]);$a(()=>{d===!1&&E.current.isPositioned&&(E.current.isPositioned=!1,m(M=>({...M,isPositioned:!1})))},[d]);const O=u.useRef(!1);$a(()=>(O.current=!0,()=>{O.current=!1}),[]),$a(()=>{if(j&&(S.current=j),N&&(_.current=N),j&&N){if(A.current)return A.current(j,N,H);H()}},[j,N,H,A,k]);const Y=u.useMemo(()=>({reference:S,floating:_,setReference:v,setFloating:x}),[v,x]),z=u.useMemo(()=>({reference:j,floating:N}),[j,N]),R=u.useMemo(()=>{const M={position:r,left:0,top:0};if(!z.floating)return M;const C=Il(z.floating,h.x),q=Il(z.floating,h.y);return l?{...M,transform:"translate("+C+"px, "+q+"px)",...Hd(z.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:C,top:q}},[r,l,z.floating,h.x,h.y]);return u.useMemo(()=>({...h,update:H,refs:Y,elements:z,floatingStyles:R}),[h,H,Y,z,R])}const ny=t=>{function e(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:t,fn(r){const{element:a,padding:n}=typeof t=="function"?t(r):t;return a&&e(a)?a.current!=null?Rl({element:a.current,padding:n}).fn(r):{}:a?Rl({element:a,padding:n}).fn(r):{}}}},oy=(t,e)=>({...Jv(t),options:[t,e]}),iy=(t,e)=>({...Yv(t),options:[t,e]}),ly=(t,e)=>({...ey(t),options:[t,e]}),cy=(t,e)=>({...Qv(t),options:[t,e]}),dy=(t,e)=>({...Xv(t),options:[t,e]}),uy=(t,e)=>({...Zv(t),options:[t,e]}),hy=(t,e)=>({...ny(t),options:[t,e]});var my="Arrow",Vd=u.forwardRef((t,e)=>{const{children:r,width:a=10,height:n=5,...o}=t;return s.jsx(ne.svg,{...o,ref:e,width:a,height:n,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?r:s.jsx("polygon",{points:"0,0 30,0 15,10"})})});Vd.displayName=my;var fy=Vd;function xi(t){const[e,r]=u.useState(void 0);return De(()=>{if(t){r({width:t.offsetWidth,height:t.offsetHeight});const a=new ResizeObserver(n=>{if(!Array.isArray(n)||!n.length)return;const o=n[0];let i,l;if("borderBoxSize"in o){const c=o.borderBoxSize,d=Array.isArray(c)?c[0]:c;i=d.inlineSize,l=d.blockSize}else i=t.offsetWidth,l=t.offsetHeight;r({width:i,height:l})});return a.observe(t,{box:"border-box"}),()=>a.unobserve(t)}else r(void 0)},[t]),e}var vi="Popper",[Gd,br]=Xe(vi),[py,Kd]=Gd(vi),Jd=t=>{const{__scopePopper:e,children:r}=t,[a,n]=u.useState(null);return s.jsx(py,{scope:e,anchor:a,onAnchorChange:n,children:r})};Jd.displayName=vi;var Yd="PopperAnchor",Qd=u.forwardRef((t,e)=>{const{__scopePopper:r,virtualRef:a,...n}=t,o=Kd(Yd,r),i=u.useRef(null),l=xe(e,i);return u.useEffect(()=>{o.onAnchorChange(a?.current||i.current)}),a?null:s.jsx(ne.div,{...n,ref:l})});Qd.displayName=Yd;var yi="PopperContent",[gy,xy]=Gd(yi),Xd=u.forwardRef((t,e)=>{const{__scopePopper:r,side:a="bottom",sideOffset:n=0,align:o="center",alignOffset:i=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:d=[],collisionPadding:h=0,sticky:m="partial",hideWhenDetached:p=!1,updatePositionStrategy:f="optimized",onPlaced:b,...g}=t,y=Kd(yi,r),[w,v]=u.useState(null),x=xe(e,D=>v(D)),[j,N]=u.useState(null),S=xi(j),_=S?.width??0,E=S?.height??0,k=a+(o!=="center"?"-"+o:""),A=typeof h=="number"?h:{top:0,right:0,bottom:0,left:0,...h},B=Array.isArray(d)?d:[d],$=B.length>0,H={padding:A,boundary:B.filter(yy),altBoundary:$},{refs:O,floatingStyles:Y,placement:z,isPositioned:R,middlewareData:M}=ay({strategy:"fixed",placement:k,whileElementsMounted:(...D)=>Kv(...D,{animationFrame:f==="always"}),elements:{reference:y.anchor},middleware:[oy({mainAxis:n+E,alignmentAxis:i}),c&&iy({mainAxis:!0,crossAxis:!1,limiter:m==="partial"?ly():void 0,...H}),c&&cy({...H}),dy({...H,apply:({elements:D,rects:ie,availableWidth:oe,availableHeight:ce})=>{const{width:ve,height:ke}=ie.reference,qe=D.floating.style;qe.setProperty("--radix-popper-available-width",`${oe}px`),qe.setProperty("--radix-popper-available-height",`${ce}px`),qe.setProperty("--radix-popper-anchor-width",`${ve}px`),qe.setProperty("--radix-popper-anchor-height",`${ke}px`)}}),j&&hy({element:j,padding:l}),wy({arrowWidth:_,arrowHeight:E}),p&&uy({strategy:"referenceHidden",...H})]}),[C,q]=tu(z),T=Ke(b);De(()=>{R&&T?.()},[R,T]);const U=M.arrow?.x,X=M.arrow?.y,de=M.arrow?.centerOffset!==0,[I,L]=u.useState();return De(()=>{w&&L(window.getComputedStyle(w).zIndex)},[w]),s.jsx("div",{ref:O.setFloating,"data-radix-popper-content-wrapper":"",style:{...Y,transform:R?Y.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:I,"--radix-popper-transform-origin":[M.transformOrigin?.x,M.transformOrigin?.y].join(" "),...M.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:s.jsx(gy,{scope:r,placedSide:C,onArrowChange:N,arrowX:U,arrowY:X,shouldHideArrow:de,children:s.jsx(ne.div,{"data-side":C,"data-align":q,...g,ref:x,style:{...g.style,animation:R?void 0:"none"}})})})});Xd.displayName=yi;var Zd="PopperArrow",vy={top:"bottom",right:"left",bottom:"top",left:"right"},eu=u.forwardRef(function(e,r){const{__scopePopper:a,...n}=e,o=xy(Zd,a),i=vy[o.placedSide];return s.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:s.jsx(fy,{...n,ref:r,style:{...n.style,display:"block"}})})});eu.displayName=Zd;function yy(t){return t!==null}var wy=t=>({name:"transformOrigin",options:t,fn(e){const{placement:r,rects:a,middlewareData:n}=e,i=n.arrow?.centerOffset!==0,l=i?0:t.arrowWidth,c=i?0:t.arrowHeight,[d,h]=tu(r),m={start:"0%",center:"50%",end:"100%"}[h],p=(n.arrow?.x??0)+l/2,f=(n.arrow?.y??0)+c/2;let b="",g="";return d==="bottom"?(b=i?m:`${p}px`,g=`${-c}px`):d==="top"?(b=i?m:`${p}px`,g=`${a.floating.height+c}px`):d==="right"?(b=`${-c}px`,g=i?m:`${f}px`):d==="left"&&(b=`${a.floating.width+c}px`,g=i?m:`${f}px`),{data:{x:b,y:g}}}});function tu(t){const[e,r="center"]=t.split("-");return[e,r]}var su=Jd,wi=Qd,bi=Xd,ji=eu,[pn,$C]=Xe("Tooltip",[br]),Ni=br(),ru="TooltipProvider",by=700,Dl="tooltip.open",[jy,au]=pn(ru),nu=t=>{const{__scopeTooltip:e,delayDuration:r=by,skipDelayDuration:a=300,disableHoverableContent:n=!1,children:o}=t,i=u.useRef(!0),l=u.useRef(!1),c=u.useRef(0);return u.useEffect(()=>{const d=c.current;return()=>window.clearTimeout(d)},[]),s.jsx(jy,{scope:e,isOpenDelayedRef:i,delayDuration:r,onOpen:u.useCallback(()=>{window.clearTimeout(c.current),i.current=!1},[]),onClose:u.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>i.current=!0,a)},[a]),isPointerInTransitRef:l,onPointerInTransitChange:u.useCallback(d=>{l.current=d},[]),disableHoverableContent:n,children:o})};nu.displayName=ru;var ou="Tooltip",[FC,gn]=pn(ou),To="TooltipTrigger",Ny=u.forwardRef((t,e)=>{const{__scopeTooltip:r,...a}=t,n=gn(To,r),o=au(To,r),i=Ni(r),l=u.useRef(null),c=xe(e,l,n.onTriggerChange),d=u.useRef(!1),h=u.useRef(!1),m=u.useCallback(()=>d.current=!1,[]);return u.useEffect(()=>()=>document.removeEventListener("pointerup",m),[m]),s.jsx(wi,{asChild:!0,...i,children:s.jsx(ne.button,{"aria-describedby":n.open?n.contentId:void 0,"data-state":n.stateAttribute,...a,ref:c,onPointerMove:W(t.onPointerMove,p=>{p.pointerType!=="touch"&&!h.current&&!o.isPointerInTransitRef.current&&(n.onTriggerEnter(),h.current=!0)}),onPointerLeave:W(t.onPointerLeave,()=>{n.onTriggerLeave(),h.current=!1}),onPointerDown:W(t.onPointerDown,()=>{n.open&&n.onClose(),d.current=!0,document.addEventListener("pointerup",m,{once:!0})}),onFocus:W(t.onFocus,()=>{d.current||n.onOpen()}),onBlur:W(t.onBlur,n.onClose),onClick:W(t.onClick,n.onClose)})})});Ny.displayName=To;var Sy="TooltipPortal",[UC,_y]=pn(Sy,{forceMount:void 0}),mr="TooltipContent",iu=u.forwardRef((t,e)=>{const r=_y(mr,t.__scopeTooltip),{forceMount:a=r.forceMount,side:n="top",...o}=t,i=gn(mr,t.__scopeTooltip);return s.jsx(ht,{present:a||i.open,children:i.disableHoverableContent?s.jsx(lu,{side:n,...o,ref:e}):s.jsx(Cy,{side:n,...o,ref:e})})}),Cy=u.forwardRef((t,e)=>{const r=gn(mr,t.__scopeTooltip),a=au(mr,t.__scopeTooltip),n=u.useRef(null),o=xe(e,n),[i,l]=u.useState(null),{trigger:c,onClose:d}=r,h=n.current,{onPointerInTransitChange:m}=a,p=u.useCallback(()=>{l(null),m(!1)},[m]),f=u.useCallback((b,g)=>{const y=b.currentTarget,w={x:b.clientX,y:b.clientY},v=Ay(w,y.getBoundingClientRect()),x=Ry(w,v),j=Iy(g.getBoundingClientRect()),N=Oy([...x,...j]);l(N),m(!0)},[m]);return u.useEffect(()=>()=>p(),[p]),u.useEffect(()=>{if(c&&h){const b=y=>f(y,h),g=y=>f(y,c);return c.addEventListener("pointerleave",b),h.addEventListener("pointerleave",g),()=>{c.removeEventListener("pointerleave",b),h.removeEventListener("pointerleave",g)}}},[c,h,f,p]),u.useEffect(()=>{if(i){const b=g=>{const y=g.target,w={x:g.clientX,y:g.clientY},v=c?.contains(y)||h?.contains(y),x=!Dy(w,i);v?p():x&&(p(),d())};return document.addEventListener("pointermove",b),()=>document.removeEventListener("pointermove",b)}},[c,h,i,d,p]),s.jsx(lu,{...t,ref:o})}),[Ey,ky]=pn(ou,{isInside:!1}),Ty=Qp("TooltipContent"),lu=u.forwardRef((t,e)=>{const{__scopeTooltip:r,children:a,"aria-label":n,onEscapeKeyDown:o,onPointerDownOutside:i,...l}=t,c=gn(mr,r),d=Ni(r),{onClose:h}=c;return u.useEffect(()=>(document.addEventListener(Dl,h),()=>document.removeEventListener(Dl,h)),[h]),u.useEffect(()=>{if(c.trigger){const m=p=>{p.target?.contains(c.trigger)&&h()};return window.addEventListener("scroll",m,{capture:!0}),()=>window.removeEventListener("scroll",m,{capture:!0})}},[c.trigger,h]),s.jsx(xr,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:m=>m.preventDefault(),onDismiss:h,children:s.jsxs(bi,{"data-state":c.stateAttribute,...d,...l,ref:e,style:{...l.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[s.jsx(Ty,{children:a}),s.jsx(Ey,{scope:r,isInside:!0,children:s.jsx(yg,{id:c.contentId,role:"tooltip",children:n||a})})]})})});iu.displayName=mr;var cu="TooltipArrow",Py=u.forwardRef((t,e)=>{const{__scopeTooltip:r,...a}=t,n=Ni(r);return ky(cu,r).isInside?null:s.jsx(ji,{...n,...a,ref:e})});Py.displayName=cu;function Ay(t,e){const r=Math.abs(e.top-t.y),a=Math.abs(e.bottom-t.y),n=Math.abs(e.right-t.x),o=Math.abs(e.left-t.x);switch(Math.min(r,a,n,o)){case o:return"left";case n:return"right";case r:return"top";case a:return"bottom";default:throw new Error("unreachable")}}function Ry(t,e,r=5){const a=[];switch(e){case"top":a.push({x:t.x-r,y:t.y+r},{x:t.x+r,y:t.y+r});break;case"bottom":a.push({x:t.x-r,y:t.y-r},{x:t.x+r,y:t.y-r});break;case"left":a.push({x:t.x+r,y:t.y-r},{x:t.x+r,y:t.y+r});break;case"right":a.push({x:t.x-r,y:t.y-r},{x:t.x-r,y:t.y+r});break}return a}function Iy(t){const{top:e,right:r,bottom:a,left:n}=t;return[{x:n,y:e},{x:r,y:e},{x:r,y:a},{x:n,y:a}]}function Dy(t,e){const{x:r,y:a}=t;let n=!1;for(let o=0,i=e.length-1;o<e.length;i=o++){const l=e[o],c=e[i],d=l.x,h=l.y,m=c.x,p=c.y;h>a!=p>a&&r<(m-d)*(a-h)/(p-h)+d&&(n=!n)}return n}function Oy(t){const e=t.slice();return e.sort((r,a)=>r.x<a.x?-1:r.x>a.x?1:r.y<a.y?-1:r.y>a.y?1:0),My(e)}function My(t){if(t.length<=1)return t.slice();const e=[];for(let a=0;a<t.length;a++){const n=t[a];for(;e.length>=2;){const o=e[e.length-1],i=e[e.length-2];if((o.x-i.x)*(n.y-i.y)>=(o.y-i.y)*(n.x-i.x))e.pop();else break}e.push(n)}e.pop();const r=[];for(let a=t.length-1;a>=0;a--){const n=t[a];for(;r.length>=2;){const o=r[r.length-1],i=r[r.length-2];if((o.x-i.x)*(n.y-i.y)>=(o.y-i.y)*(n.x-i.x))r.pop();else break}r.push(n)}return r.pop(),e.length===1&&r.length===1&&e[0].x===r[0].x&&e[0].y===r[0].y?e:e.concat(r)}var Ly=nu,du=iu;const $y=Ly,Fy=u.forwardRef(({className:t,sideOffset:e=4,...r},a)=>s.jsx(du,{ref:a,sideOffset:e,className:Z("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r}));Fy.displayName=du.displayName;var xn=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},vn=typeof window>"u"||"Deno"in globalThis;function bt(){}function Uy(t,e){return typeof t=="function"?t(e):t}function By(t){return typeof t=="number"&&t>=0&&t!==1/0}function zy(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Po(t,e){return typeof t=="function"?t(e):t}function qy(t,e){return typeof t=="function"?t(e):t}function Ol(t,e){const{type:r="all",exact:a,fetchStatus:n,predicate:o,queryKey:i,stale:l}=t;if(i){if(a){if(e.queryHash!==Si(i,e.options))return!1}else if(!qr(e.queryKey,i))return!1}if(r!=="all"){const c=e.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof l=="boolean"&&e.isStale()!==l||n&&n!==e.state.fetchStatus||o&&!o(e))}function Ml(t,e){const{exact:r,status:a,predicate:n,mutationKey:o}=t;if(o){if(!e.options.mutationKey)return!1;if(r){if(zr(e.options.mutationKey)!==zr(o))return!1}else if(!qr(e.options.mutationKey,o))return!1}return!(a&&e.state.status!==a||n&&!n(e))}function Si(t,e){return(e?.queryKeyHashFn||zr)(t)}function zr(t){return JSON.stringify(t,(e,r)=>Ao(r)?Object.keys(r).sort().reduce((a,n)=>(a[n]=r[n],a),{}):r)}function qr(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(r=>qr(t[r],e[r])):!1}function uu(t,e){if(t===e)return t;const r=Ll(t)&&Ll(e);if(r||Ao(t)&&Ao(e)){const a=r?t:Object.keys(t),n=a.length,o=r?e:Object.keys(e),i=o.length,l=r?[]:{},c=new Set(a);let d=0;for(let h=0;h<i;h++){const m=r?h:o[h];(!r&&c.has(m)||r)&&t[m]===void 0&&e[m]===void 0?(l[m]=void 0,d++):(l[m]=uu(t[m],e[m]),l[m]===t[m]&&t[m]!==void 0&&d++)}return n===i&&d===n?t:l}return e}function Ll(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Ao(t){if(!$l(t))return!1;const e=t.constructor;if(e===void 0)return!0;const r=e.prototype;return!(!$l(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function $l(t){return Object.prototype.toString.call(t)==="[object Object]"}function Wy(t){return new Promise(e=>{setTimeout(e,t)})}function Hy(t,e,r){return typeof r.structuralSharing=="function"?r.structuralSharing(t,e):r.structuralSharing!==!1?uu(t,e):e}function Vy(t,e,r=0){const a=[...t,e];return r&&a.length>r?a.slice(1):a}function Gy(t,e,r=0){const a=[e,...t];return r&&a.length>r?a.slice(0,-1):a}var _i=Symbol();function hu(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:!t.queryFn||t.queryFn===_i?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var Ky=class extends xn{#e;#t;#s;constructor(){super(),this.#s=t=>{if(!vn&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#s)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#s=t,this.#t?.(),this.#t=t(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(t){this.#e!==t&&(this.#e=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},mu=new Ky,Jy=class extends xn{#e=!0;#t;#s;constructor(){super(),this.#s=t=>{if(!vn&&window.addEventListener){const e=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",r)}}}}onSubscribe(){this.#t||this.setEventListener(this.#s)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#s=t,this.#t?.(),this.#t=t(this.setOnline.bind(this))}setOnline(t){this.#e!==t&&(this.#e=t,this.listeners.forEach(r=>{r(t)}))}isOnline(){return this.#e}},Ga=new Jy;function Yy(){let t,e;const r=new Promise((n,o)=>{t=n,e=o});r.status="pending",r.catch(()=>{});function a(n){Object.assign(r,n),delete r.resolve,delete r.reject}return r.resolve=n=>{a({status:"fulfilled",value:n}),t(n)},r.reject=n=>{a({status:"rejected",reason:n}),e(n)},r}function Qy(t){return Math.min(1e3*2**t,3e4)}function fu(t){return(t??"online")==="online"?Ga.isOnline():!0}var pu=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function Kn(t){return t instanceof pu}function gu(t){let e=!1,r=0,a=!1,n;const o=Yy(),i=g=>{a||(p(new pu(g)),t.abort?.())},l=()=>{e=!0},c=()=>{e=!1},d=()=>mu.isFocused()&&(t.networkMode==="always"||Ga.isOnline())&&t.canRun(),h=()=>fu(t.networkMode)&&t.canRun(),m=g=>{a||(a=!0,t.onSuccess?.(g),n?.(),o.resolve(g))},p=g=>{a||(a=!0,t.onError?.(g),n?.(),o.reject(g))},f=()=>new Promise(g=>{n=y=>{(a||d())&&g(y)},t.onPause?.()}).then(()=>{n=void 0,a||t.onContinue?.()}),b=()=>{if(a)return;let g;const y=r===0?t.initialPromise:void 0;try{g=y??t.fn()}catch(w){g=Promise.reject(w)}Promise.resolve(g).then(m).catch(w=>{if(a)return;const v=t.retry??(vn?0:3),x=t.retryDelay??Qy,j=typeof x=="function"?x(r,w):x,N=v===!0||typeof v=="number"&&r<v||typeof v=="function"&&v(r,w);if(e||!N){p(w);return}r++,t.onFail?.(r,w),Wy(j).then(()=>d()?void 0:f()).then(()=>{e?p(w):b()})})};return{promise:o,cancel:i,continue:()=>(n?.(),o),cancelRetry:l,continueRetry:c,canStart:h,start:()=>(h()?b():f().then(b),o)}}var Xy=t=>setTimeout(t,0);function Zy(){let t=[],e=0,r=l=>{l()},a=l=>{l()},n=Xy;const o=l=>{e?t.push(l):n(()=>{r(l)})},i=()=>{const l=t;t=[],l.length&&n(()=>{a(()=>{l.forEach(c=>{r(c)})})})};return{batch:l=>{let c;e++;try{c=l()}finally{e--,e||i()}return c},batchCalls:l=>(...c)=>{o(()=>{l(...c)})},schedule:o,setNotifyFunction:l=>{r=l},setBatchNotifyFunction:l=>{a=l},setScheduler:l=>{n=l}}}var Ge=Zy(),xu=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),By(this.gcTime)&&(this.#e=setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(vn?1/0:300*1e3))}clearGcTimeout(){this.#e&&(clearTimeout(this.#e),this.#e=void 0)}},ew=class extends xu{#e;#t;#s;#a;#r;#o;#i;constructor(t){super(),this.#i=!1,this.#o=t.defaultOptions,this.setOptions(t.options),this.observers=[],this.#a=t.client,this.#s=this.#a.getQueryCache(),this.queryKey=t.queryKey,this.queryHash=t.queryHash,this.#e=sw(this.options),this.state=t.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#r?.promise}setOptions(t){this.options={...this.#o,...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#s.remove(this)}setData(t,e){const r=Hy(this.state.data,t,this.options);return this.#n({data:r,type:"success",dataUpdatedAt:e?.updatedAt,manual:e?.manual}),r}setState(t,e){this.#n({type:"setState",state:t,setStateOptions:e})}cancel(t){const e=this.#r?.promise;return this.#r?.cancel(t),e?e.then(bt).catch(bt):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(t=>qy(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===_i||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Po(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!zy(this.state.dataUpdatedAt,t)}onFocus(){this.observers.find(e=>e.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#r?.continue()}onOnline(){this.observers.find(e=>e.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#r?.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),this.#s.notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(e=>e!==t),this.observers.length||(this.#r&&(this.#i?this.#r.cancel({revert:!0}):this.#r.cancelRetry()),this.scheduleGc()),this.#s.notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#n({type:"invalidate"})}fetch(t,e){if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&e?.cancelRefetch)this.cancel({silent:!0});else if(this.#r)return this.#r.continueRetry(),this.#r.promise}if(t&&this.setOptions(t),!this.options.queryFn){const c=this.observers.find(d=>d.options.queryFn);c&&this.setOptions(c.options)}const r=new AbortController,a=c=>{Object.defineProperty(c,"signal",{enumerable:!0,get:()=>(this.#i=!0,r.signal)})},n=()=>{const c=hu(this.options,e),h=(()=>{const m={client:this.#a,queryKey:this.queryKey,meta:this.meta};return a(m),m})();return this.#i=!1,this.options.persister?this.options.persister(c,h,this):c(h)},i=(()=>{const c={fetchOptions:e,options:this.options,queryKey:this.queryKey,client:this.#a,state:this.state,fetchFn:n};return a(c),c})();this.options.behavior?.onFetch(i,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==i.fetchOptions?.meta)&&this.#n({type:"fetch",meta:i.fetchOptions?.meta});const l=c=>{Kn(c)&&c.silent||this.#n({type:"error",error:c}),Kn(c)||(this.#s.config.onError?.(c,this),this.#s.config.onSettled?.(this.state.data,c,this)),this.scheduleGc()};return this.#r=gu({initialPromise:e?.initialPromise,fn:i.fetchFn,abort:r.abort.bind(r),onSuccess:c=>{if(c===void 0){l(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(c)}catch(d){l(d);return}this.#s.config.onSuccess?.(c,this),this.#s.config.onSettled?.(c,this.state.error,this),this.scheduleGc()},onError:l,onFail:(c,d)=>{this.#n({type:"failed",failureCount:c,error:d})},onPause:()=>{this.#n({type:"pause"})},onContinue:()=>{this.#n({type:"continue"})},retry:i.options.retry,retryDelay:i.options.retryDelay,networkMode:i.options.networkMode,canRun:()=>!0}),this.#r.start()}#n(t){const e=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...tw(r.data,this.options),fetchMeta:t.meta??null};case"success":return this.#t=void 0,{...r,data:t.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const a=t.error;return Kn(a)&&a.revert&&this.#t?{...this.#t,fetchStatus:"idle"}:{...r,error:a,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=e(this.state),Ge.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),this.#s.notify({query:this,type:"updated",action:t})})}};function tw(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:fu(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function sw(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,r=e!==void 0,a=r?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:r?a??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var rw=class extends xn{constructor(t={}){super(),this.config=t,this.#e=new Map}#e;build(t,e,r){const a=e.queryKey,n=e.queryHash??Si(a,e);let o=this.get(n);return o||(o=new ew({client:t,queryKey:a,queryHash:n,options:t.defaultQueryOptions(e),state:r,defaultOptions:t.getQueryDefaults(a)}),this.add(o)),o}add(t){this.#e.has(t.queryHash)||(this.#e.set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=this.#e.get(t.queryHash);e&&(t.destroy(),e===t&&this.#e.delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Ge.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return this.#e.get(t)}getAll(){return[...this.#e.values()]}find(t){const e={exact:!0,...t};return this.getAll().find(r=>Ol(e,r))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(r=>Ol(t,r)):e}notify(t){Ge.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){Ge.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Ge.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},aw=class extends xu{#e;#t;#s;constructor(t){super(),this.mutationId=t.mutationId,this.#t=t.mutationCache,this.#e=[],this.state=t.state||nw(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){this.#e.includes(t)||(this.#e.push(t),this.clearGcTimeout(),this.#t.notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){this.#e=this.#e.filter(e=>e!==t),this.scheduleGc(),this.#t.notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){this.#e.length||(this.state.status==="pending"?this.scheduleGc():this.#t.remove(this))}continue(){return this.#s?.continue()??this.execute(this.state.variables)}async execute(t){const e=()=>{this.#a({type:"continue"})};this.#s=gu({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(n,o)=>{this.#a({type:"failed",failureCount:n,error:o})},onPause:()=>{this.#a({type:"pause"})},onContinue:e,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#t.canRun(this)});const r=this.state.status==="pending",a=!this.#s.canStart();try{if(r)e();else{this.#a({type:"pending",variables:t,isPaused:a}),await this.#t.config.onMutate?.(t,this);const o=await this.options.onMutate?.(t);o!==this.state.context&&this.#a({type:"pending",context:o,variables:t,isPaused:a})}const n=await this.#s.start();return await this.#t.config.onSuccess?.(n,t,this.state.context,this),await this.options.onSuccess?.(n,t,this.state.context),await this.#t.config.onSettled?.(n,null,this.state.variables,this.state.context,this),await this.options.onSettled?.(n,null,t,this.state.context),this.#a({type:"success",data:n}),n}catch(n){try{throw await this.#t.config.onError?.(n,t,this.state.context,this),await this.options.onError?.(n,t,this.state.context),await this.#t.config.onSettled?.(void 0,n,this.state.variables,this.state.context,this),await this.options.onSettled?.(void 0,n,t,this.state.context),n}finally{this.#a({type:"error",error:n})}}finally{this.#t.runNext(this)}}#a(t){const e=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=e(this.state),Ge.batch(()=>{this.#e.forEach(r=>{r.onMutationUpdate(t)}),this.#t.notify({mutation:this,type:"updated",action:t})})}};function nw(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var ow=class extends xn{constructor(t={}){super(),this.config=t,this.#e=new Set,this.#t=new Map,this.#s=0}#e;#t;#s;build(t,e,r){const a=new aw({mutationCache:this,mutationId:++this.#s,options:t.defaultMutationOptions(e),state:r});return this.add(a),a}add(t){this.#e.add(t);const e=xa(t);if(typeof e=="string"){const r=this.#t.get(e);r?r.push(t):this.#t.set(e,[t])}this.notify({type:"added",mutation:t})}remove(t){if(this.#e.delete(t)){const e=xa(t);if(typeof e=="string"){const r=this.#t.get(e);if(r)if(r.length>1){const a=r.indexOf(t);a!==-1&&r.splice(a,1)}else r[0]===t&&this.#t.delete(e)}}this.notify({type:"removed",mutation:t})}canRun(t){const e=xa(t);if(typeof e=="string"){const a=this.#t.get(e)?.find(n=>n.state.status==="pending");return!a||a===t}else return!0}runNext(t){const e=xa(t);return typeof e=="string"?this.#t.get(e)?.find(a=>a!==t&&a.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){Ge.batch(()=>{this.#e.forEach(t=>{this.notify({type:"removed",mutation:t})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(t){const e={exact:!0,...t};return this.getAll().find(r=>Ml(e,r))}findAll(t={}){return this.getAll().filter(e=>Ml(t,e))}notify(t){Ge.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){const t=this.getAll().filter(e=>e.state.isPaused);return Ge.batch(()=>Promise.all(t.map(e=>e.continue().catch(bt))))}};function xa(t){return t.options.scope?.id}function Fl(t){return{onFetch:(e,r)=>{const a=e.options,n=e.fetchOptions?.meta?.fetchMore?.direction,o=e.state.data?.pages||[],i=e.state.data?.pageParams||[];let l={pages:[],pageParams:[]},c=0;const d=async()=>{let h=!1;const m=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(e.signal.aborted?h=!0:e.signal.addEventListener("abort",()=>{h=!0}),e.signal)})},p=hu(e.options,e.fetchOptions),f=async(b,g,y)=>{if(h)return Promise.reject();if(g==null&&b.pages.length)return Promise.resolve(b);const v=(()=>{const S={client:e.client,queryKey:e.queryKey,pageParam:g,direction:y?"backward":"forward",meta:e.options.meta};return m(S),S})(),x=await p(v),{maxPages:j}=e.options,N=y?Gy:Vy;return{pages:N(b.pages,x,j),pageParams:N(b.pageParams,g,j)}};if(n&&o.length){const b=n==="backward",g=b?iw:Ul,y={pages:o,pageParams:i},w=g(a,y);l=await f(y,w,b)}else{const b=t??o.length;do{const g=c===0?i[0]??a.initialPageParam:Ul(a,l);if(c>0&&g==null)break;l=await f(l,g),c++}while(c<b)}return l};e.options.persister?e.fetchFn=()=>e.options.persister?.(d,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},r):e.fetchFn=d}}}function Ul(t,{pages:e,pageParams:r}){const a=e.length-1;return e.length>0?t.getNextPageParam(e[a],e,r[a],r):void 0}function iw(t,{pages:e,pageParams:r}){return e.length>0?t.getPreviousPageParam?.(e[0],e,r[0],r):void 0}var lw=class{#e;#t;#s;#a;#r;#o;#i;#n;constructor(t={}){this.#e=t.queryCache||new rw,this.#t=t.mutationCache||new ow,this.#s=t.defaultOptions||{},this.#a=new Map,this.#r=new Map,this.#o=0}mount(){this.#o++,this.#o===1&&(this.#i=mu.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#n=Ga.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#o--,this.#o===0&&(this.#i?.(),this.#i=void 0,this.#n?.(),this.#n=void 0)}isFetching(t){return this.#e.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#t.findAll({...t,status:"pending"}).length}getQueryData(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),r=this.#e.build(this,e),a=r.state.data;return a===void 0?this.fetchQuery(t):(t.revalidateIfStale&&r.isStaleByTime(Po(e.staleTime,r))&&this.prefetchQuery(e),Promise.resolve(a))}getQueriesData(t){return this.#e.findAll(t).map(({queryKey:e,state:r})=>{const a=r.data;return[e,a]})}setQueryData(t,e,r){const a=this.defaultQueryOptions({queryKey:t}),o=this.#e.get(a.queryHash)?.state.data,i=Uy(e,o);if(i!==void 0)return this.#e.build(this,a).setData(i,{...r,manual:!0})}setQueriesData(t,e,r){return Ge.batch(()=>this.#e.findAll(t).map(({queryKey:a})=>[a,this.setQueryData(a,e,r)]))}getQueryState(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state}removeQueries(t){const e=this.#e;Ge.batch(()=>{e.findAll(t).forEach(r=>{e.remove(r)})})}resetQueries(t,e){const r=this.#e;return Ge.batch(()=>(r.findAll(t).forEach(a=>{a.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const r={revert:!0,...e},a=Ge.batch(()=>this.#e.findAll(t).map(n=>n.cancel(r)));return Promise.all(a).then(bt).catch(bt)}invalidateQueries(t,e={}){return Ge.batch(()=>(this.#e.findAll(t).forEach(r=>{r.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},e)))}refetchQueries(t,e={}){const r={...e,cancelRefetch:e.cancelRefetch??!0},a=Ge.batch(()=>this.#e.findAll(t).filter(n=>!n.isDisabled()&&!n.isStatic()).map(n=>{let o=n.fetch(void 0,r);return r.throwOnError||(o=o.catch(bt)),n.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(a).then(bt)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const r=this.#e.build(this,e);return r.isStaleByTime(Po(e.staleTime,r))?r.fetch(e):Promise.resolve(r.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(bt).catch(bt)}fetchInfiniteQuery(t){return t.behavior=Fl(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(bt).catch(bt)}ensureInfiniteQueryData(t){return t.behavior=Fl(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return Ga.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#s}setDefaultOptions(t){this.#s=t}setQueryDefaults(t,e){this.#a.set(zr(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...this.#a.values()],r={};return e.forEach(a=>{qr(t,a.queryKey)&&Object.assign(r,a.defaultOptions)}),r}setMutationDefaults(t,e){this.#r.set(zr(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...this.#r.values()],r={};return e.forEach(a=>{qr(t,a.mutationKey)&&Object.assign(r,a.defaultOptions)}),r}defaultQueryOptions(t){if(t._defaulted)return t;const e={...this.#s.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Si(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===_i&&(e.enabled=!1),e}defaultMutationOptions(t){return t?._defaulted?t:{...this.#s.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},cw=u.createContext(void 0),dw=({client:t,children:e})=>(u.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),s.jsx(cw.Provider,{value:t,children:e}));const uw="modulepreload",hw=function(t,e){return new URL(t,e).href},Bl={},we=function(e,r,a){let n=Promise.resolve();if(r&&r.length>0){let d=function(h){return Promise.all(h.map(m=>Promise.resolve(m).then(p=>({status:"fulfilled",value:p}),p=>({status:"rejected",reason:p}))))};const i=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");n=d(r.map(h=>{if(h=hw(h,a),h in Bl)return;Bl[h]=!0;const m=h.endsWith(".css"),p=m?'[rel="stylesheet"]':"";if(!!a)for(let g=i.length-1;g>=0;g--){const y=i[g];if(y.href===h&&(!m||y.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${h}"]${p}`))return;const b=document.createElement("link");if(b.rel=m?"stylesheet":uw,m||(b.as="script"),b.crossOrigin="",b.href=h,c&&b.setAttribute("nonce",c),document.head.appendChild(b),m)return new Promise((g,y)=>{b.addEventListener("load",g),b.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${h}`)))})}))}function o(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return n.then(i=>{for(const l of i||[])l.status==="rejected"&&o(l.reason);return e().catch(o)})},mw=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>we(async()=>{const{default:a}=await Promise.resolve().then(()=>jr);return{default:a}},void 0,import.meta.url).then(({default:a})=>a(...r)):e=fetch,(...r)=>e(...r)};class Ci extends Error{constructor(e,r="FunctionsError",a){super(e),this.name=r,this.context=a}}class fw extends Ci{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class zl extends Ci{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class ql extends Ci{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Ro;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Ro||(Ro={}));var pw=function(t,e,r,a){function n(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(h){try{d(a.next(h))}catch(m){i(m)}}function c(h){try{d(a.throw(h))}catch(m){i(m)}}function d(h){h.done?o(h.value):n(h.value).then(l,c)}d((a=a.apply(t,e||[])).next())})};class gw{constructor(e,{headers:r={},customFetch:a,region:n=Ro.Any}={}){this.url=e,this.headers=r,this.region=n,this.fetch=mw(a)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,r={}){var a;return pw(this,void 0,void 0,function*(){try{const{headers:n,method:o,body:i}=r;let l={},{region:c}=r;c||(c=this.region);const d=new URL(`${this.url}/${e}`);c&&c!=="any"&&(l["x-region"]=c,d.searchParams.set("forceFunctionRegion",c));let h;i&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",h=i):typeof i=="string"?(l["Content-Type"]="text/plain",h=i):typeof FormData<"u"&&i instanceof FormData?h=i:(l["Content-Type"]="application/json",h=JSON.stringify(i)));const m=yield this.fetch(d.toString(),{method:o||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),n),body:h}).catch(g=>{throw new fw(g)}),p=m.headers.get("x-relay-error");if(p&&p==="true")throw new zl(m);if(!m.ok)throw new ql(m);let f=((a=m.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),b;return f==="application/json"?b=yield m.json():f==="application/octet-stream"?b=yield m.blob():f==="text/event-stream"?b=m:f==="multipart/form-data"?b=yield m.formData():b=yield m.text(),{data:b,error:null,response:m}}catch(n){return{data:null,error:n,response:n instanceof ql||n instanceof zl?n.context:void 0}}})}}var Fe={},Vs={},Gs={},Ks={},Js={},Ys={},xw=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},fr=xw();const vw=fr.fetch,vu=fr.fetch.bind(fr),yu=fr.Headers,yw=fr.Request,ww=fr.Response,jr=Object.freeze(Object.defineProperty({__proto__:null,Headers:yu,Request:yw,Response:ww,default:vu,fetch:vw},Symbol.toStringTag,{value:"Module"})),bw=Ip(jr);var va={},Wl;function wu(){if(Wl)return va;Wl=1,Object.defineProperty(va,"__esModule",{value:!0});class t extends Error{constructor(r){super(r.message),this.name="PostgrestError",this.details=r.details,this.hint=r.hint,this.code=r.code}}return va.default=t,va}var Hl;function bu(){if(Hl)return Ys;Hl=1;var t=Ys&&Ys.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Ys,"__esModule",{value:!0});const e=t(bw),r=t(wu());class a{constructor(o){var i,l;this.shouldThrowOnError=!1,this.method=o.method,this.url=o.url,this.headers=new Headers(o.headers),this.schema=o.schema,this.body=o.body,this.shouldThrowOnError=(i=o.shouldThrowOnError)!==null&&i!==void 0?i:!1,this.signal=o.signal,this.isMaybeSingle=(l=o.isMaybeSingle)!==null&&l!==void 0?l:!1,o.fetch?this.fetch=o.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(o,i){return this.headers=new Headers(this.headers),this.headers.set(o,i),this}then(o,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const l=this.fetch;let c=l(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async d=>{var h,m,p,f;let b=null,g=null,y=null,w=d.status,v=d.statusText;if(d.ok){if(this.method!=="HEAD"){const S=await d.text();S===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((h=this.headers.get("Accept"))===null||h===void 0)&&h.includes("application/vnd.pgrst.plan+text"))?g=S:g=JSON.parse(S))}const j=(m=this.headers.get("Prefer"))===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),N=(p=d.headers.get("content-range"))===null||p===void 0?void 0:p.split("/");j&&N&&N.length>1&&(y=parseInt(N[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(g)&&(g.length>1?(b={code:"PGRST116",details:`Results contain ${g.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},g=null,y=null,w=406,v="Not Acceptable"):g.length===1?g=g[0]:g=null)}else{const j=await d.text();try{b=JSON.parse(j),Array.isArray(b)&&d.status===404&&(g=[],b=null,w=200,v="OK")}catch{d.status===404&&j===""?(w=204,v="No Content"):b={message:j}}if(b&&this.isMaybeSingle&&(!((f=b?.details)===null||f===void 0)&&f.includes("0 rows"))&&(b=null,w=200,v="OK"),b&&this.shouldThrowOnError)throw new r.default(b)}return{error:b,data:g,count:y,status:w,statusText:v}});return this.shouldThrowOnError||(c=c.catch(d=>{var h,m,p;return{error:{message:`${(h=d?.name)!==null&&h!==void 0?h:"FetchError"}: ${d?.message}`,details:`${(m=d?.stack)!==null&&m!==void 0?m:""}`,hint:"",code:`${(p=d?.code)!==null&&p!==void 0?p:""}`},data:null,count:null,status:0,statusText:""}})),c.then(o,i)}returns(){return this}overrideTypes(){return this}}return Ys.default=a,Ys}var Vl;function ju(){if(Vl)return Js;Vl=1;var t=Js&&Js.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Js,"__esModule",{value:!0});const e=t(bu());class r extends e.default{select(n){let o=!1;const i=(n??"*").split("").map(l=>/\s/.test(l)&&!o?"":(l==='"'&&(o=!o),l)).join("");return this.url.searchParams.set("select",i),this.headers.append("Prefer","return=representation"),this}order(n,{ascending:o=!0,nullsFirst:i,foreignTable:l,referencedTable:c=l}={}){const d=c?`${c}.order`:"order",h=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${h?`${h},`:""}${n}.${o?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(n,{foreignTable:o,referencedTable:i=o}={}){const l=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(l,`${n}`),this}range(n,o,{foreignTable:i,referencedTable:l=i}={}){const c=typeof l>"u"?"offset":`${l}.offset`,d=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${n}`),this.url.searchParams.set(d,`${o-n+1}`),this}abortSignal(n){return this.signal=n,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:n=!1,verbose:o=!1,settings:i=!1,buffers:l=!1,wal:c=!1,format:d="text"}={}){var h;const m=[n?"analyze":null,o?"verbose":null,i?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),p=(h=this.headers.get("Accept"))!==null&&h!==void 0?h:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${p}"; options=${m};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(n){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${n}`),this}}return Js.default=r,Js}var Gl;function Ei(){if(Gl)return Ks;Gl=1;var t=Ks&&Ks.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Ks,"__esModule",{value:!0});const e=t(ju());class r extends e.default{eq(n,o){return this.url.searchParams.append(n,`eq.${o}`),this}neq(n,o){return this.url.searchParams.append(n,`neq.${o}`),this}gt(n,o){return this.url.searchParams.append(n,`gt.${o}`),this}gte(n,o){return this.url.searchParams.append(n,`gte.${o}`),this}lt(n,o){return this.url.searchParams.append(n,`lt.${o}`),this}lte(n,o){return this.url.searchParams.append(n,`lte.${o}`),this}like(n,o){return this.url.searchParams.append(n,`like.${o}`),this}likeAllOf(n,o){return this.url.searchParams.append(n,`like(all).{${o.join(",")}}`),this}likeAnyOf(n,o){return this.url.searchParams.append(n,`like(any).{${o.join(",")}}`),this}ilike(n,o){return this.url.searchParams.append(n,`ilike.${o}`),this}ilikeAllOf(n,o){return this.url.searchParams.append(n,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(n,o){return this.url.searchParams.append(n,`ilike(any).{${o.join(",")}}`),this}is(n,o){return this.url.searchParams.append(n,`is.${o}`),this}in(n,o){const i=Array.from(new Set(o)).map(l=>typeof l=="string"&&new RegExp("[,()]").test(l)?`"${l}"`:`${l}`).join(",");return this.url.searchParams.append(n,`in.(${i})`),this}contains(n,o){return typeof o=="string"?this.url.searchParams.append(n,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(n,`cs.{${o.join(",")}}`):this.url.searchParams.append(n,`cs.${JSON.stringify(o)}`),this}containedBy(n,o){return typeof o=="string"?this.url.searchParams.append(n,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(n,`cd.{${o.join(",")}}`):this.url.searchParams.append(n,`cd.${JSON.stringify(o)}`),this}rangeGt(n,o){return this.url.searchParams.append(n,`sr.${o}`),this}rangeGte(n,o){return this.url.searchParams.append(n,`nxl.${o}`),this}rangeLt(n,o){return this.url.searchParams.append(n,`sl.${o}`),this}rangeLte(n,o){return this.url.searchParams.append(n,`nxr.${o}`),this}rangeAdjacent(n,o){return this.url.searchParams.append(n,`adj.${o}`),this}overlaps(n,o){return typeof o=="string"?this.url.searchParams.append(n,`ov.${o}`):this.url.searchParams.append(n,`ov.{${o.join(",")}}`),this}textSearch(n,o,{config:i,type:l}={}){let c="";l==="plain"?c="pl":l==="phrase"?c="ph":l==="websearch"&&(c="w");const d=i===void 0?"":`(${i})`;return this.url.searchParams.append(n,`${c}fts${d}.${o}`),this}match(n){return Object.entries(n).forEach(([o,i])=>{this.url.searchParams.append(o,`eq.${i}`)}),this}not(n,o,i){return this.url.searchParams.append(n,`not.${o}.${i}`),this}or(n,{foreignTable:o,referencedTable:i=o}={}){const l=i?`${i}.or`:"or";return this.url.searchParams.append(l,`(${n})`),this}filter(n,o,i){return this.url.searchParams.append(n,`${o}.${i}`),this}}return Ks.default=r,Ks}var Kl;function Nu(){if(Kl)return Gs;Kl=1;var t=Gs&&Gs.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(Gs,"__esModule",{value:!0});const e=t(Ei());class r{constructor(n,{headers:o={},schema:i,fetch:l}){this.url=n,this.headers=new Headers(o),this.schema=i,this.fetch=l}select(n,{head:o=!1,count:i}={}){const l=o?"HEAD":"GET";let c=!1;const d=(n??"*").split("").map(h=>/\s/.test(h)&&!c?"":(h==='"'&&(c=!c),h)).join("");return this.url.searchParams.set("select",d),i&&this.headers.append("Prefer",`count=${i}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(n,{count:o,defaultToNull:i=!0}={}){var l;const c="POST";if(o&&this.headers.append("Prefer",`count=${o}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const d=n.reduce((h,m)=>h.concat(Object.keys(m)),[]);if(d.length>0){const h=[...new Set(d)].map(m=>`"${m}"`);this.url.searchParams.set("columns",h.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(n,{onConflict:o,ignoreDuplicates:i=!1,count:l,defaultToNull:c=!0}={}){var d;const h="POST";if(this.headers.append("Prefer",`resolution=${i?"ignore":"merge"}-duplicates`),o!==void 0&&this.url.searchParams.set("on_conflict",o),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(n)){const m=n.reduce((p,f)=>p.concat(Object.keys(f)),[]);if(m.length>0){const p=[...new Set(m)].map(f=>`"${f}"`);this.url.searchParams.set("columns",p.join(","))}}return new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}update(n,{count:o}={}){var i;const l="PATCH";return o&&this.headers.append("Prefer",`count=${o}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:n,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}delete({count:n}={}){var o;const i="DELETE";return n&&this.headers.append("Prefer",`count=${n}`),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}}return Gs.default=r,Gs}var Jl;function jw(){if(Jl)return Vs;Jl=1;var t=Vs&&Vs.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(Vs,"__esModule",{value:!0});const e=t(Nu()),r=t(Ei());class a{constructor(o,{headers:i={},schema:l,fetch:c}={}){this.url=o,this.headers=new Headers(i),this.schemaName=l,this.fetch=c}from(o){const i=new URL(`${this.url}/${o}`);return new e.default(i,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new a(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,i={},{head:l=!1,get:c=!1,count:d}={}){var h;let m;const p=new URL(`${this.url}/rpc/${o}`);let f;l||c?(m=l?"HEAD":"GET",Object.entries(i).filter(([g,y])=>y!==void 0).map(([g,y])=>[g,Array.isArray(y)?`{${y.join(",")}}`:`${y}`]).forEach(([g,y])=>{p.searchParams.append(g,y)})):(m="POST",f=i);const b=new Headers(this.headers);return d&&b.set("Prefer",`count=${d}`),new r.default({method:m,url:p,headers:b,schema:this.schemaName,body:f,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}}return Vs.default=a,Vs}var Yl;function Nw(){if(Yl)return Fe;Yl=1;var t=Fe&&Fe.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.PostgrestError=Fe.PostgrestBuilder=Fe.PostgrestTransformBuilder=Fe.PostgrestFilterBuilder=Fe.PostgrestQueryBuilder=Fe.PostgrestClient=void 0;const e=t(jw());Fe.PostgrestClient=e.default;const r=t(Nu());Fe.PostgrestQueryBuilder=r.default;const a=t(Ei());Fe.PostgrestFilterBuilder=a.default;const n=t(ju());Fe.PostgrestTransformBuilder=n.default;const o=t(bu());Fe.PostgrestBuilder=o.default;const i=t(wu());return Fe.PostgrestError=i.default,Fe.default={PostgrestClient:e.default,PostgrestQueryBuilder:r.default,PostgrestFilterBuilder:a.default,PostgrestTransformBuilder:n.default,PostgrestBuilder:o.default,PostgrestError:i.default},Fe}var Sw=Nw();const _w=Dp(Sw),{PostgrestClient:Cw,PostgrestQueryBuilder:BC,PostgrestFilterBuilder:zC,PostgrestTransformBuilder:qC,PostgrestBuilder:WC,PostgrestError:HC}=_w;class Ew{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const r=parseInt(process.versions.node.split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let r=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(r+=`

Suggested solution: ${e.workaround}`),new Error(r)}static createWebSocket(e,r){const a=this.getWebSocketConstructor();return new a(e,r)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const kw="2.15.1",Tw=`realtime-js/${kw}`,Pw="1.0.0",Io=1e4,Aw=1e3,Rw=100;var Lr;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(Lr||(Lr={}));var Oe;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(Oe||(Oe={}));var jt;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(jt||(jt={}));var Do;(function(t){t.websocket="websocket"})(Do||(Do={}));var Cs;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Cs||(Cs={}));class Iw{constructor(){this.HEADER_LENGTH=1}decode(e,r){return e.constructor===ArrayBuffer?r(this._binaryDecode(e)):r(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const r=new DataView(e),a=new TextDecoder;return this._decodeBroadcast(e,r,a)}_decodeBroadcast(e,r,a){const n=r.getUint8(1),o=r.getUint8(2);let i=this.HEADER_LENGTH+2;const l=a.decode(e.slice(i,i+n));i=i+n;const c=a.decode(e.slice(i,i+o));i=i+o;const d=JSON.parse(a.decode(e.slice(i,e.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class Su{constructor(e,r){this.callback=e,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Se;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Se||(Se={}));const Ql=(t,e,r={})=>{var a;const n=(a=r.skipTypes)!==null&&a!==void 0?a:[];return Object.keys(e).reduce((o,i)=>(o[i]=Dw(i,t,e,n),o),{})},Dw=(t,e,r,a)=>{const n=e.find(l=>l.name===t),o=n?.type,i=r[t];return o&&!a.includes(o)?_u(o,i):Oo(i)},_u=(t,e)=>{if(t.charAt(0)==="_"){const r=t.slice(1,t.length);return $w(e,r)}switch(t){case Se.bool:return Ow(e);case Se.float4:case Se.float8:case Se.int2:case Se.int4:case Se.int8:case Se.numeric:case Se.oid:return Mw(e);case Se.json:case Se.jsonb:return Lw(e);case Se.timestamp:return Fw(e);case Se.abstime:case Se.date:case Se.daterange:case Se.int4range:case Se.int8range:case Se.money:case Se.reltime:case Se.text:case Se.time:case Se.timestamptz:case Se.timetz:case Se.tsrange:case Se.tstzrange:return Oo(e);default:return Oo(e)}},Oo=t=>t,Ow=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},Mw=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},Lw=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},$w=(t,e)=>{if(typeof t!="string")return t;const r=t.length-1,a=t[r];if(t[0]==="{"&&a==="}"){let o;const i=t.slice(1,r);try{o=JSON.parse("["+i+"]")}catch{o=i?i.split(","):[]}return o.map(l=>_u(e,l))}return t},Fw=t=>typeof t=="string"?t.replace(" ","T"):t,Cu=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class Jn{constructor(e,r,a={},n=Io){this.channel=e,this.event=r,this.payload=a,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,r){var a;return this._hasReceived(e)&&r((a=this.receivedResp)===null||a===void 0?void 0:a.response),this.recHooks.push({status:e,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:r}){this.recHooks.filter(a=>a.status===e).forEach(a=>a.callback(r))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Xl;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Xl||(Xl={}));class $r{constructor(e,r){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const a=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(a.state,{},n=>{const{onJoin:o,onLeave:i,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=$r.syncState(this.state,n,o,i),this.pendingDiffs.forEach(c=>{this.state=$r.syncDiff(this.state,c,o,i)}),this.pendingDiffs=[],l()}),this.channel._on(a.diff,{},n=>{const{onJoin:o,onLeave:i,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=$r.syncDiff(this.state,n,o,i),l())}),this.onJoin((n,o,i)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:o,newPresences:i})}),this.onLeave((n,o,i)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:o,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,r,a,n){const o=this.cloneDeep(e),i=this.transformState(r),l={},c={};return this.map(o,(d,h)=>{i[d]||(c[d]=h)}),this.map(i,(d,h)=>{const m=o[d];if(m){const p=h.map(y=>y.presence_ref),f=m.map(y=>y.presence_ref),b=h.filter(y=>f.indexOf(y.presence_ref)<0),g=m.filter(y=>p.indexOf(y.presence_ref)<0);b.length>0&&(l[d]=b),g.length>0&&(c[d]=g)}else l[d]=h}),this.syncDiff(o,{joins:l,leaves:c},a,n)}static syncDiff(e,r,a,n){const{joins:o,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return a||(a=()=>{}),n||(n=()=>{}),this.map(o,(l,c)=>{var d;const h=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),h.length>0){const m=e[l].map(f=>f.presence_ref),p=h.filter(f=>m.indexOf(f.presence_ref)<0);e[l].unshift(...p)}a(l,h,c)}),this.map(i,(l,c)=>{let d=e[l];if(!d)return;const h=c.map(m=>m.presence_ref);d=d.filter(m=>h.indexOf(m.presence_ref)<0),e[l]=d,n(l,d,c),d.length===0&&delete e[l]}),e}static map(e,r){return Object.getOwnPropertyNames(e).map(a=>r(a,e[a]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((r,a)=>{const n=e[a];return"metas"in n?r[a]=n.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):r[a]=n,r},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Zl;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Zl||(Zl={}));var Fr;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Fr||(Fr={}));var zt;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(zt||(zt={}));class ki{constructor(e,r={config:{}},a){this.topic=e,this.params=r,this.socket=a,this.bindings={},this.state=Oe.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Jn(this,jt.join,this.params,this.timeout),this.rejoinTimer=new Su(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Oe.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Oe.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=Oe.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Oe.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=Oe.errored,this.rejoinTimer.scheduleTimeout())}),this._on(jt.reply,{},(n,o)=>{this._trigger(this._replyEventName(o),n)}),this.presence=new $r(this),this.broadcastEndpointURL=Cu(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,r=this.timeout){var a,n;if(this.socket.isConnected()||this.socket.connect(),this.state==Oe.closed){const{config:{broadcast:o,presence:i,private:l}}=this.params,c=(n=(a=this.bindings.postgres_changes)===null||a===void 0?void 0:a.map(p=>p.filter))!==null&&n!==void 0?n:[],d=!!this.bindings[Fr.PRESENCE]&&this.bindings[Fr.PRESENCE].length>0,h={},m={broadcast:o,presence:Object.assign(Object.assign({},i),{enabled:d}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(p=>e?.(zt.CHANNEL_ERROR,p)),this._onClose(()=>e?.(zt.CLOSED)),this.updateJoinPayload(Object.assign({config:m},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:p})=>{var f;if(this.socket.setAuth(),p===void 0){e?.(zt.SUBSCRIBED);return}else{const b=this.bindings.postgres_changes,g=(f=b?.length)!==null&&f!==void 0?f:0,y=[];for(let w=0;w<g;w++){const v=b[w],{filter:{event:x,schema:j,table:N,filter:S}}=v,_=p&&p[w];if(_&&_.event===x&&_.schema===j&&_.table===N&&_.filter===S)y.push(Object.assign(Object.assign({},v),{id:_.id}));else{this.unsubscribe(),this.state=Oe.errored,e?.(zt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,e&&e(zt.SUBSCRIBED);return}}).receive("error",p=>{this.state=Oe.errored,e?.(zt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{e?.(zt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,r={}){return await this.send({type:"presence",event:"track",payload:e},r.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,r,a){return this.state===Oe.joined&&e===Fr.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,r,a)}async send(e,r={}){var a,n;if(!this._canPush()&&e.type==="broadcast"){const{event:o,payload:i}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:i,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(a=r.timeout)!==null&&a!==void 0?a:this.timeout);return await((n=d.body)===null||n===void 0?void 0:n.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var i,l,c;const d=this._push(e.type,e,r.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(i=this.params)===null||i===void 0?void 0:i.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&o("ok"),d.receive("ok",()=>o("ok")),d.receive("error",()=>o("error")),d.receive("timeout",()=>o("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Oe.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(jt.close,"leave",this._joinRef())};this.joinPush.destroy();let a=null;return new Promise(n=>{a=new Jn(this,jt.leave,{},e),a.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),a.send(),this._canPush()||a.trigger("ok",{})}).finally(()=>{a?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Oe.closed,this.bindings={}}async _fetchWithTimeout(e,r,a){const n=new AbortController,o=setTimeout(()=>n.abort(),a),i=await this.socket.fetch(e,Object.assign(Object.assign({},r),{signal:n.signal}));return clearTimeout(o),i}_push(e,r,a=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Jn(this,e,r,a);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>Rw){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(e,r,a){return r}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,r,a){var n,o;const i=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:h}=jt;if(a&&[l,c,d,h].indexOf(i)>=0&&a!==this._joinRef())return;let p=this._onMessage(i,r,a);if(r&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(n=this.bindings.postgres_changes)===null||n===void 0||n.filter(f=>{var b,g,y;return((b=f.filter)===null||b===void 0?void 0:b.event)==="*"||((y=(g=f.filter)===null||g===void 0?void 0:g.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===i}).map(f=>f.callback(p,a)):(o=this.bindings[i])===null||o===void 0||o.filter(f=>{var b,g,y,w,v,x;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in f){const j=f.id,N=(b=f.filter)===null||b===void 0?void 0:b.event;return j&&((g=r.ids)===null||g===void 0?void 0:g.includes(j))&&(N==="*"||N?.toLocaleLowerCase()===((y=r.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const j=(v=(w=f?.filter)===null||w===void 0?void 0:w.event)===null||v===void 0?void 0:v.toLocaleLowerCase();return j==="*"||j===((x=r?.event)===null||x===void 0?void 0:x.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===i}).map(f=>{if(typeof p=="object"&&"ids"in p){const b=p.data,{schema:g,table:y,commit_timestamp:w,type:v,errors:x}=b;p=Object.assign(Object.assign({},{schema:g,table:y,commit_timestamp:w,eventType:v,new:{},old:{},errors:x}),this._getPayloadRecords(b))}f.callback(p,a)})}_isClosed(){return this.state===Oe.closed}_isJoined(){return this.state===Oe.joined}_isJoining(){return this.state===Oe.joining}_isLeaving(){return this.state===Oe.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,r,a){const n=e.toLocaleLowerCase(),o={type:n,filter:r,callback:a};return this.bindings[n]?this.bindings[n].push(o):this.bindings[n]=[o],this}_off(e,r){const a=e.toLocaleLowerCase();return this.bindings[a]&&(this.bindings[a]=this.bindings[a].filter(n=>{var o;return!(((o=n.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===a&&ki.isEqual(n.filter,r))})),this}static isEqual(e,r){if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const a in e)if(e[a]!==r[a])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(jt.close,{},e)}_onError(e){this._on(jt.error,{},r=>e(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Oe.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const r={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(r.new=Ql(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(r.old=Ql(e.columns,e.old_record)),r}}const ec=()=>{},ya={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Uw=[1e3,2e3,5e3,1e4],Bw=1e4,zw=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class qw{constructor(e,r){var a;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Io,this.transport=null,this.heartbeatIntervalMs=ya.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ec,this.ref=0,this.reconnectTimer=null,this.logger=ec,this.conn=null,this.sendBuffer=[],this.serializer=new Iw,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=n=>{let o;return n?o=n:typeof fetch>"u"?o=(...i)=>we(async()=>{const{default:l}=await Promise.resolve().then(()=>jr);return{default:l}},void 0,import.meta.url).then(({default:l})=>l(...i)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):o=fetch,(...i)=>o(...i)},!(!((a=r?.params)===null||a===void 0)&&a.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${e}/${Do.websocket}`,this.httpEndpoint=Cu(e),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Ew.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const r=e.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Pw}))}disconnect(e,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const a=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(a),this._setConnectionState("disconnected")},e?this.conn.close(e,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const r=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const e=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,r,a){this.logger(e,r,a)}connectionState(){switch(this.conn&&this.conn.readyState){case Lr.connecting:return Cs.Connecting;case Lr.open:return Cs.Open;case Lr.closing:return Cs.Closing;default:return Cs.Closed}}isConnected(){return this.connectionState()===Cs.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,r={config:{}}){const a=`realtime:${e}`,n=this.getChannels().find(o=>o.topic===a);if(n)return n;{const o=new ki(`realtime:${e}`,r,this);return this.channels.push(o),o}}push(e){const{topic:r,event:a,payload:n,ref:o}=e,i=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${r} ${a} (${o})`,n),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(Aw,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},ya.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let r=this.channels.find(a=>a.topic===e&&(a._isJoined()||a._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${e}"`),r.unsubscribe())}_remove(e){this.channels=this.channels.filter(r=>r.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,r=>{r.topic==="phoenix"&&r.event==="phx_reply"&&this.heartbeatCallback(r.payload.status==="ok"?"ok":"error"),r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:a,event:n,payload:o,ref:i}=r,l=i?`(${i})`:"",c=o.status||"";this.log("receive",`${c} ${a} ${n} ${l}`.trim(),o),this.channels.filter(d=>d._isMember(a)).forEach(d=>d._trigger(n,o,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(e){var r;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var r;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(jt.error))}_appendParams(e,r){if(Object.keys(r).length===0)return e;const a=e.match(/\?/)?"&":"?",n=new URLSearchParams(r);return`${e}${a}${n}`}_workerObjectUrl(e){let r;if(e)r=e;else{const a=new Blob([zw],{type:"application/javascript"});r=URL.createObjectURL(a)}return r}_setConnectionState(e,r=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(e=null){let r;e?r=e:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(a=>{const n={access_token:r,version:Tw};r&&a.updateJoinPayload(n),a.joinedOnce&&a._isJoined()&&a._push(jt.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${e}`,r)})}_triggerStateCallbacks(e,r){try{this.stateChangeCallbacks[e].forEach(a=>{try{a(r)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(a){this.log("error",`error triggering ${e} callbacks`,a)}}_setupReconnectionTimer(){this.reconnectTimer=new Su(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},ya.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var r,a,n,o,i,l,c,d;if(this.transport=(r=e?.transport)!==null&&r!==void 0?r:null,this.timeout=(a=e?.timeout)!==null&&a!==void 0?a:Io,this.heartbeatIntervalMs=(n=e?.heartbeatIntervalMs)!==null&&n!==void 0?n:ya.HEARTBEAT_INTERVAL,this.worker=(o=e?.worker)!==null&&o!==void 0?o:!1,this.accessToken=(i=e?.accessToken)!==null&&i!==void 0?i:null,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=e?.reconnectAfterMs)!==null&&l!==void 0?l:(h=>Uw[h-1]||Bw),this.encode=(c=e?.encode)!==null&&c!==void 0?c:((h,m)=>m(JSON.stringify(h))),this.decode=(d=e?.decode)!==null&&d!==void 0?d:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class Ti extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Me(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class Ww extends Ti{constructor(e,r,a){super(e),this.name="StorageApiError",this.status=r,this.statusCode=a}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Mo extends Ti{constructor(e,r){super(e),this.name="StorageUnknownError",this.originalError=r}}var Hw=function(t,e,r,a){function n(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(h){try{d(a.next(h))}catch(m){i(m)}}function c(h){try{d(a.throw(h))}catch(m){i(m)}}function d(h){h.done?o(h.value):n(h.value).then(l,c)}d((a=a.apply(t,e||[])).next())})};const Eu=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>we(async()=>{const{default:a}=await Promise.resolve().then(()=>jr);return{default:a}},void 0,import.meta.url).then(({default:a})=>a(...r)):e=fetch,(...r)=>e(...r)},Vw=()=>Hw(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield we(()=>Promise.resolve().then(()=>jr),void 0,import.meta.url)).Response:Response}),Lo=t=>{if(Array.isArray(t))return t.map(r=>Lo(r));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([r,a])=>{const n=r.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));e[n]=Lo(a)}),e},Gw=t=>{if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var $s=function(t,e,r,a){function n(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(h){try{d(a.next(h))}catch(m){i(m)}}function c(h){try{d(a.throw(h))}catch(m){i(m)}}function d(h){h.done?o(h.value):n(h.value).then(l,c)}d((a=a.apply(t,e||[])).next())})};const Yn=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Kw=(t,e,r)=>$s(void 0,void 0,void 0,function*(){const a=yield Vw();t instanceof a&&!r?.noResolveJson?t.json().then(n=>{const o=t.status||500,i=n?.statusCode||o+"";e(new Ww(Yn(n),o,i))}).catch(n=>{e(new Mo(Yn(n),n))}):e(new Mo(Yn(t),t))}),Jw=(t,e,r,a)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"||!a?n:(Gw(a)?(n.headers=Object.assign({"Content-Type":"application/json"},e?.headers),n.body=JSON.stringify(a)):n.body=a,e?.duplex&&(n.duplex=e.duplex),Object.assign(Object.assign({},n),r))};function na(t,e,r,a,n,o){return $s(this,void 0,void 0,function*(){return new Promise((i,l)=>{t(r,Jw(e,a,n,o)).then(c=>{if(!c.ok)throw c;return a?.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>Kw(c,l,a))})})}function Ka(t,e,r,a){return $s(this,void 0,void 0,function*(){return na(t,"GET",e,r,a)})}function kt(t,e,r,a,n){return $s(this,void 0,void 0,function*(){return na(t,"POST",e,a,n,r)})}function $o(t,e,r,a,n){return $s(this,void 0,void 0,function*(){return na(t,"PUT",e,a,n,r)})}function Yw(t,e,r,a){return $s(this,void 0,void 0,function*(){return na(t,"HEAD",e,Object.assign(Object.assign({},r),{noResolveJson:!0}),a)})}function ku(t,e,r,a,n){return $s(this,void 0,void 0,function*(){return na(t,"DELETE",e,a,n,r)})}var We=function(t,e,r,a){function n(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(h){try{d(a.next(h))}catch(m){i(m)}}function c(h){try{d(a.throw(h))}catch(m){i(m)}}function d(h){h.done?o(h.value):n(h.value).then(l,c)}d((a=a.apply(t,e||[])).next())})};const Qw={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},tc={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Xw{constructor(e,r={},a,n){this.url=e,this.headers=r,this.bucketId=a,this.fetch=Eu(n)}uploadOrUpdate(e,r,a,n){return We(this,void 0,void 0,function*(){try{let o;const i=Object.assign(Object.assign({},tc),n);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&a instanceof Blob?(o=new FormData,o.append("cacheControl",i.cacheControl),c&&o.append("metadata",this.encodeMetadata(c)),o.append("",a)):typeof FormData<"u"&&a instanceof FormData?(o=a,o.append("cacheControl",i.cacheControl),c&&o.append("metadata",this.encodeMetadata(c))):(o=a,l["cache-control"]=`max-age=${i.cacheControl}`,l["content-type"]=i.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),n?.headers&&(l=Object.assign(Object.assign({},l),n.headers));const d=this._removeEmptyFolders(r),h=this._getFinalPath(d),m=yield(e=="PUT"?$o:kt)(this.fetch,`${this.url}/object/${h}`,o,Object.assign({headers:l},i?.duplex?{duplex:i.duplex}:{}));return{data:{path:d,id:m.Id,fullPath:m.Key},error:null}}catch(o){if(Me(o))return{data:null,error:o};throw o}})}upload(e,r,a){return We(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,r,a)})}uploadToSignedUrl(e,r,a,n){return We(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(e),i=this._getFinalPath(o),l=new URL(this.url+`/object/upload/sign/${i}`);l.searchParams.set("token",r);try{let c;const d=Object.assign({upsert:tc.upsert},n),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&a instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",a)):typeof FormData<"u"&&a instanceof FormData?(c=a,c.append("cacheControl",d.cacheControl)):(c=a,h["cache-control"]=`max-age=${d.cacheControl}`,h["content-type"]=d.contentType);const m=yield $o(this.fetch,l.toString(),c,{headers:h});return{data:{path:o,fullPath:m.Key},error:null}}catch(c){if(Me(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,r){return We(this,void 0,void 0,function*(){try{let a=this._getFinalPath(e);const n=Object.assign({},this.headers);r?.upsert&&(n["x-upsert"]="true");const o=yield kt(this.fetch,`${this.url}/object/upload/sign/${a}`,{},{headers:n}),i=new URL(this.url+o.url),l=i.searchParams.get("token");if(!l)throw new Ti("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:l},error:null}}catch(a){if(Me(a))return{data:null,error:a};throw a}})}update(e,r,a){return We(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,r,a)})}move(e,r,a){return We(this,void 0,void 0,function*(){try{return{data:yield kt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:a?.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(Me(n))return{data:null,error:n};throw n}})}copy(e,r,a){return We(this,void 0,void 0,function*(){try{return{data:{path:(yield kt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:r,destinationBucket:a?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(Me(n))return{data:null,error:n};throw n}})}createSignedUrl(e,r,a){return We(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),o=yield kt(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:r},a?.transform?{transform:a.transform}:{}),{headers:this.headers});const i=a?.download?`&download=${a.download===!0?"":a.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${i}`)},{data:o,error:null}}catch(n){if(Me(n))return{data:null,error:n};throw n}})}createSignedUrls(e,r,a){return We(this,void 0,void 0,function*(){try{const n=yield kt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:e},{headers:this.headers}),o=a?.download?`&download=${a.download===!0?"":a.download}`:"";return{data:n.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${o}`):null})),error:null}}catch(n){if(Me(n))return{data:null,error:n};throw n}})}download(e,r){return We(this,void 0,void 0,function*(){const n=typeof r?.transform<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString(r?.transform||{}),i=o?`?${o}`:"";try{const l=this._getFinalPath(e);return{data:yield(yield Ka(this.fetch,`${this.url}/${n}/${l}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(Me(l))return{data:null,error:l};throw l}})}info(e){return We(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{const a=yield Ka(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Lo(a),error:null}}catch(a){if(Me(a))return{data:null,error:a};throw a}})}exists(e){return We(this,void 0,void 0,function*(){const r=this._getFinalPath(e);try{return yield Yw(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(a){if(Me(a)&&a instanceof Mo){const n=a.originalError;if([400,404].includes(n?.status))return{data:!1,error:a}}throw a}})}getPublicUrl(e,r){const a=this._getFinalPath(e),n=[],o=r?.download?`download=${r.download===!0?"":r.download}`:"";o!==""&&n.push(o);const l=typeof r?.transform<"u"?"render/image":"object",c=this.transformOptsToQueryString(r?.transform||{});c!==""&&n.push(c);let d=n.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${a}${d}`)}}}remove(e){return We(this,void 0,void 0,function*(){try{return{data:yield ku(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(r){if(Me(r))return{data:null,error:r};throw r}})}list(e,r,a){return We(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},Qw),r),{prefix:e||""});return{data:yield kt(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},a),error:null}}catch(n){if(Me(n))return{data:null,error:n};throw n}})}listV2(e,r){return We(this,void 0,void 0,function*(){try{const a=Object.assign({},e);return{data:yield kt(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,a,{headers:this.headers},r),error:null}}catch(a){if(Me(a))return{data:null,error:a};throw a}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const r=[];return e.width&&r.push(`width=${e.width}`),e.height&&r.push(`height=${e.height}`),e.resize&&r.push(`resize=${e.resize}`),e.format&&r.push(`format=${e.format}`),e.quality&&r.push(`quality=${e.quality}`),r.join("&")}}const Zw="2.11.0",eb={"X-Client-Info":`storage-js/${Zw}`};var Qs=function(t,e,r,a){function n(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(h){try{d(a.next(h))}catch(m){i(m)}}function c(h){try{d(a.throw(h))}catch(m){i(m)}}function d(h){h.done?o(h.value):n(h.value).then(l,c)}d((a=a.apply(t,e||[])).next())})};class tb{constructor(e,r={},a,n){const o=new URL(e);n?.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href,this.headers=Object.assign(Object.assign({},eb),r),this.fetch=Eu(a)}listBuckets(){return Qs(this,void 0,void 0,function*(){try{return{data:yield Ka(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(Me(e))return{data:null,error:e};throw e}})}getBucket(e){return Qs(this,void 0,void 0,function*(){try{return{data:yield Ka(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(r){if(Me(r))return{data:null,error:r};throw r}})}createBucket(e,r={public:!1}){return Qs(this,void 0,void 0,function*(){try{return{data:yield kt(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(Me(a))return{data:null,error:a};throw a}})}updateBucket(e,r){return Qs(this,void 0,void 0,function*(){try{return{data:yield $o(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(a){if(Me(a))return{data:null,error:a};throw a}})}emptyBucket(e){return Qs(this,void 0,void 0,function*(){try{return{data:yield kt(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Me(r))return{data:null,error:r};throw r}})}deleteBucket(e){return Qs(this,void 0,void 0,function*(){try{return{data:yield ku(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(r){if(Me(r))return{data:null,error:r};throw r}})}}class sb extends tb{constructor(e,r={},a,n){super(e,r,a,n)}from(e){return new Xw(this.url,this.headers,e,this.fetch)}}const rb="2.56.0";let Ar="";typeof Deno<"u"?Ar="deno":typeof document<"u"?Ar="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ar="react-native":Ar="node";const ab={"X-Client-Info":`supabase-js-${Ar}/${rb}`},nb={headers:ab},ob={schema:"public"},ib={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},lb={};var cb=function(t,e,r,a){function n(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(h){try{d(a.next(h))}catch(m){i(m)}}function c(h){try{d(a.throw(h))}catch(m){i(m)}}function d(h){h.done?o(h.value):n(h.value).then(l,c)}d((a=a.apply(t,e||[])).next())})};const db=t=>{let e;return t?e=t:typeof fetch>"u"?e=vu:e=fetch,(...r)=>e(...r)},ub=()=>typeof Headers>"u"?yu:Headers,hb=(t,e,r)=>{const a=db(r),n=ub();return(o,i)=>cb(void 0,void 0,void 0,function*(){var l;const c=(l=yield e())!==null&&l!==void 0?l:t;let d=new n(i?.headers);return d.has("apikey")||d.set("apikey",t),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),a(o,Object.assign(Object.assign({},i),{headers:d}))})};var mb=function(t,e,r,a){function n(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(h){try{d(a.next(h))}catch(m){i(m)}}function c(h){try{d(a.throw(h))}catch(m){i(m)}}function d(h){h.done?o(h.value):n(h.value).then(l,c)}d((a=a.apply(t,e||[])).next())})};function fb(t){return t.endsWith("/")?t:t+"/"}function pb(t,e){var r,a;const{db:n,auth:o,realtime:i,global:l}=t,{db:c,auth:d,realtime:h,global:m}=e,p={db:Object.assign(Object.assign({},c),n),auth:Object.assign(Object.assign({},d),o),realtime:Object.assign(Object.assign({},h),i),storage:{},global:Object.assign(Object.assign(Object.assign({},m),l),{headers:Object.assign(Object.assign({},(r=m?.headers)!==null&&r!==void 0?r:{}),(a=l?.headers)!==null&&a!==void 0?a:{})}),accessToken:()=>mb(this,void 0,void 0,function*(){return""})};return t.accessToken?p.accessToken=t.accessToken:delete p.accessToken,p}const Tu="2.71.1",nr=30*1e3,Fo=3,Qn=Fo*nr,gb="http://localhost:9999",xb="supabase.auth.token",vb={"X-Client-Info":`gotrue-js/${Tu}`},Uo="X-Supabase-Api-Version",Pu={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},yb=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,wb=600*1e3;class Pi extends Error{constructor(e,r,a){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=a}}function he(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class bb extends Pi{constructor(e,r,a){super(e,r,a),this.name="AuthApiError",this.status=r,this.code=a}}function jb(t){return he(t)&&t.name==="AuthApiError"}class Au extends Pi{constructor(e,r){super(e),this.name="AuthUnknownError",this.originalError=r}}class gs extends Pi{constructor(e,r,a,n){super(e,a,n),this.name=r,this.status=a}}class os extends gs{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Nb(t){return he(t)&&t.name==="AuthSessionMissingError"}class wa extends gs{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ba extends gs{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ja extends gs{constructor(e,r=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Sb(t){return he(t)&&t.name==="AuthImplicitGrantRedirectError"}class sc extends gs{constructor(e,r=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Bo extends gs{constructor(e,r){super(e,"AuthRetryableFetchError",r,void 0)}}function Xn(t){return he(t)&&t.name==="AuthRetryableFetchError"}class rc extends gs{constructor(e,r,a){super(e,"AuthWeakPasswordError",r,"weak_password"),this.reasons=a}}class zo extends gs{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ja="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ac=` 	
\r=`.split(""),_b=(()=>{const t=new Array(128);for(let e=0;e<t.length;e+=1)t[e]=-1;for(let e=0;e<ac.length;e+=1)t[ac[e].charCodeAt(0)]=-2;for(let e=0;e<Ja.length;e+=1)t[Ja[e].charCodeAt(0)]=e;return t})();function nc(t,e,r){if(t!==null)for(e.queue=e.queue<<8|t,e.queuedBits+=8;e.queuedBits>=6;){const a=e.queue>>e.queuedBits-6&63;r(Ja[a]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const a=e.queue>>e.queuedBits-6&63;r(Ja[a]),e.queuedBits-=6}}function Ru(t,e,r){const a=_b[t];if(a>-1)for(e.queue=e.queue<<6|a,e.queuedBits+=6;e.queuedBits>=8;)r(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(a===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function oc(t){const e=[],r=i=>{e.push(String.fromCodePoint(i))},a={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},o=i=>{kb(i,a,r)};for(let i=0;i<t.length;i+=1)Ru(t.charCodeAt(i),n,o);return e.join("")}function Cb(t,e){if(t<=127){e(t);return}else if(t<=2047){e(192|t>>6),e(128|t&63);return}else if(t<=65535){e(224|t>>12),e(128|t>>6&63),e(128|t&63);return}else if(t<=1114111){e(240|t>>18),e(128|t>>12&63),e(128|t>>6&63),e(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function Eb(t,e){for(let r=0;r<t.length;r+=1){let a=t.charCodeAt(r);if(a>55295&&a<=56319){const n=(a-55296)*1024&65535;a=(t.charCodeAt(r+1)-56320&65535|n)+65536,r+=1}Cb(a,e)}}function kb(t,e,r){if(e.utf8seq===0){if(t<=127){r(t);return}for(let a=1;a<6;a+=1)if((t>>7-a&1)===0){e.utf8seq=a;break}if(e.utf8seq===2)e.codepoint=t&31;else if(e.utf8seq===3)e.codepoint=t&15;else if(e.utf8seq===4)e.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|t&63,e.utf8seq-=1,e.utf8seq===0&&r(e.codepoint)}}function Tb(t){const e=[],r={queue:0,queuedBits:0},a=n=>{e.push(n)};for(let n=0;n<t.length;n+=1)Ru(t.charCodeAt(n),r,a);return new Uint8Array(e)}function Pb(t){const e=[];return Eb(t,r=>e.push(r)),new Uint8Array(e)}function Ab(t){const e=[],r={queue:0,queuedBits:0},a=n=>{e.push(n)};return t.forEach(n=>nc(n,r,a)),nc(null,r,a),e.join("")}function Rb(t){return Math.round(Date.now()/1e3)+t}function Ib(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const vt=()=>typeof window<"u"&&typeof document<"u",js={tested:!1,writable:!1},Iu=()=>{if(!vt())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(js.tested)return js.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),js.tested=!0,js.writable=!0}catch{js.tested=!0,js.writable=!1}return js.writable};function Db(t){const e={},r=new URL(t);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((n,o)=>{e[o]=n})}catch{}return r.searchParams.forEach((a,n)=>{e[n]=a}),e}const Du=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...r)=>we(async()=>{const{default:a}=await Promise.resolve().then(()=>jr);return{default:a}},void 0,import.meta.url).then(({default:a})=>a(...r)):e=fetch,(...r)=>e(...r)},Ob=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",or=async(t,e,r)=>{await t.setItem(e,JSON.stringify(r))},Ns=async(t,e)=>{const r=await t.getItem(e);if(!r)return null;try{return JSON.parse(r)}catch{return r}},ns=async(t,e)=>{await t.removeItem(e)};class yn{constructor(){this.promise=new yn.promiseConstructor((e,r)=>{this.resolve=e,this.reject=r})}}yn.promiseConstructor=Promise;function Zn(t){const e=t.split(".");if(e.length!==3)throw new zo("Invalid JWT structure");for(let a=0;a<e.length;a++)if(!yb.test(e[a]))throw new zo("JWT not in base64url format");return{header:JSON.parse(oc(e[0])),payload:JSON.parse(oc(e[1])),signature:Tb(e[2]),raw:{header:e[0],payload:e[1]}}}async function Mb(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function Lb(t,e){return new Promise((a,n)=>{(async()=>{for(let o=0;o<1/0;o++)try{const i=await t(o);if(!e(o,null,i)){a(i);return}}catch(i){if(!e(o,i)){n(i);return}}})()})}function $b(t){return("0"+t.toString(16)).substr(-2)}function Fb(){const e=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",a=r.length;let n="";for(let o=0;o<56;o++)n+=r.charAt(Math.floor(Math.random()*a));return n}return crypto.getRandomValues(e),Array.from(e,$b).join("")}async function Ub(t){const r=new TextEncoder().encode(t),a=await crypto.subtle.digest("SHA-256",r),n=new Uint8Array(a);return Array.from(n).map(o=>String.fromCharCode(o)).join("")}async function Bb(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const r=await Ub(t);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Xs(t,e,r=!1){const a=Fb();let n=a;r&&(n+="/PASSWORD_RECOVERY"),await or(t,`${e}-code-verifier`,n);const o=await Bb(a);return[o,a===o?"plain":"s256"]}const zb=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function qb(t){const e=t.headers.get(Uo);if(!e||!e.match(zb))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function Wb(t){if(!t)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(t<=e)throw new Error("JWT has expired")}function Hb(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Vb=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Zs(t){if(!Vb.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function eo(){const t={};return new Proxy(t,{get:(e,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function ic(t){return JSON.parse(JSON.stringify(t))}var Gb=function(t,e){var r={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(r[a]=t[a]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(t);n<a.length;n++)e.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(t,a[n])&&(r[a[n]]=t[a[n]]);return r};const Ss=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Kb=[502,503,504];async function lc(t){var e;if(!Ob(t))throw new Bo(Ss(t),0);if(Kb.includes(t.status))throw new Bo(Ss(t),t.status);let r;try{r=await t.json()}catch(o){throw new Au(Ss(o),o)}let a;const n=qb(t);if(n&&n.getTime()>=Pu["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?a=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(a=r.error_code),a){if(a==="weak_password")throw new rc(Ss(r),t.status,((e=r.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(a==="session_not_found")throw new os}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((o,i)=>o&&typeof i=="string",!0))throw new rc(Ss(r),t.status,r.weak_password.reasons);throw new bb(Ss(r),t.status||500,a)}const Jb=(t,e,r,a)=>{const n={method:t,headers:e?.headers||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),n.body=JSON.stringify(a),Object.assign(Object.assign({},n),r))};async function pe(t,e,r,a){var n;const o=Object.assign({},a?.headers);o[Uo]||(o[Uo]=Pu["2024-01-01"].name),a?.jwt&&(o.Authorization=`Bearer ${a.jwt}`);const i=(n=a?.query)!==null&&n!==void 0?n:{};a?.redirectTo&&(i.redirect_to=a.redirectTo);const l=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await Yb(t,e,r+l,{headers:o,noResolveJson:a?.noResolveJson},{},a?.body);return a?.xform?a?.xform(c):{data:Object.assign({},c),error:null}}async function Yb(t,e,r,a,n,o){const i=Jb(e,a,n,o);let l;try{l=await t(r,Object.assign({},i))}catch(c){throw console.error(c),new Bo(Ss(c),0)}if(l.ok||await lc(l),a?.noResolveJson)return l;try{return await l.json()}catch(c){await lc(c)}}function Bt(t){var e;let r=null;e0(t)&&(r=Object.assign({},t),t.expires_at||(r.expires_at=Rb(t.expires_in)));const a=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:r,user:a},error:null}}function cc(t){const e=Bt(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((r,a)=>r&&typeof a=="string",!0)&&(e.data.weak_password=t.weak_password),e}function ls(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function Qb(t){return{data:t,error:null}}function Xb(t){const{action_link:e,email_otp:r,hashed_token:a,redirect_to:n,verification_type:o}=t,i=Gb(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:r,hashed_token:a,redirect_to:n,verification_type:o},c=Object.assign({},i);return{data:{properties:l,user:c},error:null}}function Zb(t){return t}function e0(t){return t.access_token&&t.refresh_token&&t.expires_in}const to=["global","local","others"];var t0=function(t,e){var r={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(r[a]=t[a]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(t);n<a.length;n++)e.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(t,a[n])&&(r[a[n]]=t[a[n]]);return r};class s0{constructor({url:e="",headers:r={},fetch:a}){this.url=e,this.headers=r,this.fetch=Du(a),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,r=to[0]){if(to.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${to.join(", ")}`);try{return await pe(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(a){if(he(a))return{data:null,error:a};throw a}}async inviteUserByEmail(e,r={}){try{return await pe(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:ls})}catch(a){if(he(a))return{data:{user:null},error:a};throw a}}async generateLink(e){try{const{options:r}=e,a=t0(e,["options"]),n=Object.assign(Object.assign({},a),r);return"newEmail"in a&&(n.new_email=a?.newEmail,delete n.newEmail),await pe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:Xb,redirectTo:r?.redirectTo})}catch(r){if(he(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(e){try{return await pe(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ls})}catch(r){if(he(r))return{data:{user:null},error:r};throw r}}async listUsers(e){var r,a,n,o,i,l,c;try{const d={nextPage:null,lastPage:0,total:0},h=await pe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(a=(r=e?.page)===null||r===void 0?void 0:r.toString())!==null&&a!==void 0?a:"",per_page:(o=(n=e?.perPage)===null||n===void 0?void 0:n.toString())!==null&&o!==void 0?o:""},xform:Zb});if(h.error)throw h.error;const m=await h.json(),p=(i=h.headers.get("x-total-count"))!==null&&i!==void 0?i:0,f=(c=(l=h.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return f.length>0&&(f.forEach(b=>{const g=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(b.split(";")[1].split("=")[1]);d[`${y}Page`]=g}),d.total=parseInt(p)),{data:Object.assign(Object.assign({},m),d),error:null}}catch(d){if(he(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Zs(e);try{return await pe(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ls})}catch(r){if(he(r))return{data:{user:null},error:r};throw r}}async updateUserById(e,r){Zs(e);try{return await pe(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:r,headers:this.headers,xform:ls})}catch(a){if(he(a))return{data:{user:null},error:a};throw a}}async deleteUser(e,r=!1){Zs(e);try{return await pe(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:r},xform:ls})}catch(a){if(he(a))return{data:{user:null},error:a};throw a}}async _listFactors(e){Zs(e.userId);try{const{data:r,error:a}=await pe(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:n=>({data:{factors:n},error:null})});return{data:r,error:a}}catch(r){if(he(r))return{data:null,error:r};throw r}}async _deleteFactor(e){Zs(e.userId),Zs(e.id);try{return{data:await pe(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(r){if(he(r))return{data:null,error:r};throw r}}}function dc(t={}){return{getItem:e=>t[e]||null,setItem:(e,r)=>{t[e]=r},removeItem:e=>{delete t[e]}}}function r0(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const er={debug:!!(globalThis&&Iu()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Ou extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class a0 extends Ou{}async function n0(t,e,r){er.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const a=new globalThis.AbortController;return e>0&&setTimeout(()=>{a.abort(),er.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:a.signal},async n=>{if(n){er.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,n.name);try{return await r()}finally{er.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,n.name)}}else{if(e===0)throw er.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new a0(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(er.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}r0();const o0={url:gb,storageKey:xb,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:vb,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function uc(t,e,r){return await r()}const tr={};class Wr{constructor(e){var r,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Wr.nextInstanceID,Wr.nextInstanceID+=1,this.instanceID>0&&vt()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},o0),e);if(this.logDebugMessages=!!n.debug,typeof n.debug=="function"&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new s0({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=Du(n.fetch),this.lock=n.lock||uc,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:vt()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=n0:this.lock=uc,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:Iu()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=dc(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=dc(this.memoryStorage)),vt()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}get jwks(){var e,r;return(r=(e=tr[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(e){tr[this.storageKey]=Object.assign(Object.assign({},tr[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,r;return(r=(e=tr[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){tr[this.storageKey]=Object.assign(Object.assign({},tr[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Tu}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const r=Db(window.location.href);let a="none";if(this._isImplicitGrantCallback(r)?a="implicit":await this._isPKCECallback(r)&&(a="pkce"),vt()&&this.detectSessionInUrl&&a!=="none"){const{data:n,error:o}=await this._getSessionFromURL(r,a);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),Sb(o)){const c=(e=o.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:i,redirectType:l}=n;return this._debug("#_initialize()","detected session in URL",i,"redirect type",l),await this._saveSession(i),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return he(r)?{error:r}:{error:new Au("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var r,a,n;try{const o=await pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(a=(r=e?.options)===null||r===void 0?void 0:r.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:(n=e?.options)===null||n===void 0?void 0:n.captchaToken}},xform:Bt}),{data:i,error:l}=o;if(l||!i)return{data:{user:null,session:null},error:l};const c=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(o){if(he(o))return{data:{user:null,session:null},error:o};throw o}}async signUp(e){var r,a,n;try{let o;if("email"in e){const{email:h,password:m,options:p}=e;let f=null,b=null;this.flowType==="pkce"&&([f,b]=await Xs(this.storage,this.storageKey)),o=await pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p?.emailRedirectTo,body:{email:h,password:m,data:(r=p?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:p?.captchaToken},code_challenge:f,code_challenge_method:b},xform:Bt})}else if("phone"in e){const{phone:h,password:m,options:p}=e;o=await pe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:m,data:(a=p?.data)!==null&&a!==void 0?a:{},channel:(n=p?.channel)!==null&&n!==void 0?n:"sms",gotrue_meta_security:{captcha_token:p?.captchaToken}},xform:Bt})}else throw new ba("You must provide either an email or phone number and a password");const{data:i,error:l}=o;if(l||!i)return{data:{user:null,session:null},error:l};const c=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(o){if(he(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithPassword(e){try{let r;if("email"in e){const{email:o,password:i,options:l}=e;r=await pe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:i,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:cc})}else if("phone"in e){const{phone:o,password:i,options:l}=e;r=await pe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:i,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:cc})}else throw new ba("You must provide either an email or phone number and a password");const{data:a,error:n}=r;return n?{data:{user:null,session:null},error:n}:!a||!a.session||!a.user?{data:{user:null,session:null},error:new wa}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign({user:a.user,session:a.session},a.weak_password?{weakPassword:a.weak_password}:null),error:n})}catch(r){if(he(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(e){var r,a,n,o;return await this._handleProviderSignIn(e.provider,{redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(n=e.options)===null||n===void 0?void 0:n.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:r}=e;if(r==="solana")return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}async signInWithSolana(e){var r,a,n,o,i,l,c,d,h,m,p,f;let b,g;if("message"in e)b=e.message,g=e.signature;else{const{chain:y,wallet:w,statement:v,options:x}=e;let j;if(vt())if(typeof w=="object")j=w;else{const S=window;if("solana"in S&&typeof S.solana=="object"&&("signIn"in S.solana&&typeof S.solana.signIn=="function"||"signMessage"in S.solana&&typeof S.solana.signMessage=="function"))j=S.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!x?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");j=w}const N=new URL((r=x?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in j&&j.signIn){const S=await j.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},x?.signInWithSolana),{version:"1",domain:N.host,uri:N.href}),v?{statement:v}:null));let _;if(Array.isArray(S)&&S[0]&&typeof S[0]=="object")_=S[0];else if(S&&typeof S=="object"&&"signedMessage"in S&&"signature"in S)_=S;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in _&&"signature"in _&&(typeof _.signedMessage=="string"||_.signedMessage instanceof Uint8Array)&&_.signature instanceof Uint8Array)b=typeof _.signedMessage=="string"?_.signedMessage:new TextDecoder().decode(_.signedMessage),g=_.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in j)||typeof j.signMessage!="function"||!("publicKey"in j)||typeof j!="object"||!j.publicKey||!("toBase58"in j.publicKey)||typeof j.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${N.host} wants you to sign in with your Solana account:`,j.publicKey.toBase58(),...v?["",v,""]:[""],"Version: 1",`URI: ${N.href}`,`Issued At: ${(n=(a=x?.signInWithSolana)===null||a===void 0?void 0:a.issuedAt)!==null&&n!==void 0?n:new Date().toISOString()}`,...!((o=x?.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${x.signInWithSolana.notBefore}`]:[],...!((i=x?.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${x.signInWithSolana.expirationTime}`]:[],...!((l=x?.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${x.signInWithSolana.chainId}`]:[],...!((c=x?.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${x.signInWithSolana.nonce}`]:[],...!((d=x?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${x.signInWithSolana.requestId}`]:[],...!((m=(h=x?.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||m===void 0)&&m.length?["Resources",...x.signInWithSolana.resources.map(_=>`- ${_}`)]:[]].join(`
`);const S=await j.signMessage(new TextEncoder().encode(b),"utf8");if(!S||!(S instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");g=S}}try{const{data:y,error:w}=await pe(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:Ab(g)},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(f=e.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Bt});if(w)throw w;return!y||!y.session||!y.user?{data:{user:null,session:null},error:new wa}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign({},y),error:w})}catch(y){if(he(y))return{data:{user:null,session:null},error:y};throw y}}async _exchangeCodeForSession(e){const r=await Ns(this.storage,`${this.storageKey}-code-verifier`),[a,n]=(r??"").split("/");try{const{data:o,error:i}=await pe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:a},xform:Bt});if(await ns(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new wa}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:n??null}),error:i})}catch(o){if(he(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}}async signInWithIdToken(e){try{const{options:r,provider:a,token:n,access_token:o,nonce:i}=e,l=await pe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:a,id_token:n,access_token:o,nonce:i,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:Bt}),{data:c,error:d}=l;return d?{data:{user:null,session:null},error:d}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new wa}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:d})}catch(r){if(he(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(e){var r,a,n,o,i;try{if("email"in e){const{email:l,options:c}=e;let d=null,h=null;this.flowType==="pkce"&&([d,h]=await Xs(this.storage,this.storageKey));const{error:m}=await pe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(r=c?.data)!==null&&r!==void 0?r:{},create_user:(a=c?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},code_challenge:d,code_challenge_method:h},redirectTo:c?.emailRedirectTo});return{data:{user:null,session:null},error:m}}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:h}=await pe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(n=c?.data)!==null&&n!==void 0?n:{},create_user:(o=c?.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},channel:(i=c?.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:d?.message_id},error:h}}throw new ba("You must provide either an email or phone number.")}catch(l){if(he(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var r,a;try{let n,o;"options"in e&&(n=(r=e.options)===null||r===void 0?void 0:r.redirectTo,o=(a=e.options)===null||a===void 0?void 0:a.captchaToken);const{data:i,error:l}=await pe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:n,xform:Bt});if(l)throw l;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,d=i.user;return c?.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:d,session:c},error:null}}catch(n){if(he(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var r,a,n;try{let o=null,i=null;return this.flowType==="pkce"&&([o,i]=await Xs(this.storage,this.storageKey)),await pe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(a=(r=e.options)===null||r===void 0?void 0:r.redirectTo)!==null&&a!==void 0?a:void 0}),!((n=e?.options)===null||n===void 0)&&n.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:i}),headers:this.headers,xform:Qb})}catch(o){if(he(o))return{data:null,error:o};throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:r},error:a}=e;if(a)throw a;if(!r)throw new os;const{error:n}=await pe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(he(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const r=`${this.url}/resend`;if("email"in e){const{email:a,type:n,options:o}=e,{error:i}=await pe(this.fetch,"POST",r,{headers:this.headers,body:{email:a,type:n,gotrue_meta_security:{captcha_token:o?.captchaToken}},redirectTo:o?.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in e){const{phone:a,type:n,options:o}=e,{data:i,error:l}=await pe(this.fetch,"POST",r,{headers:this.headers,body:{phone:a,type:n,gotrue_meta_security:{captcha_token:o?.captchaToken}}});return{data:{user:null,session:null,messageId:i?.message_id},error:l}}throw new ba("You must provide either an email or phone number and a type")}catch(r){if(he(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(e,r){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const a=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),n=(async()=>(await a,await r()))();return this.pendingInLock.push((async()=>{try{await n}catch{}})()),n}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const a=r();for(this.pendingInLock.push((async()=>{try{await a}catch{}})()),await a;this.pendingInLock.length;){const n=[...this.pendingInLock];await Promise.all(n),this.pendingInLock.splice(0,n.length)}return await a}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await e(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const r=await Ns(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?e=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const a=e.expires_at?e.expires_at*1e3-Date.now()<Qn:!1;if(this._debug("#__loadSession()",`session has${a?"":" not"} expired`,"expires_at",e.expires_at),!a){if(this.userStorage){const i=await Ns(this.userStorage,this.storageKey+"-user");i?.user?e.user=i.user:e.user=eo()}if(this.storage.isServer&&e.user){let i=this.suppressGetSessionWarning;e=new Proxy(e,{get:(c,d,h)=>(!i&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,d,h))})}return{data:{session:e},error:null}}const{session:n,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{session:null},error:o}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await pe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ls}):await this._useSession(async r=>{var a,n,o;const{data:i,error:l}=r;if(l)throw l;return!(!((a=i.session)===null||a===void 0)&&a.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new os}:await pe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&o!==void 0?o:void 0,xform:ls})})}catch(r){if(he(r))return Nb(r)&&(await this._removeSession(),await ns(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(e,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,r))}async _updateUser(e,r={}){try{return await this._useSession(async a=>{const{data:n,error:o}=a;if(o)throw o;if(!n.session)throw new os;const i=n.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await Xs(this.storage,this.storageKey));const{data:d,error:h}=await pe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:i.access_token,xform:ls});if(h)throw h;return i.user=d.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(a){if(he(a))return{data:{user:null},error:a};throw a}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new os;const r=Date.now()/1e3;let a=r,n=!0,o=null;const{payload:i}=Zn(e.access_token);if(i.exp&&(a=i.exp,n=a<=r),n){const{session:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};o=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;o={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:a-r,expires_at:a},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(r){if(he(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async r=>{var a;if(!e){const{data:i,error:l}=r;if(l)throw l;e=(a=i.session)!==null&&a!==void 0?a:void 0}if(!e?.refresh_token)throw new os;const{session:n,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{user:null,session:null},error:o}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(he(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(e,r){try{if(!vt())throw new ja("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ja(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new sc("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ja("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new sc("No code detected.");const{data:v,error:x}=await this._exchangeCodeForSession(e.code);if(x)throw x;const j=new URL(window.location.href);return j.searchParams.delete("code"),window.history.replaceState(window.history.state,"",j.toString()),{data:{session:v.session,redirectType:null},error:null}}const{provider_token:a,provider_refresh_token:n,access_token:o,refresh_token:i,expires_in:l,expires_at:c,token_type:d}=e;if(!o||!l||!i||!d)throw new ja("No session defined in URL");const h=Math.round(Date.now()/1e3),m=parseInt(l);let p=h+m;c&&(p=parseInt(c));const f=p-h;f*1e3<=nr&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${m}s`);const b=p-m;h-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,p,h):h-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,p,h);const{data:g,error:y}=await this._getUser(o);if(y)throw y;const w={provider_token:a,provider_refresh_token:n,access_token:o,expires_in:m,expires_at:p,refresh_token:i,token_type:d,user:g.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:w,redirectType:e.type},error:null}}catch(a){if(he(a))return{data:{session:null,redirectType:null},error:a};throw a}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const r=await Ns(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&r)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async r=>{var a;const{data:n,error:o}=r;if(o)return{error:o};const i=(a=n.session)===null||a===void 0?void 0:a.access_token;if(i){const{error:l}=await this.admin.signOut(i,e);if(l&&!(jb(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await ns(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const r=Ib(),a={id:r,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,a),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:a}}}async _emitInitialSession(e){return await this._useSession(async r=>{var a,n;try{const{data:{session:o},error:i}=r;if(i)throw i;await((a=this.stateChangeEmitters.get(e))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}})}async resetPasswordForEmail(e,r={}){let a=null,n=null;this.flowType==="pkce"&&([a,n]=await Xs(this.storage,this.storageKey,!0));try{return await pe(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:a,code_challenge_method:n,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(o){if(he(o))return{data:null,error:o};throw o}}async getUserIdentities(){var e;try{const{data:r,error:a}=await this.getUser();if(a)throw a;return{data:{identities:(e=r.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(r){if(he(r))return{data:null,error:r};throw r}}async linkIdentity(e){var r;try{const{data:a,error:n}=await this._useSession(async o=>{var i,l,c,d,h;const{data:m,error:p}=o;if(p)throw p;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await pe(this.fetch,"GET",f,{headers:this.headers,jwt:(h=(d=m.session)===null||d===void 0?void 0:d.access_token)!==null&&h!==void 0?h:void 0})});if(n)throw n;return vt()&&!(!((r=e.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(a?.url),{data:{provider:e.provider,url:a?.url},error:null}}catch(a){if(he(a))return{data:{provider:e.provider,url:null},error:a};throw a}}async unlinkIdentity(e){try{return await this._useSession(async r=>{var a,n;const{data:o,error:i}=r;if(i)throw i;return await pe(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(n=(a=o.session)===null||a===void 0?void 0:a.access_token)!==null&&n!==void 0?n:void 0})})}catch(r){if(he(r))return{data:null,error:r};throw r}}async _refreshAccessToken(e){const r=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{const a=Date.now();return await Lb(async n=>(n>0&&await Mb(200*Math.pow(2,n-1)),this._debug(r,"refreshing attempt",n),await pe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Bt})),(n,o)=>{const i=200*Math.pow(2,n);return o&&Xn(o)&&Date.now()+i-a<nr})}catch(a){if(this._debug(r,"error",a),he(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(r,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,r){const a=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",r,"url",a),vt()&&!r.skipBrowserRedirect&&window.location.assign(a),{data:{provider:e,url:a},error:null}}async _recoverAndRefresh(){var e,r;const a="#_recoverAndRefresh()";this._debug(a,"begin");try{const n=await Ns(this.storage,this.storageKey);if(n&&this.userStorage){let i=await Ns(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:n.user},await or(this.userStorage,this.storageKey+"-user",i)),n.user=(e=i?.user)!==null&&e!==void 0?e:eo()}else if(n&&!n.user&&!n.user){const i=await Ns(this.storage,this.storageKey+"-user");i&&i?.user?(n.user=i.user,await ns(this.storage,this.storageKey+"-user"),await or(this.storage,this.storageKey,n)):n.user=eo()}if(this._debug(a,"session from storage",n),!this._isValidSession(n)){this._debug(a,"session is not valid"),n!==null&&await this._removeSession();return}const o=((r=n.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Qn;if(this._debug(a,`session has${o?"":" not"} expired with margin of ${Qn}s`),o){if(this.autoRefreshToken&&n.refresh_token){const{error:i}=await this._callRefreshToken(n.refresh_token);i&&(console.error(i),Xn(i)||(this._debug(a,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(n.user&&n.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:l}=await this._getUser(n.access_token);!l&&i?.user?(n.user=i.user,await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)):this._debug(a,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(a,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(a,"error",n),console.error(n);return}finally{this._debug(a,"end")}}async _callRefreshToken(e){var r,a;if(!e)throw new os;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new yn;const{data:o,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!o.session)throw new os;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const l={session:o.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(o){if(this._debug(n,"error",o),he(o)){const i={session:null,error:o};return Xn(o)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(a=this.refreshingDeferred)===null||a===void 0||a.reject(o),o}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,r,a=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",r,`broadcast = ${a}`);try{this.broadcastChannel&&a&&this.broadcastChannel.postMessage({event:e,session:r});const o=[],i=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,r)}catch(c){o.push(c)}});if(await Promise.all(i),o.length>0){for(let l=0;l<o.length;l+=1)console.error(o[l]);throw o[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const r=Object.assign({},e),a=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!a&&r.user&&await or(this.userStorage,this.storageKey+"-user",{user:r.user});const n=Object.assign({},r);delete n.user;const o=ic(n);await or(this.storage,this.storageKey,o)}else{const n=ic(r);await or(this.storage,this.storageKey,n)}}async _removeSession(){this._debug("#_removeSession()"),await ns(this.storage,this.storageKey),await ns(this.storage,this.storageKey+"-code-verifier"),await ns(this.storage,this.storageKey+"-user"),this.userStorage&&await ns(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&vt()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),nr);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async r=>{const{data:{session:a}}=r;if(!a||!a.refresh_token||!a.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const n=Math.floor((a.expires_at*1e3-e)/nr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts ${nr}ms, refresh threshold is ${Fo} ticks`),n<=Fo&&await this._callRefreshToken(a.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof Ou)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!vt()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const r=`#_onVisibilityChanged(${e})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,r,a){const n=[`provider=${encodeURIComponent(r)}`];if(a?.redirectTo&&n.push(`redirect_to=${encodeURIComponent(a.redirectTo)}`),a?.scopes&&n.push(`scopes=${encodeURIComponent(a.scopes)}`),this.flowType==="pkce"){const[o,i]=await Xs(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(i)}`});n.push(l.toString())}if(a?.queryParams){const o=new URLSearchParams(a.queryParams);n.push(o.toString())}return a?.skipBrowserRedirect&&n.push(`skip_http_redirect=${a.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async r=>{var a;const{data:n,error:o}=r;return o?{data:null,error:o}:await pe(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(a=n?.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(he(r))return{data:null,error:r};throw r}}async _enroll(e){try{return await this._useSession(async r=>{var a,n;const{data:o,error:i}=r;if(i)return{data:null,error:i};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:c,error:d}=await pe(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(a=o?.session)===null||a===void 0?void 0:a.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&(!((n=c?.totp)===null||n===void 0)&&n.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(he(r))return{data:null,error:r};throw r}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:n,error:o}=r;if(o)return{data:null,error:o};const{data:i,error:l}=await pe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(a=n?.session)===null||a===void 0?void 0:a.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:l})})}catch(r){if(he(r))return{data:null,error:r};throw r}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var a;const{data:n,error:o}=r;return o?{data:null,error:o}:await pe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(a=n?.session)===null||a===void 0?void 0:a.access_token})})}catch(r){if(he(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(e){const{data:r,error:a}=await this._challenge({factorId:e.factorId});return a?{data:null,error:a}:await this._verify({factorId:e.factorId,challengeId:r.id,code:e.code})}async _listFactors(){const{data:{user:e},error:r}=await this.getUser();if(r)return{data:null,error:r};const a=e?.factors||[],n=a.filter(i=>i.factor_type==="totp"&&i.status==="verified"),o=a.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:a,totp:n,phone:o},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var r,a;const{data:{session:n},error:o}=e;if(o)return{data:null,error:o};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=Zn(n.access_token);let l=null;i.aal&&(l=i.aal);let c=l;((a=(r=n.user.factors)===null||r===void 0?void 0:r.filter(m=>m.status==="verified"))!==null&&a!==void 0?a:[]).length>0&&(c="aal2");const h=i.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:h},error:null}}))}async fetchJwk(e,r={keys:[]}){let a=r.keys.find(l=>l.kid===e);if(a)return a;const n=Date.now();if(a=this.jwks.keys.find(l=>l.kid===e),a&&this.jwks_cached_at+wb>n)return a;const{data:o,error:i}=await pe(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=n,a=o.keys.find(l=>l.kid===e),!a)?null:a}async getClaims(e,r={}){try{let a=e;if(!a){const{data:f,error:b}=await this.getSession();if(b||!f.session)return{data:null,error:b};a=f.session.access_token}const{header:n,payload:o,signature:i,raw:{header:l,payload:c}}=Zn(a);r?.allowExpired||Wb(o.exp);const d=!n.alg||n.alg.startsWith("HS")||!n.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(n.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!d){const{error:f}=await this.getUser(a);if(f)throw f;return{data:{claims:o,header:n,signature:i},error:null}}const h=Hb(n.alg),m=await crypto.subtle.importKey("jwk",d,h,!0,["verify"]);if(!await crypto.subtle.verify(h,m,i,Pb(`${l}.${c}`)))throw new zo("Invalid JWT signature");return{data:{claims:o,header:n,signature:i},error:null}}catch(a){if(he(a))return{data:null,error:a};throw a}}}Wr.nextInstanceID=0;const i0=Wr;class l0 extends i0{constructor(e){super(e)}}var c0=function(t,e,r,a){function n(o){return o instanceof r?o:new r(function(i){i(o)})}return new(r||(r=Promise))(function(o,i){function l(h){try{d(a.next(h))}catch(m){i(m)}}function c(h){try{d(a.throw(h))}catch(m){i(m)}}function d(h){h.done?o(h.value):n(h.value).then(l,c)}d((a=a.apply(t,e||[])).next())})};class d0{constructor(e,r,a){var n,o,i;if(this.supabaseUrl=e,this.supabaseKey=r,!e)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const l=fb(e),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const d=`sb-${c.hostname.split(".")[0]}-auth-token`,h={db:ob,realtime:lb,auth:Object.assign(Object.assign({},ib),{storageKey:d}),global:nb},m=pb(a??{},h);this.storageKey=(n=m.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(o=m.global.headers)!==null&&o!==void 0?o:{},m.accessToken?(this.accessToken=m.accessToken,this.auth=new Proxy({},{get:(p,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=m.auth)!==null&&i!==void 0?i:{},this.headers,m.global.fetch),this.fetch=hb(r,this._getAccessToken.bind(this),m.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},m.realtime)),this.rest=new Cw(new URL("rest/v1",c).href,{headers:this.headers,schema:m.db.schema,fetch:this.fetch}),this.storage=new sb(this.storageUrl.href,this.headers,this.fetch,a?.storage),m.accessToken||this._listenForAuthEvents()}get functions(){return new gw(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,r={},a={}){return this.rest.rpc(e,r,a)}channel(e,r={config:{}}){return this.realtime.channel(e,r)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,r;return c0(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:a}=yield this.auth.getSession();return(r=(e=a.session)===null||e===void 0?void 0:e.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:r,detectSessionInUrl:a,storage:n,storageKey:o,flowType:i,lock:l,debug:c},d,h){const m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new l0({url:this.authUrl.href,headers:Object.assign(Object.assign({},m),d),storageKey:o,autoRefreshToken:e,persistSession:r,detectSessionInUrl:a,storage:n,flowType:i,lock:l,debug:c,fetch:h,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new qw(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,a)=>{this._handleTokenChanged(r,"CLIENT",a?.access_token)})}_handleTokenChanged(e,r,a){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==a?this.changedAccessToken=a:e==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const u0=(t,e,r)=>new d0(t,e,r);function h0(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const e=t.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}h0()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const m0="https://gserzaenfrmrqoffzcxr.supabase.co",hc="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdzZXJ6YWVuZnJtcnFvZmZ6Y3hyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYxMTc3OTksImV4cCI6MjA3MTY5Mzc5OX0.QjIchTrYF-P47wzEA12rN60xdF7rclYyst_28tet80I",le=u0(m0,hc,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!1,flowType:"pkce",storage:window.localStorage,storageKey:"sb-auth-token"},global:{headers:{apikey:hc},fetch:(t,e={})=>fetch(t,{...e,signal:AbortSignal.timeout(15e3)})},db:{schema:"public"},realtime:{params:{eventsPerSecond:1}}}),Jt=Object.freeze(Object.defineProperty({__proto__:null,supabase:le},Symbol.toStringTag,{value:"Module"}));class f0{userKey="user";async convertSupabaseUser(e){const{data:r,error:a}=await le.from("users").select("*").eq("id",e.id).single();return a?(a.code!=="PGRST116"&&console.error("Error fetching user data:",a),{id:e.id,email:e.email||"",username:e.user_metadata?.username||"",name:e.user_metadata?.name||"",avatar:e.user_metadata?.avatar_url,bio:"",location:"",verified:e.email_confirmed_at!==null,createdAt:e.created_at,updatedAt:e.updated_at||e.created_at}):{id:r.id,email:r.email,username:r.username||"",name:`${r.first_name} ${r.last_name}`.trim(),avatar:r.avatar_url,bio:r.bio||"",location:r.location||"",verified:r.email_verified||!1,createdAt:r.created_at,updatedAt:r.updated_at}}async login(e){const{data:r,error:a}=await le.auth.signInWithPassword({email:e.email,password:e.password});if(a)throw new Error(a.message);if(!r.user||!r.session)throw new Error("Login failed - no user or session returned");const n=await this.convertSupabaseUser(r.user);return this.setUser(n),{user:n,token:r.session.access_token,refreshToken:r.session.refresh_token,expiresIn:r.session.expires_in||3600}}async register(e){if(e.password!==e.confirmPassword)throw new Error("Passwords do not match");const[r,...a]=e.name.split(" "),n=a.join(" "),{data:o,error:i}=await le.auth.signUp({email:e.email,password:e.password,options:{data:{username:e.username,name:e.name,first_name:r,last_name:n}}});if(i)throw new Error(i.message);if(!o.user)throw new Error("Registration failed - no user returned");const{error:l}=await le.from("users").insert({id:o.user.id,email:e.email,username:e.username,first_name:r,last_name:n,email_verified:!1,is_active:!0});l&&console.error("Error inserting user data:",l);const c=await this.convertSupabaseUser(o.user);return o.session?(this.setUser(c),{user:c,token:o.session.access_token,refreshToken:o.session.refresh_token,expiresIn:o.session.expires_in||3600}):{user:c,token:"",refreshToken:"",expiresIn:0}}async logout(){try{console.log(" Signing out from Supabase..."),await le.auth.signOut({scope:"global"}),console.log(" Supabase signout completed")}catch(e){console.error(" Supabase logout error:",e)}finally{console.log(" Clearing local auth data..."),this.clearAuthData(),console.log(" Local auth data cleared")}}async refreshToken(){const{data:e,error:r}=await le.auth.refreshSession();if(r||!e.session||!e.user)throw new Error(r?.message||"Token refresh failed");const a=await this.convertSupabaseUser(e.user);return this.setUser(a),{user:a,token:e.session.access_token,refreshToken:e.session.refresh_token,expiresIn:e.session.expires_in||3600}}async getProfile(){const{data:{user:e},error:r}=await le.auth.getUser();if(r||!e)throw new Error(r?.message||"Failed to get user profile");try{const a=await this.convertSupabaseUser(e);return this.setUser(a),a}catch(a){console.warn(" Profile fetch failed, using ghost profile:",a);const n={id:e.id,email:e.email||"",username:e.user_metadata?.username||"",name:e.user_metadata?.name||e.email?.split("@")[0]||"Traveler",avatar:e.user_metadata?.avatar_url,bio:"",location:"",verified:e.email_confirmed_at!==null,createdAt:e.created_at,updatedAt:e.updated_at||e.created_at};return this.setUser(n),n}}async forgotPassword(e){const{error:r}=await le.auth.resetPasswordForEmail(e.email,{redirectTo:`${window.location.origin}/reset-password`});if(r)throw new Error(r.message)}async resetPassword(e){if(e.password!==e.confirmPassword)throw new Error("Passwords do not match");const{error:r}=await le.auth.updateUser({password:e.password});if(r)throw new Error(r.message)}isAuthenticated(){return!!this.getUser()}getToken(){return le.auth.getSession().then(({data:e})=>e.session?.access_token||null)}getRefreshToken(){return le.auth.getSession().then(({data:e})=>e.session?.refresh_token||null)}getUser(){const e=localStorage.getItem(this.userKey);return e?JSON.parse(e):null}setUser(e){localStorage.setItem(this.userKey,JSON.stringify(e))}async updateProfile(e){const{data:{user:r},error:a}=await le.auth.getUser();if(a||!r)throw new Error("Not authenticated");const n={};if(e.name){const[l,...c]=e.name.split(" ");n.data={...r.user_metadata,name:e.name,first_name:l,last_name:c.join(" ")}}if(Object.keys(n).length>0){const{error:l}=await le.auth.updateUser(n);if(l)throw new Error(l.message)}const o={};if(e.username&&(o.username=e.username),e.bio&&(o.bio=e.bio),e.location&&(o.location=e.location),e.avatar&&(o.avatar_url=e.avatar),e.name){const[l,...c]=e.name.split(" ");o.first_name=l,o.last_name=c.join(" ")}if(Object.keys(o).length>0){const{error:l}=await le.from("users").update(o).eq("id",r.id);if(l)throw new Error(l.message)}const i=await this.convertSupabaseUser(r);return this.setUser(i),i}clearAuthData(){console.log(" Clearing all authentication data..."),localStorage.removeItem(this.userKey),["supabase.auth.token","sb-auth-token","sb-refresh-token"].forEach(r=>{localStorage.removeItem(r),sessionStorage.removeItem(r)}),Object.keys(localStorage).forEach(r=>{(r.startsWith("sb-")||r.includes("supabase"))&&localStorage.removeItem(r)}),Object.keys(sessionStorage).forEach(r=>{(r.startsWith("sb-")||r.includes("supabase"))&&sessionStorage.removeItem(r)}),console.log(" All authentication data cleared")}async getSession(){try{const{data:e,error:r}=await le.auth.getSession();if(r)return console.error(" Error getting session:",r),null;const a=e.session;if(a&&a.expires_at&&a.expires_at*1e3<Date.now()){console.log(" Session expired, attempting refresh...");try{const{data:n,error:o}=await le.auth.refreshSession();return o||!n.session?(console.log(" Token refresh failed, clearing session..."),await this.logout(),null):(console.log(" Session refreshed successfully"),n.session)}catch(n){return console.error(" Error refreshing session:",n),await this.logout(),null}}return a}catch(e){return console.error(" Failed to get session:",e),null}}async validateSession(e){try{if(e.expires_at&&e.expires_at*1e3<Date.now())return console.log(" Session expired"),!1;const{data:r,error:a}=await le.auth.getUser();return a||!r.user?(console.log(" Session validation failed:",a?.message||"No user"),!1):!0}catch(r){return console.error(" Session validation error:",r),!1}}onAuthStateChange(e){return le.auth.onAuthStateChange(e)}}const Ue=new f0,Mu=u.createContext(void 0);function mt(){const t=u.useContext(Mu);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}function p0({children:t}){const[e,r]=u.useState(null),[a,n]=u.useState(!0),o=!!e,i=f=>{const b=f.name&&typeof f.name=="string"?f.name:"Traveler",[g="Traveler",y=""]=b.split(" ");return{id:f.id,email:f.email,username:f.username,firstName:g,lastName:y,avatar:f.avatar,bio:f.bio,location:f.location,isVerified:f.verified,isOnline:!0,lastSeen:new Date().toISOString(),createdAt:f.createdAt,updatedAt:f.updatedAt,preferences:{language:"en",currency:"USD",timezone:"UTC",notifications:{email:!0,push:!0,sms:!1,tripUpdates:!0,friendRequests:!0,messages:!0,promotions:!1},privacy:{profileVisibility:"public",showEmail:!1,showPhone:!1,showLocation:!0,allowFriendRequests:!0,allowMessages:!0},travelPreferences:{budgetRange:{min:0,max:5e3},preferredDestinations:[],travelStyle:"mid-range",accommodationType:[],transportModes:[],interests:[]}},stats:{tripsCompleted:0,countriesVisited:0,citiesVisited:0,totalDistance:0,totalSpent:0,friendsCount:0,followersCount:0,followingCount:0,reviewsCount:0,averageRating:0}}};u.useEffect(()=>{const f=async()=>{console.log(" Starting auth initialization...");try{const y=new Promise((v,x)=>{setTimeout(()=>x(new Error("Auth initialization timeout")),3e4)}),w=await Promise.race([Ue.getSession(),y]);if(console.log(" Session retrieved:",w?"Found":"None"),w?.user&&w?.access_token){console.log(" Session found, getting user profile...");try{const v=await Ue.getProfile(),x=i(v);r(x),console.log(" User profile validated and set successfully")}catch(v){console.warn(" Profile fetch failed, using fallback user data from session:",v);const x={id:w.user.id,email:w.user.email||"",username:w.user.user_metadata?.username||"",firstName:w.user.user_metadata?.name?.split(" ")[0]||w.user.email?.split("@")[0]||"Traveler",lastName:w.user.user_metadata?.name?.split(" ")[1]||"",avatar:w.user.user_metadata?.avatar_url,bio:"",location:"",isVerified:w.user.email_confirmed_at!==null,isOnline:!0,lastSeen:new Date().toISOString(),createdAt:w.user.created_at,updatedAt:w.user.updated_at||w.user.created_at,preferences:{language:"en",currency:"USD",timezone:"UTC",notifications:{email:!0,push:!0,sms:!1,tripUpdates:!0,friendRequests:!0,messages:!0,promotions:!1},privacy:{profileVisibility:"public",showEmail:!1,showPhone:!1,showLocation:!0,allowFriendRequests:!0,allowMessages:!0},travelPreferences:{budgetRange:{min:0,max:5e3},preferredDestinations:[],travelStyle:"mid-range",accommodationType:[],transportModes:[],interests:[]}},stats:{tripsCompleted:0,countriesVisited:0,citiesVisited:0,totalDistance:0,totalSpent:0,friendsCount:0,followersCount:0,followingCount:0,reviewsCount:0,averageRating:0}};r(x),console.log(" Fallback user set - user remains logged in despite profile fetch failure")}}else console.log(" No valid session found"),Ue.clearAuthData(),r(null)}catch(y){if(console.error(" Auth initialization failed:",y),y.message.includes("timeout")||y.message.includes("network")||y.message.includes("fetch"))console.log(" Network/timeout error detected, continuing without authentication"),console.log(" User can try logging in manually or use development bypass");else try{await Ue.logout()}catch(w){console.error(" Cleanup logout failed:",w)}Ue.clearAuthData(),r(null)}finally{console.log(" Auth initialization complete, setting loading to false"),setTimeout(()=>{n(!1)},100)}},b=setTimeout(()=>{console.log(" Auth initialization safety timeout - forcing loading to false"),n(!1)},1e4);f().finally(()=>{clearTimeout(b)});const{data:{subscription:g}}=le.auth.onAuthStateChange(async(y,w)=>{if(console.log(" Auth event:",y,w?"Session exists":"No session"),!["SIGNED_IN","SIGNED_OUT"].includes(y)){console.log(` Ignoring non-critical auth event: ${y} (no action taken)`);return}if(y==="SIGNED_IN"&&w?.user)try{if(console.log(" User signed in event detected"),e&&e.id===w.user.id){console.log(" User already in state, skipping profile fetch");return}e||(console.log(" First time login, fetching profile..."),n(!0));try{const x=Ue.getProfile(),j=new Promise((S,_)=>{setTimeout(()=>_(new Error("Profile fetch timeout")),5e3)}),N=await Promise.race([x,j]);r(i(N)),console.log(" User profile loaded from API")}catch(x){if(console.warn(" Profile fetch failed/timeout, using session fallback:",x.message),w?.user){const j={id:w.user.id,email:w.user.email||"",username:w.user.user_metadata?.username||w.user.email?.split("@")[0]||"",firstName:w.user.user_metadata?.first_name||w.user.user_metadata?.name?.split(" ")[0]||"Traveler",lastName:w.user.user_metadata?.last_name||w.user.user_metadata?.name?.split(" ")[1]||"",avatar:w.user.user_metadata?.avatar_url,bio:"",location:"",isVerified:w.user.email_confirmed_at!==null,isOnline:!0,lastSeen:new Date().toISOString(),createdAt:w.user.created_at,updatedAt:w.user.updated_at||w.user.created_at,preferences:{},stats:{}};r(j),console.log(" Using session fallback user")}}n(!1)}catch(x){if(console.error(" Error getting user profile:",x),n(!1),w?.user){const j={id:w.user.id,email:w.user.email||"",username:w.user.user_metadata?.username||"",firstName:w.user.user_metadata?.name?.split(" ")[0]||w.user.email?.split("@")[0]||"",lastName:w.user.user_metadata?.name?.split(" ")[1]||"",avatar:w.user.user_metadata?.avatar_url,bio:"",location:"",isVerified:w.user.email_confirmed_at!==null,isOnline:!0,lastSeen:new Date().toISOString(),createdAt:w.user.created_at,updatedAt:w.user.updated_at||w.user.created_at,preferences:{language:"en",currency:"USD",timezone:"UTC",notifications:{email:!0,push:!0,sms:!1,tripUpdates:!0,friendRequests:!0,messages:!0,promotions:!1},privacy:{profileVisibility:"public",showEmail:!1,showPhone:!1,showLocation:!0,allowFriendRequests:!0,allowMessages:!0},travelPreferences:{budgetRange:{min:0,max:5e3},preferredDestinations:[],travelStyle:"mid-range",accommodationType:[],transportModes:[],interests:[]}},stats:{tripsCompleted:0,countriesVisited:0,citiesVisited:0,totalDistance:0,totalSpent:0,friendsCount:0,followersCount:0,followingCount:0,reviewsCount:0,averageRating:0}};r(j),n(!1)}else n(!1)}else if(y==="SIGNED_OUT")console.log(" User signed out"),r(null),n(!1),Ue.clearAuthData();else if(y==="TOKEN_REFRESHED"&&w?.user)console.log(" Token refreshed silently - no profile refetch needed");else if(y==="USER_UPDATED"&&w?.user){console.log(" User updated, refreshing profile");try{const x=await Ue.getProfile();r(i(x))}catch(x){console.error("Error updating user:",x)}}});return()=>{g.unsubscribe()}},[]),u.useEffect(()=>{if(!e)return;const f=setInterval(async()=>{try{const{data:{session:g},error:y}=await le.auth.getSession();if(y){console.error(" Error getting session:",y);return}if(g){const v=(g.expires_at?g.expires_at*1e3:Date.now()+36e5)-Date.now(),x=600*1e3;if(v<x){console.log(" Token expiring soon, refreshing...");try{await Ue.refreshToken(),console.log(" Token refreshed successfully")}catch(j){console.error(" Token refresh failed:",j);const{data:{session:N}}=await le.auth.getSession();N||console.log(" No valid session, user may need to re-login")}}}else console.log(" No active session found")}catch(g){console.error(" Error checking session:",g)}},300*1e3),{data:{subscription:b}}=le.auth.onAuthStateChange(async(g,y)=>{if(g==="TOKEN_REFRESHED"&&y?.user){console.log(" Token automatically refreshed by Supabase");try{const w=await Ue.getProfile();r(i(w))}catch(w){console.error("Error updating user after token refresh:",w)}}else g==="SIGNED_OUT"&&(console.log(" User signed out"),r(null))});return()=>{clearInterval(f),b.unsubscribe()}},[e]);const l=async(f,b)=>{try{n(!0),console.log(" Starting login process...");const g=await Ue.login({email:f,password:b});console.log(" Login successful, converting user...");const y=i(g.user);return r(y),n(!1),console.log(" User set, loading complete, isAuthenticated should be true"),ee({title:"Welcome back!",description:`Hello ${g.user.name||f}, you're successfully logged in.`}),y}catch(g){console.error(" Login failed:",g),n(!1);const y=g instanceof Error?g.message:"Login failed";throw ee({title:"Login Failed",description:y,variant:"destructive"}),g}},c=async f=>{try{n(!0);const b={email:f.email,password:f.password,name:`${f.firstName} ${f.lastName}`.trim(),username:f.username||"",confirmPassword:f.password},g=await Ue.register(b);r(i(g.user)),ee({title:"Account Created!",description:`Welcome to WanderSphere, ${g.user.name}!`})}catch(b){const g=b instanceof Error?b.message:"Registration failed";throw ee({title:"Registration Failed",description:g,variant:"destructive"}),b}finally{n(!1)}},d=async()=>{try{console.log(" Starting logout process..."),n(!0),r(null),await Ue.logout(),console.log(" Logout completed successfully"),ee({title:"Logged Out",description:"You have been successfully logged out."}),setTimeout(()=>{window.location.href="/login"},500)}catch(f){console.error(" Logout error:",f),Ue.clearAuthData(),r(null),setTimeout(()=>{window.location.href="/login"},500)}finally{n(!1)}},p={user:e,isAuthenticated:o,isLoading:a,login:l,register:c,logout:d,refreshToken:async()=>{try{await Ue.refreshToken()}catch(f){throw console.error("Token refresh failed:",f),await d(),f}},updateProfile:async f=>{const b={name:f.firstName&&f.lastName?`${f.firstName} ${f.lastName}`.trim():void 0,email:f.email,username:f.username,avatar:f.avatar,bio:f.bio,location:f.location};Object.keys(b).forEach(g=>b[g]===void 0&&delete b[g]);try{const g=await Ue.updateProfile(b);r(i(g)),ee({title:"Profile Updated",description:"Your profile has been successfully updated."})}catch(g){const y=g instanceof Error?g.message:"Profile update failed";throw ee({title:"Update Failed",description:y,variant:"destructive"}),g}}};return s.jsx(Mu.Provider,{value:p,children:t})}const Lu=u.createContext(void 0),so=300*1e3;function g0({children:t}){const[e,r]=u.useState([]),[a,n]=u.useState(null),[o,i]=u.useState([]),[l,c]=u.useState(null),[d,h]=u.useState([]),[m,p]=u.useState(null),f=u.useCallback(j=>{r(j),n(Date.now())},[]),b=u.useCallback(()=>a?Date.now()-a>so:!0,[a]),g=u.useCallback(j=>{i(j),c(Date.now())},[]),y=u.useCallback(()=>l?Date.now()-l>so:!0,[l]),w=u.useCallback(j=>{h(j),p(Date.now())},[]),v=u.useCallback(()=>m?Date.now()-m>so:!0,[m]),x=u.useCallback(()=>{r([]),n(null),i([]),c(null),h([]),p(null)},[]);return s.jsx(Lu.Provider,{value:{stories:e,storiesLastFetched:a,setStories:f,shouldRefetchStories:b,posts:o,postsLastFetched:l,setPosts:g,shouldRefetchPosts:y,journeys:d,journeysLastFetched:m,setJourneys:w,shouldRefetchJourneys:v,clearAll:x},children:t})}function x0(){const t=u.useContext(Lu);if(t===void 0)throw new Error("useDataCache must be used within a DataCacheProvider");return t}var ro={exports:{}},ao={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mc;function v0(){if(mc)return ao;mc=1;var t=Op();function e(m,p){return m===p&&(m!==0||1/m===1/p)||m!==m&&p!==p}var r=typeof Object.is=="function"?Object.is:e,a=t.useState,n=t.useEffect,o=t.useLayoutEffect,i=t.useDebugValue;function l(m,p){var f=p(),b=a({inst:{value:f,getSnapshot:p}}),g=b[0].inst,y=b[1];return o(function(){g.value=f,g.getSnapshot=p,c(g)&&y({inst:g})},[m,f,p]),n(function(){return c(g)&&y({inst:g}),m(function(){c(g)&&y({inst:g})})},[m]),i(f),f}function c(m){var p=m.getSnapshot;m=m.value;try{var f=p();return!r(m,f)}catch{return!0}}function d(m,p){return p()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:l;return ao.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:h,ao}var fc;function y0(){return fc||(fc=1,ro.exports=v0()),ro.exports}var w0=y0();function b0(){return w0.useSyncExternalStore(j0,()=>!0,()=>!1)}function j0(){return()=>{}}var Ai="Avatar",[N0,VC]=Xe(Ai),[S0,$u]=N0(Ai),Fu=u.forwardRef((t,e)=>{const{__scopeAvatar:r,...a}=t,[n,o]=u.useState("idle");return s.jsx(S0,{scope:r,imageLoadingStatus:n,onImageLoadingStatusChange:o,children:s.jsx(ne.span,{...a,ref:e})})});Fu.displayName=Ai;var Uu="AvatarImage",Bu=u.forwardRef((t,e)=>{const{__scopeAvatar:r,src:a,onLoadingStatusChange:n=()=>{},...o}=t,i=$u(Uu,r),l=_0(a,o),c=Ke(d=>{n(d),i.onImageLoadingStatusChange(d)});return De(()=>{l!=="idle"&&c(l)},[l,c]),l==="loaded"?s.jsx(ne.img,{...o,ref:e,src:a}):null});Bu.displayName=Uu;var zu="AvatarFallback",qu=u.forwardRef((t,e)=>{const{__scopeAvatar:r,delayMs:a,...n}=t,o=$u(zu,r),[i,l]=u.useState(a===void 0);return u.useEffect(()=>{if(a!==void 0){const c=window.setTimeout(()=>l(!0),a);return()=>window.clearTimeout(c)}},[a]),i&&o.imageLoadingStatus!=="loaded"?s.jsx(ne.span,{...n,ref:e}):null});qu.displayName=zu;function pc(t,e){return t?e?(t.src!==e&&(t.src=e),t.complete&&t.naturalWidth>0?"loaded":"loading"):"error":"idle"}function _0(t,{referrerPolicy:e,crossOrigin:r}){const a=b0(),n=u.useRef(null),o=a?(n.current||(n.current=new window.Image),n.current):null,[i,l]=u.useState(()=>pc(o,t));return De(()=>{l(pc(o,t))},[o,t]),De(()=>{const c=m=>()=>{l(m)};if(!o)return;const d=c("loaded"),h=c("error");return o.addEventListener("load",d),o.addEventListener("error",h),e&&(o.referrerPolicy=e),typeof r=="string"&&(o.crossOrigin=r),()=>{o.removeEventListener("load",d),o.removeEventListener("error",h)}},[o,r,e]),i}var Wu=Fu,Hu=Bu,Vu=qu;const Pe=u.forwardRef(({className:t,...e},r)=>s.jsx(Wu,{ref:r,className:Z("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...e}));Pe.displayName=Wu.displayName;const Ae=u.forwardRef(({className:t,...e},r)=>s.jsx(Hu,{ref:r,className:Z("aspect-square h-full w-full",t),...e}));Ae.displayName=Hu.displayName;const Re=u.forwardRef(({className:t,...e},r)=>s.jsx(Vu,{ref:r,className:Z("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...e}));Re.displayName=Vu.displayName;var C0=u.createContext(void 0);function wn(t){const e=u.useContext(C0);return t||e||"ltr"}var no=0;function Ri(){u.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??gc()),document.body.insertAdjacentElement("beforeend",t[1]??gc()),no++,()=>{no===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),no--}},[])}function gc(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var oo="focusScope.autoFocusOnMount",io="focusScope.autoFocusOnUnmount",xc={bubbles:!1,cancelable:!0},E0="FocusScope",bn=u.forwardRef((t,e)=>{const{loop:r=!1,trapped:a=!1,onMountAutoFocus:n,onUnmountAutoFocus:o,...i}=t,[l,c]=u.useState(null),d=Ke(n),h=Ke(o),m=u.useRef(null),p=xe(e,g=>c(g)),f=u.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;u.useEffect(()=>{if(a){let g=function(x){if(f.paused||!l)return;const j=x.target;l.contains(j)?m.current=j:is(m.current,{select:!0})},y=function(x){if(f.paused||!l)return;const j=x.relatedTarget;j!==null&&(l.contains(j)||is(m.current,{select:!0}))},w=function(x){if(document.activeElement===document.body)for(const N of x)N.removedNodes.length>0&&is(l)};document.addEventListener("focusin",g),document.addEventListener("focusout",y);const v=new MutationObserver(w);return l&&v.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",y),v.disconnect()}}},[a,l,f.paused]),u.useEffect(()=>{if(l){yc.add(f);const g=document.activeElement;if(!l.contains(g)){const w=new CustomEvent(oo,xc);l.addEventListener(oo,d),l.dispatchEvent(w),w.defaultPrevented||(k0(I0(Gu(l)),{select:!0}),document.activeElement===g&&is(l))}return()=>{l.removeEventListener(oo,d),setTimeout(()=>{const w=new CustomEvent(io,xc);l.addEventListener(io,h),l.dispatchEvent(w),w.defaultPrevented||is(g??document.body,{select:!0}),l.removeEventListener(io,h),yc.remove(f)},0)}}},[l,d,h,f]);const b=u.useCallback(g=>{if(!r&&!a||f.paused)return;const y=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,w=document.activeElement;if(y&&w){const v=g.currentTarget,[x,j]=T0(v);x&&j?!g.shiftKey&&w===j?(g.preventDefault(),r&&is(x,{select:!0})):g.shiftKey&&w===x&&(g.preventDefault(),r&&is(j,{select:!0})):w===v&&g.preventDefault()}},[r,a,f.paused]);return s.jsx(ne.div,{tabIndex:-1,...i,ref:p,onKeyDown:b})});bn.displayName=E0;function k0(t,{select:e=!1}={}){const r=document.activeElement;for(const a of t)if(is(a,{select:e}),document.activeElement!==r)return}function T0(t){const e=Gu(t),r=vc(e,t),a=vc(e.reverse(),t);return[r,a]}function Gu(t){const e=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:a=>{const n=a.tagName==="INPUT"&&a.type==="hidden";return a.disabled||a.hidden||n?NodeFilter.FILTER_SKIP:a.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)e.push(r.currentNode);return e}function vc(t,e){for(const r of t)if(!P0(r,{upTo:e}))return r}function P0(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function A0(t){return t instanceof HTMLInputElement&&"select"in t}function is(t,{select:e=!1}={}){if(t&&t.focus){const r=document.activeElement;t.focus({preventScroll:!0}),t!==r&&A0(t)&&e&&t.select()}}var yc=R0();function R0(){let t=[];return{add(e){const r=t[0];e!==r&&r?.pause(),t=wc(t,e),t.unshift(e)},remove(e){t=wc(t,e),t[0]?.resume()}}}function wc(t,e){const r=[...t],a=r.indexOf(e);return a!==-1&&r.splice(a,1),r}function I0(t){return t.filter(e=>e.tagName!=="A")}var lo="rovingFocusGroup.onEntryFocus",D0={bubbles:!1,cancelable:!0},oa="RovingFocusGroup",[qo,Ku,O0]=cn(oa),[M0,jn]=Xe(oa,[O0]),[L0,$0]=M0(oa),Ju=u.forwardRef((t,e)=>s.jsx(qo.Provider,{scope:t.__scopeRovingFocusGroup,children:s.jsx(qo.Slot,{scope:t.__scopeRovingFocusGroup,children:s.jsx(F0,{...t,ref:e})})}));Ju.displayName=oa;var F0=u.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:r,orientation:a,loop:n=!1,dir:o,currentTabStopId:i,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:d,preventScrollOnEntryFocus:h=!1,...m}=t,p=u.useRef(null),f=xe(e,p),b=wn(o),[g,y]=Vt({prop:i,defaultProp:l??null,onChange:c,caller:oa}),[w,v]=u.useState(!1),x=Ke(d),j=Ku(r),N=u.useRef(!1),[S,_]=u.useState(0);return u.useEffect(()=>{const E=p.current;if(E)return E.addEventListener(lo,x),()=>E.removeEventListener(lo,x)},[x]),s.jsx(L0,{scope:r,orientation:a,dir:b,loop:n,currentTabStopId:g,onItemFocus:u.useCallback(E=>y(E),[y]),onItemShiftTab:u.useCallback(()=>v(!0),[]),onFocusableItemAdd:u.useCallback(()=>_(E=>E+1),[]),onFocusableItemRemove:u.useCallback(()=>_(E=>E-1),[]),children:s.jsx(ne.div,{tabIndex:w||S===0?-1:0,"data-orientation":a,...m,ref:f,style:{outline:"none",...t.style},onMouseDown:W(t.onMouseDown,()=>{N.current=!0}),onFocus:W(t.onFocus,E=>{const k=!N.current;if(E.target===E.currentTarget&&k&&!w){const A=new CustomEvent(lo,D0);if(E.currentTarget.dispatchEvent(A),!A.defaultPrevented){const B=j().filter(z=>z.focusable),$=B.find(z=>z.active),H=B.find(z=>z.id===g),Y=[$,H,...B].filter(Boolean).map(z=>z.ref.current);Xu(Y,h)}}N.current=!1}),onBlur:W(t.onBlur,()=>v(!1))})})}),Yu="RovingFocusGroupItem",Qu=u.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:r,focusable:a=!0,active:n=!1,tabStopId:o,children:i,...l}=t,c=Dt(),d=o||c,h=$0(Yu,r),m=h.currentTabStopId===d,p=Ku(r),{onFocusableItemAdd:f,onFocusableItemRemove:b,currentTabStopId:g}=h;return u.useEffect(()=>{if(a)return f(),()=>b()},[a,f,b]),s.jsx(qo.ItemSlot,{scope:r,id:d,focusable:a,active:n,children:s.jsx(ne.span,{tabIndex:m?0:-1,"data-orientation":h.orientation,...l,ref:e,onMouseDown:W(t.onMouseDown,y=>{a?h.onItemFocus(d):y.preventDefault()}),onFocus:W(t.onFocus,()=>h.onItemFocus(d)),onKeyDown:W(t.onKeyDown,y=>{if(y.key==="Tab"&&y.shiftKey){h.onItemShiftTab();return}if(y.target!==y.currentTarget)return;const w=z0(y,h.orientation,h.dir);if(w!==void 0){if(y.metaKey||y.ctrlKey||y.altKey||y.shiftKey)return;y.preventDefault();let x=p().filter(j=>j.focusable).map(j=>j.ref.current);if(w==="last")x.reverse();else if(w==="prev"||w==="next"){w==="prev"&&x.reverse();const j=x.indexOf(y.currentTarget);x=h.loop?q0(x,j+1):x.slice(j+1)}setTimeout(()=>Xu(x))}}),children:typeof i=="function"?i({isCurrentTabStop:m,hasTabStop:g!=null}):i})})});Qu.displayName=Yu;var U0={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function B0(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function z0(t,e,r){const a=B0(t.key,r);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(a))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(a)))return U0[a]}function Xu(t,e=!1){const r=document.activeElement;for(const a of t)if(a===r||(a.focus({preventScroll:e}),document.activeElement!==r))return}function q0(t,e){return t.map((r,a)=>t[(e+a)%t.length])}var Zu=Ju,eh=Qu,W0=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},sr=new WeakMap,Na=new WeakMap,Sa={},co=0,th=function(t){return t&&(t.host||th(t.parentNode))},H0=function(t,e){return e.map(function(r){if(t.contains(r))return r;var a=th(r);return a&&t.contains(a)?a:(console.error("aria-hidden",r,"in not contained inside",t,". Doing nothing"),null)}).filter(function(r){return!!r})},V0=function(t,e,r,a){var n=H0(e,Array.isArray(t)?t:[t]);Sa[r]||(Sa[r]=new WeakMap);var o=Sa[r],i=[],l=new Set,c=new Set(n),d=function(m){!m||l.has(m)||(l.add(m),d(m.parentNode))};n.forEach(d);var h=function(m){!m||c.has(m)||Array.prototype.forEach.call(m.children,function(p){if(l.has(p))h(p);else try{var f=p.getAttribute(a),b=f!==null&&f!=="false",g=(sr.get(p)||0)+1,y=(o.get(p)||0)+1;sr.set(p,g),o.set(p,y),i.push(p),g===1&&b&&Na.set(p,!0),y===1&&p.setAttribute(r,"true"),b||p.setAttribute(a,"true")}catch(w){console.error("aria-hidden: cannot operate on ",p,w)}})};return h(e),l.clear(),co++,function(){i.forEach(function(m){var p=sr.get(m)-1,f=o.get(m)-1;sr.set(m,p),o.set(m,f),p||(Na.has(m)||m.removeAttribute(a),Na.delete(m)),f||m.removeAttribute(r)}),co--,co||(sr=new WeakMap,sr=new WeakMap,Na=new WeakMap,Sa={})}},Ii=function(t,e,r){r===void 0&&(r="data-aria-hidden");var a=Array.from(Array.isArray(t)?t:[t]),n=W0(t);return n?(a.push.apply(a,Array.from(n.querySelectorAll("[aria-live]"))),V0(a,n,r,"aria-hidden")):function(){return null}},At=function(){return At=Object.assign||function(e){for(var r,a=1,n=arguments.length;a<n;a++){r=arguments[a];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},At.apply(this,arguments)};function sh(t,e){var r={};for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&e.indexOf(a)<0&&(r[a]=t[a]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(t);n<a.length;n++)e.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(t,a[n])&&(r[a[n]]=t[a[n]]);return r}function G0(t,e,r){if(r||arguments.length===2)for(var a=0,n=e.length,o;a<n;a++)(o||!(a in e))&&(o||(o=Array.prototype.slice.call(e,0,a)),o[a]=e[a]);return t.concat(o||Array.prototype.slice.call(e))}var Fa="right-scroll-bar-position",Ua="width-before-scroll-bar",K0="with-scroll-bars-hidden",J0="--removed-body-scroll-bar-size";function uo(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function Y0(t,e){var r=u.useState(function(){return{value:t,callback:e,facade:{get current(){return r.value},set current(a){var n=r.value;n!==a&&(r.value=a,r.callback(a,n))}}}})[0];return r.callback=e,r.facade}var Q0=typeof window<"u"?u.useLayoutEffect:u.useEffect,bc=new WeakMap;function X0(t,e){var r=Y0(null,function(a){return t.forEach(function(n){return uo(n,a)})});return Q0(function(){var a=bc.get(r);if(a){var n=new Set(a),o=new Set(t),i=r.current;n.forEach(function(l){o.has(l)||uo(l,null)}),o.forEach(function(l){n.has(l)||uo(l,i)})}bc.set(r,t)},[t]),r}function Z0(t){return t}function ej(t,e){e===void 0&&(e=Z0);var r=[],a=!1,n={read:function(){if(a)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:t},useMedium:function(o){var i=e(o,a);return r.push(i),function(){r=r.filter(function(l){return l!==i})}},assignSyncMedium:function(o){for(a=!0;r.length;){var i=r;r=[],i.forEach(o)}r={push:function(l){return o(l)},filter:function(){return r}}},assignMedium:function(o){a=!0;var i=[];if(r.length){var l=r;r=[],l.forEach(o),i=r}var c=function(){var h=i;i=[],h.forEach(o)},d=function(){return Promise.resolve().then(c)};d(),r={push:function(h){i.push(h),d()},filter:function(h){return i=i.filter(h),r}}}};return n}function tj(t){t===void 0&&(t={});var e=ej(null);return e.options=At({async:!0,ssr:!1},t),e}var rh=function(t){var e=t.sideCar,r=sh(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var a=e.read();if(!a)throw new Error("Sidecar medium not found");return u.createElement(a,At({},r))};rh.isSideCarExport=!0;function sj(t,e){return t.useMedium(e),rh}var ah=tj(),ho=function(){},Nn=u.forwardRef(function(t,e){var r=u.useRef(null),a=u.useState({onScrollCapture:ho,onWheelCapture:ho,onTouchMoveCapture:ho}),n=a[0],o=a[1],i=t.forwardProps,l=t.children,c=t.className,d=t.removeScrollBar,h=t.enabled,m=t.shards,p=t.sideCar,f=t.noRelative,b=t.noIsolation,g=t.inert,y=t.allowPinchZoom,w=t.as,v=w===void 0?"div":w,x=t.gapMode,j=sh(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),N=p,S=X0([r,e]),_=At(At({},j),n);return u.createElement(u.Fragment,null,h&&u.createElement(N,{sideCar:ah,removeScrollBar:d,shards:m,noRelative:f,noIsolation:b,inert:g,setCallbacks:o,allowPinchZoom:!!y,lockRef:r,gapMode:x}),i?u.cloneElement(u.Children.only(l),At(At({},_),{ref:S})):u.createElement(v,At({},_,{className:c,ref:S}),l))});Nn.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Nn.classNames={fullWidth:Ua,zeroRight:Fa};var rj=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function aj(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=rj();return e&&t.setAttribute("nonce",e),t}function nj(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function oj(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var ij=function(){var t=0,e=null;return{add:function(r){t==0&&(e=aj())&&(nj(e,r),oj(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},lj=function(){var t=ij();return function(e,r){u.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&r])}},nh=function(){var t=lj(),e=function(r){var a=r.styles,n=r.dynamic;return t(a,n),null};return e},cj={left:0,top:0,right:0,gap:0},mo=function(t){return parseInt(t||"",10)||0},dj=function(t){var e=window.getComputedStyle(document.body),r=e[t==="padding"?"paddingLeft":"marginLeft"],a=e[t==="padding"?"paddingTop":"marginTop"],n=e[t==="padding"?"paddingRight":"marginRight"];return[mo(r),mo(a),mo(n)]},uj=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return cj;var e=dj(t),r=document.documentElement.clientWidth,a=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,a-r+e[2]-e[0])}},hj=nh(),dr="data-scroll-locked",mj=function(t,e,r,a){var n=t.left,o=t.top,i=t.right,l=t.gap;return r===void 0&&(r="margin"),`
  .`.concat(K0,` {
   overflow: hidden `).concat(a,`;
   padding-right: `).concat(l,"px ").concat(a,`;
  }
  body[`).concat(dr,`] {
    overflow: hidden `).concat(a,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(a,";"),r==="margin"&&`
    padding-left: `.concat(n,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(a,`;
    `),r==="padding"&&"padding-right: ".concat(l,"px ").concat(a,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Fa,` {
    right: `).concat(l,"px ").concat(a,`;
  }
  
  .`).concat(Ua,` {
    margin-right: `).concat(l,"px ").concat(a,`;
  }
  
  .`).concat(Fa," .").concat(Fa,` {
    right: 0 `).concat(a,`;
  }
  
  .`).concat(Ua," .").concat(Ua,` {
    margin-right: 0 `).concat(a,`;
  }
  
  body[`).concat(dr,`] {
    `).concat(J0,": ").concat(l,`px;
  }
`)},jc=function(){var t=parseInt(document.body.getAttribute(dr)||"0",10);return isFinite(t)?t:0},fj=function(){u.useEffect(function(){return document.body.setAttribute(dr,(jc()+1).toString()),function(){var t=jc()-1;t<=0?document.body.removeAttribute(dr):document.body.setAttribute(dr,t.toString())}},[])},pj=function(t){var e=t.noRelative,r=t.noImportant,a=t.gapMode,n=a===void 0?"margin":a;fj();var o=u.useMemo(function(){return uj(n)},[n]);return u.createElement(hj,{styles:mj(o,!e,n,r?"":"!important")})},Wo=!1;if(typeof window<"u")try{var _a=Object.defineProperty({},"passive",{get:function(){return Wo=!0,!0}});window.addEventListener("test",_a,_a),window.removeEventListener("test",_a,_a)}catch{Wo=!1}var rr=Wo?{passive:!1}:!1,gj=function(t){return t.tagName==="TEXTAREA"},oh=function(t,e){if(!(t instanceof Element))return!1;var r=window.getComputedStyle(t);return r[e]!=="hidden"&&!(r.overflowY===r.overflowX&&!gj(t)&&r[e]==="visible")},xj=function(t){return oh(t,"overflowY")},vj=function(t){return oh(t,"overflowX")},Nc=function(t,e){var r=e.ownerDocument,a=e;do{typeof ShadowRoot<"u"&&a instanceof ShadowRoot&&(a=a.host);var n=ih(t,a);if(n){var o=lh(t,a),i=o[1],l=o[2];if(i>l)return!0}a=a.parentNode}while(a&&a!==r.body);return!1},yj=function(t){var e=t.scrollTop,r=t.scrollHeight,a=t.clientHeight;return[e,r,a]},wj=function(t){var e=t.scrollLeft,r=t.scrollWidth,a=t.clientWidth;return[e,r,a]},ih=function(t,e){return t==="v"?xj(e):vj(e)},lh=function(t,e){return t==="v"?yj(e):wj(e)},bj=function(t,e){return t==="h"&&e==="rtl"?-1:1},jj=function(t,e,r,a,n){var o=bj(t,window.getComputedStyle(e).direction),i=o*a,l=r.target,c=e.contains(l),d=!1,h=i>0,m=0,p=0;do{if(!l)break;var f=lh(t,l),b=f[0],g=f[1],y=f[2],w=g-y-o*b;(b||w)&&ih(t,l)&&(m+=w,p+=b);var v=l.parentNode;l=v&&v.nodeType===Node.DOCUMENT_FRAGMENT_NODE?v.host:v}while(!c&&l!==document.body||c&&(e.contains(l)||e===l));return(h&&Math.abs(m)<1||!h&&Math.abs(p)<1)&&(d=!0),d},Ca=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},Sc=function(t){return[t.deltaX,t.deltaY]},_c=function(t){return t&&"current"in t?t.current:t},Nj=function(t,e){return t[0]===e[0]&&t[1]===e[1]},Sj=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},_j=0,ar=[];function Cj(t){var e=u.useRef([]),r=u.useRef([0,0]),a=u.useRef(),n=u.useState(_j++)[0],o=u.useState(nh)[0],i=u.useRef(t);u.useEffect(function(){i.current=t},[t]),u.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(n));var g=G0([t.lockRef.current],(t.shards||[]).map(_c),!0).filter(Boolean);return g.forEach(function(y){return y.classList.add("allow-interactivity-".concat(n))}),function(){document.body.classList.remove("block-interactivity-".concat(n)),g.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(n))})}}},[t.inert,t.lockRef.current,t.shards]);var l=u.useCallback(function(g,y){if("touches"in g&&g.touches.length===2||g.type==="wheel"&&g.ctrlKey)return!i.current.allowPinchZoom;var w=Ca(g),v=r.current,x="deltaX"in g?g.deltaX:v[0]-w[0],j="deltaY"in g?g.deltaY:v[1]-w[1],N,S=g.target,_=Math.abs(x)>Math.abs(j)?"h":"v";if("touches"in g&&_==="h"&&S.type==="range")return!1;var E=Nc(_,S);if(!E)return!0;if(E?N=_:(N=_==="v"?"h":"v",E=Nc(_,S)),!E)return!1;if(!a.current&&"changedTouches"in g&&(x||j)&&(a.current=N),!N)return!0;var k=a.current||N;return jj(k,y,g,k==="h"?x:j)},[]),c=u.useCallback(function(g){var y=g;if(!(!ar.length||ar[ar.length-1]!==o)){var w="deltaY"in y?Sc(y):Ca(y),v=e.current.filter(function(N){return N.name===y.type&&(N.target===y.target||y.target===N.shadowParent)&&Nj(N.delta,w)})[0];if(v&&v.should){y.cancelable&&y.preventDefault();return}if(!v){var x=(i.current.shards||[]).map(_c).filter(Boolean).filter(function(N){return N.contains(y.target)}),j=x.length>0?l(y,x[0]):!i.current.noIsolation;j&&y.cancelable&&y.preventDefault()}}},[]),d=u.useCallback(function(g,y,w,v){var x={name:g,delta:y,target:w,should:v,shadowParent:Ej(w)};e.current.push(x),setTimeout(function(){e.current=e.current.filter(function(j){return j!==x})},1)},[]),h=u.useCallback(function(g){r.current=Ca(g),a.current=void 0},[]),m=u.useCallback(function(g){d(g.type,Sc(g),g.target,l(g,t.lockRef.current))},[]),p=u.useCallback(function(g){d(g.type,Ca(g),g.target,l(g,t.lockRef.current))},[]);u.useEffect(function(){return ar.push(o),t.setCallbacks({onScrollCapture:m,onWheelCapture:m,onTouchMoveCapture:p}),document.addEventListener("wheel",c,rr),document.addEventListener("touchmove",c,rr),document.addEventListener("touchstart",h,rr),function(){ar=ar.filter(function(g){return g!==o}),document.removeEventListener("wheel",c,rr),document.removeEventListener("touchmove",c,rr),document.removeEventListener("touchstart",h,rr)}},[]);var f=t.removeScrollBar,b=t.inert;return u.createElement(u.Fragment,null,b?u.createElement(o,{styles:Sj(n)}):null,f?u.createElement(pj,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function Ej(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const kj=sj(ah,Cj);var Sn=u.forwardRef(function(t,e){return u.createElement(Nn,At({},t,{ref:e,sideCar:kj}))});Sn.classNames=Nn.classNames;var Ho=["Enter"," "],Tj=["ArrowDown","PageUp","Home"],ch=["ArrowUp","PageDown","End"],Pj=[...Tj,...ch],Aj={ltr:[...Ho,"ArrowRight"],rtl:[...Ho,"ArrowLeft"]},Rj={ltr:["ArrowLeft"],rtl:["ArrowRight"]},ia="Menu",[Hr,Ij,Dj]=cn(ia),[Fs,dh]=Xe(ia,[Dj,br,jn]),_n=br(),uh=jn(),[Oj,Us]=Fs(ia),[Mj,la]=Fs(ia),hh=t=>{const{__scopeMenu:e,open:r=!1,children:a,dir:n,onOpenChange:o,modal:i=!0}=t,l=_n(e),[c,d]=u.useState(null),h=u.useRef(!1),m=Ke(o),p=wn(n);return u.useEffect(()=>{const f=()=>{h.current=!0,document.addEventListener("pointerdown",b,{capture:!0,once:!0}),document.addEventListener("pointermove",b,{capture:!0,once:!0})},b=()=>h.current=!1;return document.addEventListener("keydown",f,{capture:!0}),()=>{document.removeEventListener("keydown",f,{capture:!0}),document.removeEventListener("pointerdown",b,{capture:!0}),document.removeEventListener("pointermove",b,{capture:!0})}},[]),s.jsx(su,{...l,children:s.jsx(Oj,{scope:e,open:r,onOpenChange:m,content:c,onContentChange:d,children:s.jsx(Mj,{scope:e,onClose:u.useCallback(()=>m(!1),[m]),isUsingKeyboardRef:h,dir:p,modal:i,children:a})})})};hh.displayName=ia;var Lj="MenuAnchor",Di=u.forwardRef((t,e)=>{const{__scopeMenu:r,...a}=t,n=_n(r);return s.jsx(wi,{...n,...a,ref:e})});Di.displayName=Lj;var Oi="MenuPortal",[$j,mh]=Fs(Oi,{forceMount:void 0}),fh=t=>{const{__scopeMenu:e,forceMount:r,children:a,container:n}=t,o=Us(Oi,e);return s.jsx($j,{scope:e,forceMount:r,children:s.jsx(ht,{present:r||o.open,children:s.jsx(ta,{asChild:!0,container:n,children:a})})})};fh.displayName=Oi;var dt="MenuContent",[Fj,Mi]=Fs(dt),ph=u.forwardRef((t,e)=>{const r=mh(dt,t.__scopeMenu),{forceMount:a=r.forceMount,...n}=t,o=Us(dt,t.__scopeMenu),i=la(dt,t.__scopeMenu);return s.jsx(Hr.Provider,{scope:t.__scopeMenu,children:s.jsx(ht,{present:a||o.open,children:s.jsx(Hr.Slot,{scope:t.__scopeMenu,children:i.modal?s.jsx(Uj,{...n,ref:e}):s.jsx(Bj,{...n,ref:e})})})})}),Uj=u.forwardRef((t,e)=>{const r=Us(dt,t.__scopeMenu),a=u.useRef(null),n=xe(e,a);return u.useEffect(()=>{const o=a.current;if(o)return Ii(o)},[]),s.jsx(Li,{...t,ref:n,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:W(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),Bj=u.forwardRef((t,e)=>{const r=Us(dt,t.__scopeMenu);return s.jsx(Li,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),zj=Rs("MenuContent.ScrollLock"),Li=u.forwardRef((t,e)=>{const{__scopeMenu:r,loop:a=!1,trapFocus:n,onOpenAutoFocus:o,onCloseAutoFocus:i,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:d,onPointerDownOutside:h,onFocusOutside:m,onInteractOutside:p,onDismiss:f,disableOutsideScroll:b,...g}=t,y=Us(dt,r),w=la(dt,r),v=_n(r),x=uh(r),j=Ij(r),[N,S]=u.useState(null),_=u.useRef(null),E=xe(e,_,y.onContentChange),k=u.useRef(0),A=u.useRef(""),B=u.useRef(0),$=u.useRef(null),H=u.useRef("right"),O=u.useRef(0),Y=b?Sn:u.Fragment,z=b?{as:zj,allowPinchZoom:!0}:void 0,R=C=>{const q=A.current+C,T=j().filter(D=>!D.disabled),U=document.activeElement,X=T.find(D=>D.ref.current===U)?.textValue,de=T.map(D=>D.textValue),I=eN(de,q,X),L=T.find(D=>D.textValue===I)?.ref.current;(function D(ie){A.current=ie,window.clearTimeout(k.current),ie!==""&&(k.current=window.setTimeout(()=>D(""),1e3))})(q),L&&setTimeout(()=>L.focus())};u.useEffect(()=>()=>window.clearTimeout(k.current),[]),Ri();const M=u.useCallback(C=>H.current===$.current?.side&&sN(C,$.current?.area),[]);return s.jsx(Fj,{scope:r,searchRef:A,onItemEnter:u.useCallback(C=>{M(C)&&C.preventDefault()},[M]),onItemLeave:u.useCallback(C=>{M(C)||(_.current?.focus(),S(null))},[M]),onTriggerLeave:u.useCallback(C=>{M(C)&&C.preventDefault()},[M]),pointerGraceTimerRef:B,onPointerGraceIntentChange:u.useCallback(C=>{$.current=C},[]),children:s.jsx(Y,{...z,children:s.jsx(bn,{asChild:!0,trapped:n,onMountAutoFocus:W(o,C=>{C.preventDefault(),_.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:i,children:s.jsx(xr,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:d,onPointerDownOutside:h,onFocusOutside:m,onInteractOutside:p,onDismiss:f,children:s.jsx(Zu,{asChild:!0,...x,dir:w.dir,orientation:"vertical",loop:a,currentTabStopId:N,onCurrentTabStopIdChange:S,onEntryFocus:W(c,C=>{w.isUsingKeyboardRef.current||C.preventDefault()}),preventScrollOnEntryFocus:!0,children:s.jsx(bi,{role:"menu","aria-orientation":"vertical","data-state":Ah(y.open),"data-radix-menu-content":"",dir:w.dir,...v,...g,ref:E,style:{outline:"none",...g.style},onKeyDown:W(g.onKeyDown,C=>{const T=C.target.closest("[data-radix-menu-content]")===C.currentTarget,U=C.ctrlKey||C.altKey||C.metaKey,X=C.key.length===1;T&&(C.key==="Tab"&&C.preventDefault(),!U&&X&&R(C.key));const de=_.current;if(C.target!==de||!Pj.includes(C.key))return;C.preventDefault();const L=j().filter(D=>!D.disabled).map(D=>D.ref.current);ch.includes(C.key)&&L.reverse(),Xj(L)}),onBlur:W(t.onBlur,C=>{C.currentTarget.contains(C.target)||(window.clearTimeout(k.current),A.current="")}),onPointerMove:W(t.onPointerMove,Vr(C=>{const q=C.target,T=O.current!==C.clientX;if(C.currentTarget.contains(q)&&T){const U=C.clientX>O.current?"right":"left";H.current=U,O.current=C.clientX}}))})})})})})})});ph.displayName=dt;var qj="MenuGroup",$i=u.forwardRef((t,e)=>{const{__scopeMenu:r,...a}=t;return s.jsx(ne.div,{role:"group",...a,ref:e})});$i.displayName=qj;var Wj="MenuLabel",gh=u.forwardRef((t,e)=>{const{__scopeMenu:r,...a}=t;return s.jsx(ne.div,{...a,ref:e})});gh.displayName=Wj;var Ya="MenuItem",Cc="menu.itemSelect",Cn=u.forwardRef((t,e)=>{const{disabled:r=!1,onSelect:a,...n}=t,o=u.useRef(null),i=la(Ya,t.__scopeMenu),l=Mi(Ya,t.__scopeMenu),c=xe(e,o),d=u.useRef(!1),h=()=>{const m=o.current;if(!r&&m){const p=new CustomEvent(Cc,{bubbles:!0,cancelable:!0});m.addEventListener(Cc,f=>a?.(f),{once:!0}),ni(m,p),p.defaultPrevented?d.current=!1:i.onClose()}};return s.jsx(xh,{...n,ref:c,disabled:r,onClick:W(t.onClick,h),onPointerDown:m=>{t.onPointerDown?.(m),d.current=!0},onPointerUp:W(t.onPointerUp,m=>{d.current||m.currentTarget?.click()}),onKeyDown:W(t.onKeyDown,m=>{const p=l.searchRef.current!=="";r||p&&m.key===" "||Ho.includes(m.key)&&(m.currentTarget.click(),m.preventDefault())})})});Cn.displayName=Ya;var xh=u.forwardRef((t,e)=>{const{__scopeMenu:r,disabled:a=!1,textValue:n,...o}=t,i=Mi(Ya,r),l=uh(r),c=u.useRef(null),d=xe(e,c),[h,m]=u.useState(!1),[p,f]=u.useState("");return u.useEffect(()=>{const b=c.current;b&&f((b.textContent??"").trim())},[o.children]),s.jsx(Hr.ItemSlot,{scope:r,disabled:a,textValue:n??p,children:s.jsx(eh,{asChild:!0,...l,focusable:!a,children:s.jsx(ne.div,{role:"menuitem","data-highlighted":h?"":void 0,"aria-disabled":a||void 0,"data-disabled":a?"":void 0,...o,ref:d,onPointerMove:W(t.onPointerMove,Vr(b=>{a?i.onItemLeave(b):(i.onItemEnter(b),b.defaultPrevented||b.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:W(t.onPointerLeave,Vr(b=>i.onItemLeave(b))),onFocus:W(t.onFocus,()=>m(!0)),onBlur:W(t.onBlur,()=>m(!1))})})})}),Hj="MenuCheckboxItem",vh=u.forwardRef((t,e)=>{const{checked:r=!1,onCheckedChange:a,...n}=t;return s.jsx(Nh,{scope:t.__scopeMenu,checked:r,children:s.jsx(Cn,{role:"menuitemcheckbox","aria-checked":Qa(r)?"mixed":r,...n,ref:e,"data-state":Ui(r),onSelect:W(n.onSelect,()=>a?.(Qa(r)?!0:!r),{checkForDefaultPrevented:!1})})})});vh.displayName=Hj;var yh="MenuRadioGroup",[Vj,Gj]=Fs(yh,{value:void 0,onValueChange:()=>{}}),wh=u.forwardRef((t,e)=>{const{value:r,onValueChange:a,...n}=t,o=Ke(a);return s.jsx(Vj,{scope:t.__scopeMenu,value:r,onValueChange:o,children:s.jsx($i,{...n,ref:e})})});wh.displayName=yh;var bh="MenuRadioItem",jh=u.forwardRef((t,e)=>{const{value:r,...a}=t,n=Gj(bh,t.__scopeMenu),o=r===n.value;return s.jsx(Nh,{scope:t.__scopeMenu,checked:o,children:s.jsx(Cn,{role:"menuitemradio","aria-checked":o,...a,ref:e,"data-state":Ui(o),onSelect:W(a.onSelect,()=>n.onValueChange?.(r),{checkForDefaultPrevented:!1})})})});jh.displayName=bh;var Fi="MenuItemIndicator",[Nh,Kj]=Fs(Fi,{checked:!1}),Sh=u.forwardRef((t,e)=>{const{__scopeMenu:r,forceMount:a,...n}=t,o=Kj(Fi,r);return s.jsx(ht,{present:a||Qa(o.checked)||o.checked===!0,children:s.jsx(ne.span,{...n,ref:e,"data-state":Ui(o.checked)})})});Sh.displayName=Fi;var Jj="MenuSeparator",_h=u.forwardRef((t,e)=>{const{__scopeMenu:r,...a}=t;return s.jsx(ne.div,{role:"separator","aria-orientation":"horizontal",...a,ref:e})});_h.displayName=Jj;var Yj="MenuArrow",Ch=u.forwardRef((t,e)=>{const{__scopeMenu:r,...a}=t,n=_n(r);return s.jsx(ji,{...n,...a,ref:e})});Ch.displayName=Yj;var Qj="MenuSub",[GC,Eh]=Fs(Qj),Rr="MenuSubTrigger",kh=u.forwardRef((t,e)=>{const r=Us(Rr,t.__scopeMenu),a=la(Rr,t.__scopeMenu),n=Eh(Rr,t.__scopeMenu),o=Mi(Rr,t.__scopeMenu),i=u.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=o,d={__scopeMenu:t.__scopeMenu},h=u.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return u.useEffect(()=>h,[h]),u.useEffect(()=>{const m=l.current;return()=>{window.clearTimeout(m),c(null)}},[l,c]),s.jsx(Di,{asChild:!0,...d,children:s.jsx(xh,{id:n.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":n.contentId,"data-state":Ah(r.open),...t,ref:ln(e,n.onTriggerChange),onClick:m=>{t.onClick?.(m),!(t.disabled||m.defaultPrevented)&&(m.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:W(t.onPointerMove,Vr(m=>{o.onItemEnter(m),!m.defaultPrevented&&!t.disabled&&!r.open&&!i.current&&(o.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{r.onOpenChange(!0),h()},100))})),onPointerLeave:W(t.onPointerLeave,Vr(m=>{h();const p=r.content?.getBoundingClientRect();if(p){const f=r.content?.dataset.side,b=f==="right",g=b?-5:5,y=p[b?"left":"right"],w=p[b?"right":"left"];o.onPointerGraceIntentChange({area:[{x:m.clientX+g,y:m.clientY},{x:y,y:p.top},{x:w,y:p.top},{x:w,y:p.bottom},{x:y,y:p.bottom}],side:f}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(m),m.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:W(t.onKeyDown,m=>{const p=o.searchRef.current!=="";t.disabled||p&&m.key===" "||Aj[a.dir].includes(m.key)&&(r.onOpenChange(!0),r.content?.focus(),m.preventDefault())})})})});kh.displayName=Rr;var Th="MenuSubContent",Ph=u.forwardRef((t,e)=>{const r=mh(dt,t.__scopeMenu),{forceMount:a=r.forceMount,...n}=t,o=Us(dt,t.__scopeMenu),i=la(dt,t.__scopeMenu),l=Eh(Th,t.__scopeMenu),c=u.useRef(null),d=xe(e,c);return s.jsx(Hr.Provider,{scope:t.__scopeMenu,children:s.jsx(ht,{present:a||o.open,children:s.jsx(Hr.Slot,{scope:t.__scopeMenu,children:s.jsx(Li,{id:l.contentId,"aria-labelledby":l.triggerId,...n,ref:d,align:"start",side:i.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:h=>{i.isUsingKeyboardRef.current&&c.current?.focus(),h.preventDefault()},onCloseAutoFocus:h=>h.preventDefault(),onFocusOutside:W(t.onFocusOutside,h=>{h.target!==l.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:W(t.onEscapeKeyDown,h=>{i.onClose(),h.preventDefault()}),onKeyDown:W(t.onKeyDown,h=>{const m=h.currentTarget.contains(h.target),p=Rj[i.dir].includes(h.key);m&&p&&(o.onOpenChange(!1),l.trigger?.focus(),h.preventDefault())})})})})})});Ph.displayName=Th;function Ah(t){return t?"open":"closed"}function Qa(t){return t==="indeterminate"}function Ui(t){return Qa(t)?"indeterminate":t?"checked":"unchecked"}function Xj(t){const e=document.activeElement;for(const r of t)if(r===e||(r.focus(),document.activeElement!==e))return}function Zj(t,e){return t.map((r,a)=>t[(e+a)%t.length])}function eN(t,e,r){const n=e.length>1&&Array.from(e).every(d=>d===e[0])?e[0]:e,o=r?t.indexOf(r):-1;let i=Zj(t,Math.max(o,0));n.length===1&&(i=i.filter(d=>d!==r));const c=i.find(d=>d.toLowerCase().startsWith(n.toLowerCase()));return c!==r?c:void 0}function tN(t,e){const{x:r,y:a}=t;let n=!1;for(let o=0,i=e.length-1;o<e.length;i=o++){const l=e[o],c=e[i],d=l.x,h=l.y,m=c.x,p=c.y;h>a!=p>a&&r<(m-d)*(a-h)/(p-h)+d&&(n=!n)}return n}function sN(t,e){if(!e)return!1;const r={x:t.clientX,y:t.clientY};return tN(r,e)}function Vr(t){return e=>e.pointerType==="mouse"?t(e):void 0}var rN=hh,aN=Di,nN=fh,oN=ph,iN=$i,lN=gh,cN=Cn,dN=vh,uN=wh,hN=jh,mN=Sh,fN=_h,pN=Ch,gN=kh,xN=Ph,En="DropdownMenu",[vN,KC]=Xe(En,[dh]),Je=dh(),[yN,Rh]=vN(En),Ih=t=>{const{__scopeDropdownMenu:e,children:r,dir:a,open:n,defaultOpen:o,onOpenChange:i,modal:l=!0}=t,c=Je(e),d=u.useRef(null),[h,m]=Vt({prop:n,defaultProp:o??!1,onChange:i,caller:En});return s.jsx(yN,{scope:e,triggerId:Dt(),triggerRef:d,contentId:Dt(),open:h,onOpenChange:m,onOpenToggle:u.useCallback(()=>m(p=>!p),[m]),modal:l,children:s.jsx(rN,{...c,open:h,onOpenChange:m,dir:a,modal:l,children:r})})};Ih.displayName=En;var Dh="DropdownMenuTrigger",Oh=u.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,disabled:a=!1,...n}=t,o=Rh(Dh,r),i=Je(r);return s.jsx(aN,{asChild:!0,...i,children:s.jsx(ne.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":a?"":void 0,disabled:a,...n,ref:ln(e,o.triggerRef),onPointerDown:W(t.onPointerDown,l=>{!a&&l.button===0&&l.ctrlKey===!1&&(o.onOpenToggle(),o.open||l.preventDefault())}),onKeyDown:W(t.onKeyDown,l=>{a||(["Enter"," "].includes(l.key)&&o.onOpenToggle(),l.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});Oh.displayName=Dh;var wN="DropdownMenuPortal",Mh=t=>{const{__scopeDropdownMenu:e,...r}=t,a=Je(e);return s.jsx(nN,{...a,...r})};Mh.displayName=wN;var Lh="DropdownMenuContent",$h=u.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...a}=t,n=Rh(Lh,r),o=Je(r),i=u.useRef(!1);return s.jsx(oN,{id:n.contentId,"aria-labelledby":n.triggerId,...o,...a,ref:e,onCloseAutoFocus:W(t.onCloseAutoFocus,l=>{i.current||n.triggerRef.current?.focus(),i.current=!1,l.preventDefault()}),onInteractOutside:W(t.onInteractOutside,l=>{const c=l.detail.originalEvent,d=c.button===0&&c.ctrlKey===!0,h=c.button===2||d;(!n.modal||h)&&(i.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});$h.displayName=Lh;var bN="DropdownMenuGroup",jN=u.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...a}=t,n=Je(r);return s.jsx(iN,{...n,...a,ref:e})});jN.displayName=bN;var NN="DropdownMenuLabel",Fh=u.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...a}=t,n=Je(r);return s.jsx(lN,{...n,...a,ref:e})});Fh.displayName=NN;var SN="DropdownMenuItem",Uh=u.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...a}=t,n=Je(r);return s.jsx(cN,{...n,...a,ref:e})});Uh.displayName=SN;var _N="DropdownMenuCheckboxItem",Bh=u.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...a}=t,n=Je(r);return s.jsx(dN,{...n,...a,ref:e})});Bh.displayName=_N;var CN="DropdownMenuRadioGroup",EN=u.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...a}=t,n=Je(r);return s.jsx(uN,{...n,...a,ref:e})});EN.displayName=CN;var kN="DropdownMenuRadioItem",zh=u.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...a}=t,n=Je(r);return s.jsx(hN,{...n,...a,ref:e})});zh.displayName=kN;var TN="DropdownMenuItemIndicator",qh=u.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...a}=t,n=Je(r);return s.jsx(mN,{...n,...a,ref:e})});qh.displayName=TN;var PN="DropdownMenuSeparator",Wh=u.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...a}=t,n=Je(r);return s.jsx(fN,{...n,...a,ref:e})});Wh.displayName=PN;var AN="DropdownMenuArrow",RN=u.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...a}=t,n=Je(r);return s.jsx(pN,{...n,...a,ref:e})});RN.displayName=AN;var IN="DropdownMenuSubTrigger",Hh=u.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...a}=t,n=Je(r);return s.jsx(gN,{...n,...a,ref:e})});Hh.displayName=IN;var DN="DropdownMenuSubContent",Vh=u.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...a}=t,n=Je(r);return s.jsx(xN,{...n,...a,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Vh.displayName=DN;var ON=Ih,MN=Oh,LN=Mh,Gh=$h,Kh=Fh,Jh=Uh,Yh=Bh,Qh=zh,Xh=qh,Zh=Wh,em=Hh,tm=Vh;const Vo=ON,Go=MN,$N=u.forwardRef(({className:t,inset:e,children:r,...a},n)=>s.jsxs(em,{ref:n,className:Z("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",e&&"pl-8",t),...a,children:[r,s.jsx(an,{className:"ml-auto h-4 w-4"})]}));$N.displayName=em.displayName;const FN=u.forwardRef(({className:t,...e},r)=>s.jsx(tm,{ref:r,className:Z("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...e}));FN.displayName=tm.displayName;const Xa=u.forwardRef(({className:t,sideOffset:e=4,...r},a)=>s.jsx(LN,{children:s.jsx(Gh,{ref:a,sideOffset:e,className:Z("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})}));Xa.displayName=Gh.displayName;const Pt=u.forwardRef(({className:t,inset:e,...r},a)=>s.jsx(Jh,{ref:a,className:Z("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e&&"pl-8",t),...r}));Pt.displayName=Jh.displayName;const UN=u.forwardRef(({className:t,children:e,checked:r,...a},n)=>s.jsxs(Yh,{ref:n,className:Z("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:r,...a,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(Xh,{children:s.jsx(Yr,{className:"h-4 w-4"})})}),e]}));UN.displayName=Yh.displayName;const BN=u.forwardRef(({className:t,children:e,...r},a)=>s.jsxs(Qh,{ref:a,className:Z("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(Xh,{children:s.jsx(np,{className:"h-2 w-2 fill-current"})})}),e]}));BN.displayName=Qh.displayName;const sm=u.forwardRef(({className:t,inset:e,...r},a)=>s.jsx(Kh,{ref:a,className:Z("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...r}));sm.displayName=Kh.displayName;const Ko=u.forwardRef(({className:t,...e},r)=>s.jsx(Zh,{ref:r,className:Z("-mx-1 my-1 h-px bg-muted",t),...e}));Ko.displayName=Zh.displayName;const zN=ra("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Le({className:t,variant:e,...r}){return s.jsx("div",{className:Z(zN({variant:e}),t),...r})}var kn="Tabs",[qN,JC]=Xe(kn,[jn]),rm=jn(),[WN,Bi]=qN(kn),am=u.forwardRef((t,e)=>{const{__scopeTabs:r,value:a,onValueChange:n,defaultValue:o,orientation:i="horizontal",dir:l,activationMode:c="automatic",...d}=t,h=wn(l),[m,p]=Vt({prop:a,onChange:n,defaultProp:o??"",caller:kn});return s.jsx(WN,{scope:r,baseId:Dt(),value:m,onValueChange:p,orientation:i,dir:h,activationMode:c,children:s.jsx(ne.div,{dir:h,"data-orientation":i,...d,ref:e})})});am.displayName=kn;var nm="TabsList",om=u.forwardRef((t,e)=>{const{__scopeTabs:r,loop:a=!0,...n}=t,o=Bi(nm,r),i=rm(r);return s.jsx(Zu,{asChild:!0,...i,orientation:o.orientation,dir:o.dir,loop:a,children:s.jsx(ne.div,{role:"tablist","aria-orientation":o.orientation,...n,ref:e})})});om.displayName=nm;var im="TabsTrigger",lm=u.forwardRef((t,e)=>{const{__scopeTabs:r,value:a,disabled:n=!1,...o}=t,i=Bi(im,r),l=rm(r),c=um(i.baseId,a),d=hm(i.baseId,a),h=a===i.value;return s.jsx(eh,{asChild:!0,...l,focusable:!n,active:h,children:s.jsx(ne.button,{type:"button",role:"tab","aria-selected":h,"aria-controls":d,"data-state":h?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:c,...o,ref:e,onMouseDown:W(t.onMouseDown,m=>{!n&&m.button===0&&m.ctrlKey===!1?i.onValueChange(a):m.preventDefault()}),onKeyDown:W(t.onKeyDown,m=>{[" ","Enter"].includes(m.key)&&i.onValueChange(a)}),onFocus:W(t.onFocus,()=>{const m=i.activationMode!=="manual";!h&&!n&&m&&i.onValueChange(a)})})})});lm.displayName=im;var cm="TabsContent",dm=u.forwardRef((t,e)=>{const{__scopeTabs:r,value:a,forceMount:n,children:o,...i}=t,l=Bi(cm,r),c=um(l.baseId,a),d=hm(l.baseId,a),h=a===l.value,m=u.useRef(h);return u.useEffect(()=>{const p=requestAnimationFrame(()=>m.current=!1);return()=>cancelAnimationFrame(p)},[]),s.jsx(ht,{present:n||h,children:({present:p})=>s.jsx(ne.div,{"data-state":h?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!p,id:d,tabIndex:0,...i,ref:e,style:{...t.style,animationDuration:m.current?"0s":void 0},children:p&&o})})});dm.displayName=cm;function um(t,e){return`${t}-trigger-${e}`}function hm(t,e){return`${t}-content-${e}`}var HN=am,mm=om,fm=lm,pm=dm;const Zt=HN,$t=u.forwardRef(({className:t,...e},r)=>s.jsx(mm,{ref:r,className:Z("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...e}));$t.displayName=mm.displayName;const ye=u.forwardRef(({className:t,...e},r)=>s.jsx(fm,{ref:r,className:Z("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...e}));ye.displayName=fm.displayName;const be=u.forwardRef(({className:t,...e},r)=>s.jsx(pm,{ref:r,className:Z("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));be.displayName=pm.displayName;const VN=()=>"http://localhost:5000",GN=VN(),KN=`${GN}/api`,JN=parseInt("60000"),YN=!0,QN=3,XN=1e3,it={baseURL:KN,timeout:JN,enableLogging:YN,maxRetries:QN,retryDelay:XN,headers:{"Content-Type":"application/json",Accept:"application/json",Connection:"keep-alive"}},re={auth:{login:"/auth/login",register:"/auth/register",logout:"/auth/logout",refresh:"/auth/refresh",profile:"/auth/profile",forgotPassword:"/auth/forgot-password",resetPassword:"/auth/reset-password"},users:{profile:"/users/profile",updateProfile:"/users/profile",uploadAvatar:"/media/avatar",followers:"/users/followers",following:"/users/following",follow:t=>`/users/${t}/follow`,unfollow:t=>`/users/${t}/unfollow`,search:"/users/search"},trips:{list:"/trips",create:"/trips",detail:t=>`/trips/${t}`,update:t=>`/trips/${t}`,delete:t=>`/trips/${t}`,join:t=>`/trips/${t}/join`,leave:t=>`/trips/${t}/leave`,participants:t=>`/trips/${t}/participants`,comments:t=>`/trips/${t}/comments`,like:t=>`/trips/${t}/like`,search:"/trips/search",nearby:"/trips/nearby",request:t=>`/trips/${t}/request`,requestsMy:"/trips/requests/my",requestsForTrip:t=>`/trips/${t}/requests`,approveRequest:t=>`/trips/requests/${t}/approve`,rejectRequest:t=>`/trips/requests/${t}/reject`},clubs:{list:"/clubs",create:"/clubs",detail:t=>`/clubs/${t}`,update:t=>`/clubs/${t}`,delete:t=>`/clubs/${t}`,join:t=>`/clubs/${t}/join`,leave:t=>`/clubs/${t}/leave`,members:t=>`/clubs/${t}/members`,posts:t=>`/clubs/${t}/posts`,search:"/clubs/search"},journeys:{list:"/journeys",myJourneys:"/journeys/my-journeys",create:"/journeys",detail:t=>`/journeys/${t}`,update:t=>`/journeys/${t}`,delete:t=>`/journeys/${t}`,like:t=>`/journeys/${t}/like`,comment:t=>`/journeys/${t}/comments`,share:t=>`/journeys/${t}/share`,feed:"/journeys/feed",trending:"/journeys/trending"},stories:{list:"/stories",create:"/stories",detail:t=>`/stories/${t}`,delete:t=>`/stories/${t}`,view:t=>`/stories/${t}/view`,feed:"/stories/feed"},budget:{list:"/budget",create:"/budget",detail:t=>`/budget/${t}`,update:t=>`/budget/${t}`,delete:t=>`/budget/${t}`,expenses:t=>`/budget/${t}/expenses`,addExpense:t=>`/budget/${t}/expenses`,updateExpense:(t,e)=>`/budget/${t}/expenses/${e}`,deleteExpense:(t,e)=>`/budget/${t}/expenses/${e}`},booking:{partners:"/booking/partners",partnerDetail:t=>`/booking/partners/${t}`,features:"/booking/features",featureDetail:t=>`/booking/features/${t}`,trackVisit:t=>`/booking/partners/${t}/visit`},notifications:{list:"/notifications",unreadCount:"/notifications/unread-count",markRead:t=>`/notifications/${t}/read`,markAllRead:"/notifications/read-all",delete:t=>`/notifications/${t}`,settings:"/notifications/settings"},search:{global:"/search",users:"/search/users",trips:"/search/trips",clubs:"/search/clubs",journeys:"/search/journeys",suggestions:"/search/suggestions"},media:{avatar:"/media/avatar",tripImages:"/media/trip-images",temp:"/media/temp",deleteTripImage:t=>`/media/trip-image/${t}`,deleteTemp:t=>`/media/temp/${t}`,cleanup:"/media/cleanup-temp",info:t=>`/media/info/${t}`,health:"/media/health"},map:{places:"/map/places",nearby:"/map/nearby",geocode:"/map/geocode",reverseGeocode:"/map/reverse-geocode"},wallet:{details:"/wallet",createOrder:"/wallet/create-order",verifyPayment:"/wallet/verify-payment",withdraw:"/wallet/withdraw"},etrav:{bus:{search:"/etrav/bus/search",seatLayout:"/etrav/bus/seat-layout",block:"/etrav/bus/block",book:"/etrav/bus/book"},flight:{search:"/etrav/flight/search",fareRules:"/etrav/flight/fare-rules",ssr:"/etrav/flight/ssr",book:"/etrav/flight/book"},hotel:{search:"/etrav/hotel/search",roomTypes:"/etrav/hotel/room-types",block:"/etrav/hotel/block",book:"/etrav/hotel/book"}}},K=t=>`${it.baseURL}${t}`,ot=async()=>{try{const{data:{session:t},error:e}=await le.auth.getSession();return e?(console.warn("Error getting session:",e),{}):t?.access_token?{Authorization:`Bearer ${t.access_token}`}:(console.warn("No active session found"),{})}catch(t){return console.warn("Error in getAuthHeader:",t),{}}},fe=()=>{try{const t="https://gserzaenfrmrqoffzcxr.supabase.co";if(t){const a=`sb-${t.split("//")[1]?.split(".")[0]}-auth-token`,n=localStorage.getItem(a);if(n)try{const i=JSON.parse(n)?.access_token;if(i)return{Authorization:`Bearer ${i}`}}catch(o){console.warn("Failed to parse Supabase session:",o)}}const e=localStorage.getItem("authToken");return e?{Authorization:`Bearer ${e}`}:{}}catch(t){return console.warn("Error getting auth header:",t),{}}},Ve=Object.freeze(Object.defineProperty({__proto__:null,apiConfig:it,buildUrl:K,endpoints:re,getAuthHeader:ot,getAuthHeaderSync:fe},Symbol.toStringTag,{value:"Module"}));class ZN{prefix="wandersphere_cache_";defaultTTL=300*1e3;maxCacheSize=50;set(e,r,a={}){try{const{ttl:n=this.defaultTTL,version:o="1.0"}=a,i=Date.now(),l={data:r,timestamp:i,expiresAt:i+n,version:o},c=this.getCacheKey(e);localStorage.setItem(c,JSON.stringify(l)),this.cleanupCache()}catch(n){console.warn("Failed to cache data:",n)}}get(e,r="1.0"){try{const a=this.getCacheKey(e),n=localStorage.getItem(a);if(!n)return null;const o=JSON.parse(n);return Date.now()>o.expiresAt?(this.remove(e),null):o.version!==r?(this.remove(e),null):o.data}catch(a){return console.warn("Failed to retrieve cached data:",a),null}}remove(e){try{const r=this.getCacheKey(e);localStorage.removeItem(r)}catch(r){console.warn("Failed to remove cached data:",r)}}clear(){try{Object.keys(localStorage).forEach(r=>{r.startsWith(this.prefix)&&localStorage.removeItem(r)})}catch(e){console.warn("Failed to clear cache:",e)}}has(e,r="1.0"){return this.get(e,r)!==null}getMetadata(e){try{const r=this.getCacheKey(e),a=localStorage.getItem(r);if(!a)return null;const n=JSON.parse(a);return{timestamp:n.timestamp,expiresAt:n.expiresAt,version:n.version}}catch{return null}}isStale(e,r=120*1e3){const a=this.getMetadata(e);return a?Date.now()-a.timestamp>r:!0}getStats(){const e=Object.keys(localStorage).filter(n=>n.startsWith(this.prefix));let r=0,a=null;return e.forEach(n=>{const o=localStorage.getItem(n);if(o){r+=o.length;try{const i=JSON.parse(o);(!a||i.timestamp<a)&&(a=i.timestamp)}catch{}}}),{totalItems:e.length,totalSize:r,oldestItem:a}}getCacheKey(e){return`${this.prefix}${e}`}cleanupCache(){try{const e=Object.keys(localStorage).filter(n=>n.startsWith(this.prefix)).map(n=>{const o=localStorage.getItem(n);if(!o)return null;try{const i=JSON.parse(o);return{key:n,timestamp:i.timestamp,expiresAt:i.expiresAt}}catch{return{key:n,timestamp:0,expiresAt:0}}}).filter(Boolean),r=Date.now();e.forEach(({key:n,expiresAt:o})=>{r>o&&localStorage.removeItem(n)});const a=e.filter(({expiresAt:n})=>r<=n);a.length>this.maxCacheSize&&a.sort((n,o)=>n.timestamp-o.timestamp).slice(0,a.length-this.maxCacheSize).forEach(({key:n})=>localStorage.removeItem(n))}catch(e){console.warn("Failed to cleanup cache:",e)}}}const Ea=new ZN,Ps={userProfile:t=>`user_profile_${t}`,userJourneys:t=>`user_journeys_${t}`,notifications:t=>`notifications_${t}`,followers:t=>`followers_${t}`,following:t=>`following_${t}`,journeyDetail:t=>`journey_detail_${t}`,journeyComments:t=>`journey_comments_${t}`,tripDetail:t=>`trip_detail_${t}`,tripComments:t=>`trip_comments_${t}`,searchResults:(t,e)=>`search_${e}_${t}`,clubs:()=>"clubs_list",clubDetail:t=>`club_detail_${t}`,stories:t=>`stories_${t}`,storyDetail:t=>`story_detail_${t}`,BOOKING_PARTNERS:"booking_partners",BOOKING_FEATURES:"booking_features"},It={SHORT:120*1e3,MEDIUM:300*1e3,LONG:900*1e3,VERY_LONG:3600*1e3},eS=()=>{const[t,e]=u.useState(navigator.onLine);return u.useEffect(()=>{const r=()=>e(!0),a=()=>e(!1);return window.addEventListener("online",r),window.addEventListener("offline",a),()=>{window.removeEventListener("online",r),window.removeEventListener("offline",a)}},[]),t},tS=()=>{const t=navigator.userAgent||navigator.vendor||window.opera,e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i,r="ontouchstart"in window||navigator.maxTouchPoints>0,a=window.innerWidth<=768;return e.test(t)||r&&a},Ec=()=>{const t=navigator.userAgent||navigator.vendor||window.opera,e=/Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i,r=/iPad|Android(?=.*\bMobile\b)(?!.*\bTablet\b)|KFAPWI/i;return e.test(t)&&!r.test(t)},kc=()=>{const t=navigator.userAgent||navigator.vendor||window.opera;return/iPad|Android(?!.*\bMobile\b)|KFAPWI/i.test(t)},sS=()=>{const[t,e]=u.useState(()=>Ec()?"mobile":kc()?"tablet":"desktop");return u.useEffect(()=>{const r=()=>{Ec()?e("mobile"):kc()?e("tablet"):e("desktop")};return window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),t};async function te(t,e={}){const{method:r="GET",headers:a={},body:n,timeout:o=it.timeout,skipAuth:i=!1,cache:l,offlineStrategy:c="network-first"}=e;let d={};if(!i){const{getAuthHeader:w}=await we(async()=>{const{getAuthHeader:v}=await Promise.resolve().then(()=>Ve);return{getAuthHeader:v}},void 0,import.meta.url);if(d=await w(),!d.Authorization){const v=new Error("Not authenticated. Please log in.");throw v.status=401,v}}const h=navigator.onLine,m=tS(),p=l?.key||aS(t,r,n);if((c==="cache-first"||!h)&&r==="GET"){const w=Ea.get(p,l?.version);if(w){if(m||!h)return!h&&m&&ka(),w;if(!h)return Ta(),w}}if(c==="cache-only"){const w=Ea.get(p,l?.version);if(w)return w;throw new Error("No cached data available")}if(!h&&r!=="GET")throw m?(ka("Changes will be synced when you're back online"),new Error("Offline: Request queued for sync")):(Ta(),new Error("Network connection required"));const f=it.maxRetries,b=it.retryDelay;let g=null;const y=w=>{if(!w)return!1;const v=w.status;return v===401||v===403||v>=400&&v<500&&v!==429?!1:!!(w instanceof DOMException&&w.name==="AbortError"||w.message&&(w.message.includes("NetworkError")||w.message.includes("Failed to fetch")||w.message.includes("ERR_CONNECTION_REFUSED")||w.message.includes("timeout"))||v>=500&&v<600||v===429)};for(let w=0;w<=f;w++)try{const v=new AbortController,x=setTimeout(()=>v.abort(),o),j={method:r,headers:{...it.headers,...d,...a},signal:v.signal,keepalive:!0};if(n)if(n instanceof FormData){j.body=n;const E={...j.headers};delete E["Content-Type"],j.headers=E}else j.body=JSON.stringify(n),j.headers["Content-Type"]||(j.headers={...j.headers,"Content-Type":"application/json"});it.enableLogging&&console.log(`[API] ${r} ${t}`,{attempt:w+1,maxRetries:f+1,headers:Object.keys(j.headers||{}),hasBody:!!n});const N=await fetch(t,j);if(clearTimeout(x),it.enableLogging&&console.log(`[API] Response ${N.status} ${t}`,{status:N.status,statusText:N.statusText,headers:Object.fromEntries(N.headers.entries())}),!N.ok){let E;try{const A=N.headers.get("content-type");A&&A.includes("application/json")?E=await N.json():E={message:await N.text()||`HTTP ${N.status}`}}catch{E={message:`HTTP ${N.status}`}}const k=new Error(E.message||`HTTP ${N.status}`);if(k.status=N.status,k.data=E,N.status===401)throw it.enableLogging&&console.error("[API] Authentication failed - redirecting to login"),k;if(N.status>=400&&N.status<500&&N.status!==429)throw k;if(y(k)&&w<f){g=k;const A=b*Math.pow(2,w);it.enableLogging,await new Promise(B=>setTimeout(B,A));continue}throw k}const S=N.headers.get("content-type");let _;try{if(S&&S.includes("application/json")){const E=await N.text();if(E&&E.trim())try{_=JSON.parse(E)}catch(k){throw console.error(`[API] Invalid JSON response from ${t}:`,E.substring(0,200)),new Error(`Invalid JSON response: ${k instanceof Error?k.message:"Unknown error"}`)}else _=r==="DELETE"?{success:!0}:{}}else _=await N.text()}catch(E){throw console.error(`[API] Failed to parse response from ${t}:`,E),new Error(`Failed to parse response: ${E instanceof Error?E.message:"Unknown error"}`)}return it.enableLogging&&console.log(`[API] Parsed response from ${t}:`,{hasData:!!_,dataKeys:_&&typeof _=="object"?Object.keys(_):"not an object",success:_?.success}),r==="GET"&&l&&!l.forceRefresh&&Ea.set(p,_,{ttl:l.ttl||It.MEDIUM,version:l.version}),_}catch(v){if(g=v,y(v)&&w<f){const x=b*Math.pow(2,w);await new Promise(j=>setTimeout(j,x));continue}if(v instanceof DOMException&&v.name==="AbortError"){const x=new Error(`Request timeout after ${o}ms`);throw ee({title:"Request Timeout",description:"The request took too long to complete. Please try again.",variant:"destructive"}),x}if(v instanceof Error)if(v.message.includes("NetworkError")||v.message.includes("Failed to fetch")||v.message.includes("ERR_CONNECTION_REFUSED")){if(r==="GET"){const x=Ea.get(p,l?.version);if(x)return m?ka("Showing cached data"):Ta("Showing cached data"),x}if(m){const x=rS(t,r);if(x)return console.log(`[API] Using mock data for ${r} ${t}`),ka("Using sample data"),x}else throw Ta("Connection failed. Please check your internet connection."),v}else{const x=v.status;if(x===401){const j=window.location.pathname;throw["/","/find-trips","/trips","/budget","/clubs","/booking","/login","/register"].some(_=>j===_||j.startsWith(_+"/"))||(ee({title:"Authentication Required",description:"Please log in to continue.",variant:"destructive"}),localStorage.removeItem("auth_token"),typeof window<"u"&&window.history&&(window.history.pushState(null,"","/login"),window.dispatchEvent(new PopStateEvent("popstate")))),v}else{if(x===403)throw ee({title:"Access Denied",description:"You don't have permission to perform this action.",variant:"destructive"}),v;if(x>=500)throw ee({title:"Server Error",description:"Something went wrong on our end. Please try again later.",variant:"destructive"}),v}ee({title:"Error",description:v.message||"An unexpected error occurred",variant:"destructive"})}throw v}throw g||new Error("Request failed after all retries")}function rS(t,e){return t.includes("/users/profile")&&e==="GET"?{success:!0,data:{id:"mock-user-123",name:"Demo User",email:"demo@wandersphere.com",username:"demouser",firstName:"Demo",lastName:"User",avatar:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face",bio:"Exploring the world one adventure at a time!",location:"San Francisco, CA",verified:!0,followersCount:245,followingCount:189,tripsCount:12,journeysCount:8,stats:{countriesVisited:15,citiesVisited:42,totalDistance:75e3,totalTrips:12},preferences:{travelStyle:["adventure","cultural"],budget:"mid-range",interests:["photography","hiking","food"],languages:["English","Spanish"]},socialLinks:{instagram:"@demouser",twitter:"@demouser"}}}:t.includes("/notifications")&&e==="GET"?t.includes("unread-count")?{success:!0,data:{count:3}}:{success:!0,data:[{id:"1",type:"trip_invite",title:"Trip Invitation",message:'Sarah invited you to join "Tokyo Adventure 2024"',read:!1,createdAt:new Date().toISOString(),data:{tripId:"trip-123"}},{id:"2",type:"follow",title:"New Follower",message:"Alex started following you",read:!1,createdAt:new Date(Date.now()-36e5).toISOString(),data:{userId:"user-456"}}],pagination:{page:1,limit:5,total:2,totalPages:1}}:t.includes("/followers")&&e==="GET"?{success:!0,data:[{id:"follower-1",name:"Alice Johnson",username:"alice_travels",avatar:"https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face",verified:!0,isFollowing:!1}],pagination:{page:1,limit:10,total:1,totalPages:1}}:t.includes("/following")&&e==="GET"?{success:!0,data:[{id:"following-1",name:"Bob Explorer",username:"bob_explorer",avatar:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face",verified:!1,isFollowing:!0}],pagination:{page:1,limit:10,total:1,totalPages:1}}:e==="PUT"||e==="POST"||e==="DELETE"?{success:!0,message:"Operation completed successfully (offline mode)"}:null}function aS(t,e,r){const a=r?btoa(JSON.stringify(r)).slice(0,8):"";return`api_${e.toLowerCase()}_${t.replace(/[^a-zA-Z0-9]/g,"_")}_${a}`}function ka(t="You're offline. Showing cached data."){ee({title:"Offline Mode",description:t,variant:"default"})}function Ta(t="Network connection failed."){ee({title:"Network Error",description:t,variant:"destructive"})}async function cs(t,e,r={}){const{ttl:a=It.MEDIUM,version:n="1.0",...o}=r;return te(t,{...o,cache:{key:e,ttl:a,version:n}})}class nS{async getNotifications(e=1,r=20,a,n){const o=new URLSearchParams({page:e.toString(),limit:r.toString()});a&&o.append("type",a),n!==void 0&&o.append("read",n.toString());const i=Ps.notifications(`current_${o.toString()}`);return await cs(`${K(re.notifications.list)}?${o.toString()}`,i,{ttl:It.SHORT,headers:fe()})}async getUnreadCount(){return await cs(K(re.notifications.unreadCount),"notifications_unread_count",{ttl:It.SHORT,headers:fe()})}async markAsRead(e){return await te(K(re.notifications.markRead(e)),{method:"PUT",headers:fe()})}async markAllAsRead(){return await te(K(re.notifications.markAllRead),{method:"PUT",headers:fe()})}async deleteNotification(e){return await te(K(re.notifications.delete(e)),{method:"DELETE",headers:fe()})}async deleteAllNotifications(){return await te(K(re.notifications.list),{method:"DELETE",headers:fe()})}async createTestNotification(e,r,a,n){return await te(`${K(re.notifications.list)}/test`,{method:"POST",headers:{...fe(),"Content-Type":"application/json"},body:{type:e,title:r,message:a,data:n}})}}const Es=new nS,fo=()=>{const{user:t,logout:e}=mt(),r=Ls(),[a,n]=u.useState([]),[o,i]=u.useState(0),[l,c]=u.useState("all"),d=u.useRef(0),h=120*1e3,m=[{text:"Book",icon:""},{text:"Travel",icon:""},{text:"Enjoy",icon:""}],[p,f]=u.useState(0);u.useEffect(()=>{const x=setInterval(()=>{f(j=>(j+1)%m.length)},2e3);return()=>clearInterval(x)},[]),u.useEffect(()=>{if(t){const x=Date.now();x-d.current>h?(console.log("[Header] Cache stale, fetching notifications"),b(),g(),d.current=x):console.log("[Header] Using cached notifications, skipping fetch");const N=le.channel("header_notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${t.id}`},S=>{b(),g()}).subscribe();return()=>{le.removeChannel(N)}}},[t]);const b=async()=>{if(t)try{const x=await Es.getNotifications(1,5);x.success&&n(x.data.notifications)}catch(x){console.error("Error fetching notifications:",x),n([])}},g=async()=>{if(t)try{const x=await Es.getUnreadCount();x.success&&i(x.data.unreadCount)}catch(x){console.error("Error fetching unread count:",x),i(0)}},y=x=>{const j=w(x.createdAt);return{id:x.id,type:x.type,user:x.data?.followerName||x.data?.likerName||x.data?.commenterName||"Someone",content:x.message,time:j,comment:x.data?.comment,image:x.data?.image}},w=x=>{const j=new Date(x),S=Math.floor((new Date().getTime()-j.getTime())/(1e3*60*60));return S<1?"Just now":S<24?`${S}h`:S<168?`${Math.floor(S/24)}d`:j.toLocaleDateString()},v=a.map(y);return s.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 bg-background/95 backdrop-blur-md shadow-sm",children:s.jsxs("div",{className:"container flex items-center justify-between h-16 px-4",children:[s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs(Ne,{to:"/",className:"flex items-center gap-2",children:[s.jsx(nn,{className:"h-6 w-6 text-primary"}),s.jsx("span",{className:"font-bold text-lg",children:"WanderSphere"})]})}),s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[s.jsx(Ne,{to:"/booking",children:s.jsxs(P,{size:"sm",className:"bg-gradient-to-r from-primary to-primary/80 text-white shadow-sm hover:shadow-md transition-all duration-300 rounded-lg px-2 sm:px-4",children:[s.jsx("div",{className:"flex items-center gap-1.5 md:hidden",children:s.jsx(ur,{mode:"wait",children:s.jsxs(Q.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},className:"flex items-center gap-1.5",children:[s.jsx("span",{className:"text-xs font-semibold",children:m[p].text}),s.jsx("span",{className:"text-sm",children:m[p].icon})]},p)})}),s.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[s.jsx(op,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm",children:"Bookings"})]})]})}),s.jsxs(Vo,{children:[s.jsx(Go,{asChild:!0,children:s.jsxs(P,{variant:"ghost",size:"icon",className:"relative",children:[s.jsx(Dr,{className:"w-5 h-5"}),o>0&&s.jsx(Le,{className:"absolute -top-1 -right-1 w-5 h-5 p-0 flex items-center justify-center bg-destructive text-destructive-foreground text-xs rounded-full",children:o})]})}),s.jsxs(Xa,{align:"end",className:"w-96 p-0",children:[s.jsx("div",{className:"p-3 bg-muted/30 rounded-t-lg",children:s.jsx("h3",{className:"font-semibold text-lg",children:"Notifications"})}),s.jsxs(Zt,{defaultValue:"all",className:"w-full",onValueChange:c,children:[s.jsx("div",{className:"px-2 pt-2",children:s.jsxs($t,{className:"w-full grid grid-cols-4",children:[s.jsx(ye,{value:"all",className:"text-xs",children:"All"}),s.jsxs(ye,{value:"likes",className:"text-xs",children:[s.jsx(Ht,{className:"h-3 w-3 mr-1"})," Likes"]}),s.jsxs(ye,{value:"comments",className:"text-xs",children:[s.jsx(us,{className:"h-3 w-3 mr-1"})," Comments"]}),s.jsxs(ye,{value:"follows",className:"text-xs",children:[s.jsx(go,{className:"h-3 w-3 mr-1"})," Follows"]})]})}),s.jsx(be,{value:"all",className:"mt-0 max-h-[400px] overflow-y-auto",children:s.jsxs("div",{className:"py-2",children:[s.jsx("div",{className:"px-3 py-1",children:s.jsx("h4",{className:"text-xs font-medium text-muted-foreground",children:"Today"})}),v.map(x=>s.jsx("div",{className:"hover:bg-muted/50 transition-colors cursor-pointer",children:s.jsxs("div",{className:"flex items-start gap-3 p-3",children:[s.jsxs(Pe,{className:"h-10 w-10",children:[s.jsx(Ae,{src:"/avatars/user.png",alt:"Avatar"}),s.jsx(Re,{children:x.user.charAt(0)})]}),s.jsxs("div",{className:"grid gap-1 flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("p",{className:"text-sm",children:[s.jsx("span",{className:"font-medium",children:x.user})," ",x.content]}),s.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:x.time})]}),x.comment&&s.jsxs("p",{className:"text-xs text-muted-foreground",children:['"',x.comment,'"']})]}),x.image&&s.jsx("div",{className:"h-10 w-10 rounded overflow-hidden flex-shrink-0",children:s.jsx("img",{src:x.image,alt:"Post",className:"h-full w-full object-cover"})}),x.type==="follow"&&s.jsx(P,{size:"sm",variant:"outline",className:"h-8 flex-shrink-0",children:"Follow"})]})},x.id))]})}),s.jsx(be,{value:"likes",className:"mt-0 max-h-[400px] overflow-y-auto",children:s.jsx("div",{className:"py-2",children:v.filter(x=>x.type==="like").map(x=>s.jsx("div",{className:"hover:bg-muted/50 transition-colors cursor-pointer",children:s.jsxs("div",{className:"flex items-start gap-3 p-3",children:[s.jsxs(Pe,{className:"h-10 w-10",children:[s.jsx(Ae,{src:"/avatars/user.png",alt:"Avatar"}),s.jsx(Re,{children:x.user.charAt(0)})]}),s.jsx("div",{className:"grid gap-1 flex-1",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("p",{className:"text-sm",children:[s.jsx("span",{className:"font-medium",children:x.user})," ",x.content]}),s.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:x.time})]})}),x.image&&s.jsx("div",{className:"h-10 w-10 rounded overflow-hidden flex-shrink-0",children:s.jsx("img",{src:x.image,alt:"Post",className:"h-full w-full object-cover"})})]})},x.id))})}),s.jsx(be,{value:"comments",className:"mt-0 max-h-[400px] overflow-y-auto",children:s.jsx("div",{className:"py-2",children:v.filter(x=>x.type==="comment").map(x=>s.jsx("div",{className:"hover:bg-muted/50 transition-colors cursor-pointer",children:s.jsxs("div",{className:"flex items-start gap-3 p-3",children:[s.jsxs(Pe,{className:"h-10 w-10",children:[s.jsx(Ae,{src:"/avatars/user.png",alt:"Avatar"}),s.jsx(Re,{children:x.user.charAt(0)})]}),s.jsxs("div",{className:"grid gap-1 flex-1",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("p",{className:"text-sm",children:[s.jsx("span",{className:"font-medium",children:x.user})," ",x.content]}),s.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:x.time})]}),x.comment&&s.jsxs("p",{className:"text-xs",children:['"',x.comment,'"']})]}),x.image&&s.jsx("div",{className:"h-10 w-10 rounded overflow-hidden flex-shrink-0",children:s.jsx("img",{src:x.image,alt:"Post",className:"h-full w-full object-cover"})})]})},x.id))})}),s.jsx(be,{value:"follows",className:"mt-0 max-h-[400px] overflow-y-auto",children:s.jsx("div",{className:"py-2",children:v.filter(x=>x.type==="follow").map(x=>s.jsx("div",{className:"hover:bg-muted/50 transition-colors cursor-pointer",children:s.jsxs("div",{className:"flex items-start gap-3 p-3",children:[s.jsxs(Pe,{className:"h-10 w-10",children:[s.jsx(Ae,{src:"/avatars/user.png",alt:"Avatar"}),s.jsx(Re,{children:x.user.charAt(0)})]}),s.jsx("div",{className:"grid gap-1 flex-1",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("p",{className:"text-sm",children:[s.jsx("span",{className:"font-medium",children:x.user})," ",x.content]}),s.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:x.time})]})}),s.jsx(P,{size:"sm",variant:"outline",className:"h-8 flex-shrink-0",children:"Follow"})]})},x.id))})})]}),s.jsx("div",{className:"p-2 bg-muted/20 rounded-b-lg",children:s.jsx(P,{variant:"ghost",className:"w-full text-primary text-sm",onClick:()=>r("/notifications"),children:"View all notifications"})})]})]}),s.jsxs(Vo,{children:[s.jsx(Go,{asChild:!0,children:s.jsx(P,{variant:"ghost",size:"icon",className:"relative",children:s.jsxs(Pe,{className:"w-8 h-8",children:[s.jsx(Ae,{src:t?.avatar,alt:t?.firstName}),s.jsxs(Re,{className:"bg-primary text-primary-foreground",children:[t?.firstName?.[0],t?.lastName?.[0]]})]})})}),s.jsxs(Xa,{align:"end",className:"w-56",children:[s.jsx(sm,{className:"font-normal",children:s.jsxs("div",{className:"flex flex-col space-y-1",children:[s.jsxs("p",{className:"text-sm font-medium leading-none",children:[t?.firstName," ",t?.lastName]}),s.jsx("p",{className:"text-xs leading-none text-muted-foreground",children:t?.email})]})}),s.jsx(Ko,{}),s.jsx(Pt,{asChild:!0,children:s.jsxs(Ne,{to:"/profile",className:"flex items-center",children:[s.jsx(ip,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:"Profile"})]})}),s.jsx(Pt,{asChild:!0,children:s.jsxs(Ne,{to:"/settings",className:"flex items-center",children:[s.jsx(ei,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:"Settings"})]})}),s.jsx(Ko,{}),s.jsxs(Pt,{onClick:()=>e(),className:"flex items-center text-red-600 focus:text-red-600",children:[s.jsx(zc,{className:"mr-2 h-4 w-4"}),s.jsx("span",{children:"Log out"})]})]})]})]})]})})},Tc=()=>{const t=ai(),e=[{href:"/",icon:lp,label:"Home"},{href:"/clubs",icon:ze,label:"Clubs"},{href:"/find-trips",icon:Ie,label:"Find Trips"},{href:"/map",icon:qc,label:"Map"},{href:"/budget",icon:Qr,label:"Budget"}];return s.jsx("nav",{className:"fixed bottom-0 left-0 right-0 z-50 bg-background/95 backdrop-blur-md shadow-lg",children:s.jsx("div",{className:"flex items-center justify-around py-2 px-2",children:e.map(({href:r,icon:a,label:n})=>{const o=t.pathname===r;return s.jsxs(Ne,{to:r,className:Z("flex flex-col items-center gap-1 px-2 sm:px-3 py-2 rounded-xl transition-all duration-300 min-w-0 flex-1 max-w-20",o?"text-primary bg-primary/15 shadow-sm":"text-muted-foreground hover:text-foreground hover:bg-background/60"),children:[s.jsx(a,{className:Z("w-4 h-4 sm:w-5 sm:h-5",o&&"scale-110")}),s.jsx("span",{className:"text-xs font-medium truncate",children:n})]},r)})})})},oS=({}={})=>{const[t,e]=u.useState(0),[r,a]=u.useState(0),n=[{icon:cp,text:"Preparing your journey...",color:"from-blue-500 to-cyan-500"},{icon:Ie,text:"Loading destinations...",color:"from-purple-500 to-pink-500"},{icon:lt,text:"Setting up memories...",color:"from-orange-500 to-red-500"},{icon:ze,text:"Connecting travelers...",color:"from-green-500 to-emerald-500"}];u.useEffect(()=>{const l=setInterval(()=>{e(d=>d>=100?(clearInterval(l),100):d+2)},80),c=setInterval(()=>{a(d=>(d+1)%n.length)},2e3);return()=>{clearInterval(l),clearInterval(c)}},[]);const o=n[r].icon,i=n[r].color;return s.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 relative overflow-hidden",children:[s.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[s.jsxs("svg",{className:"absolute inset-0 w-full h-full opacity-30",viewBox:"0 0 1200 600",preserveAspectRatio:"xMidYMid meet",children:[s.jsxs("g",{stroke:"rgba(255,255,255,0.3)",strokeWidth:"2",fill:"none",children:[s.jsx("path",{d:"M200 200 Q250 180 300 200 T400 200 Q450 220 500 200 T600 200"}),s.jsx("path",{d:"M600 200 Q650 180 700 200 T800 200 Q850 220 900 200 T1000 200"}),s.jsx("path",{d:"M300 300 Q350 280 400 300 T500 300 Q550 320 600 300"}),s.jsx("path",{d:"M700 350 Q750 330 800 350 T900 350 Q950 370 1000 350"})]}),s.jsx(Q.path,{d:"M100 250 Q200 200 300 250 T500 250 T700 250 T900 250 T1100 250",fill:"none",stroke:"rgba(59, 130, 246, 0.6)",strokeWidth:"3",strokeDasharray:"10 5",initial:{pathLength:0,opacity:0},animate:{pathLength:[0,1,1],opacity:[0,1,.5]},transition:{duration:8,repeat:1/0,ease:"linear"}}),s.jsxs(Q.g,{initial:{x:100,y:250},animate:{x:[100,300,500,700,900,1100],y:[250,250,250,250,250,250]},transition:{duration:8,repeat:1/0,ease:"linear"},children:[s.jsx("circle",{cx:"0",cy:"0",r:"8",fill:"rgba(59, 130, 246, 0.8)"}),s.jsx("circle",{cx:"0",cy:"-12",r:"6",fill:"rgba(255,255,255,0.9)"}),s.jsx("rect",{x:"-4",y:"-4",width:"8",height:"10",rx:"2",fill:"rgba(147, 51, 234, 0.8)"}),s.jsx(Q.circle,{cx:"0",cy:"0",r:"12",fill:"none",stroke:"rgba(59, 130, 246, 0.4)",strokeWidth:"2",animate:{scale:[1,1.5,1],opacity:[.6,0,.6]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}})]}),[{x:300,y:250,label:"Paris"},{x:500,y:250,label:"Tokyo"},{x:700,y:250,label:"New York"},{x:900,y:250,label:"Sydney"}].map((l,c)=>s.jsxs(Q.g,{initial:{opacity:0,scale:0},animate:{opacity:[0,1,1],scale:[0,1.2,1]},transition:{delay:c*.5,duration:1,repeat:1/0,repeatDelay:2},children:[s.jsx("path",{d:`M${l.x} ${l.y} L${l.x} ${l.y-20} M${l.x-8} ${l.y-20} L${l.x+8} ${l.y-20} L${l.x} ${l.y-28} Z`,fill:"rgba(234, 179, 8, 0.8)",stroke:"rgba(234, 179, 8, 1)",strokeWidth:"1.5"}),s.jsx("text",{x:l.x,y:l.y-35,textAnchor:"middle",fill:"rgba(255,255,255,0.9)",fontSize:"12",fontWeight:"bold",children:l.label})]},c))]}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-amber-900/10 via-yellow-900/5 to-amber-800/10",style:{backgroundImage:`
                 repeating-linear-gradient(0deg, transparent, transparent 2px, rgba(139, 69, 19, 0.03) 2px, rgba(139, 69, 19, 0.03) 4px),
                 repeating-linear-gradient(90deg, transparent, transparent 2px, rgba(139, 69, 19, 0.03) 2px, rgba(139, 69, 19, 0.03) 4px)
               `}}),s.jsxs(Q.svg,{className:"absolute top-10 right-10 w-24 h-24 text-white/20",viewBox:"0 0 100 100",animate:{rotate:360},transition:{duration:20,repeat:1/0,ease:"linear"},children:[s.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"currentColor",strokeWidth:"1"}),s.jsx("path",{d:"M50 10 L55 50 L50 50 Z",fill:"currentColor"}),s.jsx("path",{d:"M50 50 L55 50 L50 90 Z",fill:"currentColor"}),s.jsx("path",{d:"M50 50 L10 50 L50 45 Z",fill:"currentColor"}),s.jsx("path",{d:"M50 50 L90 50 L50 45 Z",fill:"currentColor"}),s.jsx("text",{x:"50",y:"30",textAnchor:"middle",fontSize:"12",fill:"currentColor",children:"N"})]})]}),s.jsxs("div",{className:"absolute inset-0 overflow-hidden opacity-20",children:[s.jsxs("div",{className:"absolute inset-0 flex items-center justify-center",children:[s.jsxs(Q.svg,{className:"absolute top-20 left-10 w-32 h-32 text-white/30",viewBox:"0 0 100 100",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{delay:.5,duration:1},children:[s.jsx("path",{d:"M50 10 C30 10, 15 25, 15 45 C15 60, 50 90, 50 90 C50 90, 85 60, 85 45 C85 25, 70 10, 50 10 Z",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),s.jsx("circle",{cx:"50",cy:"45",r:"8",fill:"none",stroke:"currentColor",strokeWidth:"2"})]}),s.jsxs(Q.svg,{className:"absolute top-40 right-20 w-40 h-40 text-white/25",viewBox:"0 0 100 100",initial:{opacity:0,rotate:-180},animate:{opacity:1,rotate:0},transition:{delay:1,duration:1.5},children:[s.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"none",stroke:"currentColor",strokeWidth:"2"}),s.jsx("line",{x1:"50",y1:"10",x2:"50",y2:"50",stroke:"currentColor",strokeWidth:"2"}),s.jsx("line",{x1:"50",y1:"50",x2:"50",y2:"90",stroke:"currentColor",strokeWidth:"2"}),s.jsx("line",{x1:"10",y1:"50",x2:"50",y2:"50",stroke:"currentColor",strokeWidth:"2"}),s.jsx("line",{x1:"50",y1:"50",x2:"90",y2:"50",stroke:"currentColor",strokeWidth:"2"}),s.jsx("path",{d:"M50 50 L70 30 M50 50 L30 70",stroke:"currentColor",strokeWidth:"2",fill:"none"}),s.jsx("circle",{cx:"50",cy:"50",r:"5",fill:"currentColor"})]}),s.jsxs(Q.svg,{className:"absolute bottom-32 left-1/4 w-48 h-32 text-white/20",viewBox:"0 0 200 100",initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{delay:1.5,duration:1},children:[s.jsx("path",{d:"M0 80 L40 40 L80 60 L120 20 L160 50 L200 30 L200 100 L0 100 Z",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),s.jsx("path",{d:"M40 40 L80 60 L120 20",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeDasharray:"3,3"})]}),s.jsxs(Q.svg,{className:"absolute bottom-20 right-1/4 w-36 h-48 text-white/25",viewBox:"0 0 100 150",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:2,duration:1},children:[s.jsx("circle",{cx:"50",cy:"30",r:"12",fill:"none",stroke:"currentColor",strokeWidth:"2"}),s.jsx("path",{d:"M50 42 L50 80 M50 50 L35 65 M50 50 L65 65",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),s.jsx("rect",{x:"42",y:"55",width:"16",height:"20",rx:"2",fill:"none",stroke:"currentColor",strokeWidth:"2"}),s.jsx("path",{d:"M42 60 L58 60",stroke:"currentColor",strokeWidth:"1.5"}),s.jsx("path",{d:"M42 70 L58 70",stroke:"currentColor",strokeWidth:"1.5"})]}),s.jsxs(Q.svg,{className:"absolute top-1/4 left-1/3 w-44 h-24 text-white/20",viewBox:"0 0 200 100",initial:{opacity:0,x:-100},animate:{opacity:[0,1,1,0],x:[-100,100,200,300]},transition:{duration:8,repeat:1/0,ease:"linear"},children:[s.jsx("path",{d:"M20 50 L180 50 M50 30 L50 70 M150 30 L150 70 M20 50 L10 45 L10 55 Z M180 50 L190 45 L190 55 Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),s.jsx("circle",{cx:"50",cy:"50",r:"8",fill:"none",stroke:"currentColor",strokeWidth:"2"}),s.jsx("circle",{cx:"150",cy:"50",r:"8",fill:"none",stroke:"currentColor",strokeWidth:"2"})]}),s.jsxs(Q.svg,{className:"absolute top-1/2 right-1/3 w-32 h-24 text-white/20",viewBox:"0 0 100 80",initial:{opacity:0,scale:0},animate:{opacity:1,scale:1},transition:{delay:2.5,duration:1},children:[s.jsx("rect",{x:"20",y:"20",width:"60",height:"40",rx:"3",fill:"none",stroke:"currentColor",strokeWidth:"2"}),s.jsx("circle",{cx:"50",cy:"40",r:"12",fill:"none",stroke:"currentColor",strokeWidth:"2"}),s.jsx("circle",{cx:"50",cy:"40",r:"6",fill:"currentColor"}),s.jsx("rect",{x:"75",y:"30",width:"8",height:"8",rx:"1",fill:"none",stroke:"currentColor",strokeWidth:"1.5"}),s.jsx("path",{d:"M20 20 L15 15 L15 10 L25 10 L25 15 Z",stroke:"currentColor",strokeWidth:"2",fill:"none"})]})]}),[...Array(15)].map((l,c)=>s.jsx(Q.div,{className:"absolute rounded-full bg-white/5",style:{width:Math.random()*60+30,height:Math.random()*60+30,left:`${Math.random()*100}%`,top:`${Math.random()*100}%`},animate:{y:[0,-30,0],x:[0,20,0],opacity:[.2,.4,.2]},transition:{duration:3+Math.random()*2,repeat:1/0,delay:Math.random()*2}},c))]}),s.jsxs("div",{className:"flex flex-col items-center space-y-8 p-8 max-w-md mx-auto relative z-10",children:[s.jsxs(Q.div,{className:"relative",initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",stiffness:200,damping:15,duration:1},children:[s.jsx(Q.div,{className:`relative w-24 h-24 rounded-full bg-gradient-to-br ${i} shadow-2xl`,animate:{rotate:360,scale:[1,1.1,1]},transition:{rotate:{duration:20,repeat:1/0,ease:"linear"},scale:{duration:2,repeat:1/0,ease:"easeInOut"}},children:s.jsx("div",{className:"absolute inset-2 rounded-full bg-slate-900 flex items-center justify-center",children:s.jsx(ur,{mode:"wait",children:s.jsx(Q.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},transition:{duration:.3},children:s.jsx(o,{className:"w-10 h-10 text-white"})},r)})})}),[1,2,3].map(l=>s.jsx(Q.div,{className:`absolute inset-0 rounded-full bg-gradient-to-br ${i} opacity-20`,animate:{scale:[1,1.5+l*.3,1],opacity:[.2,0,.2]},transition:{duration:2+l*.5,repeat:1/0,ease:"easeOut"}},l))]}),s.jsxs(Q.div,{className:"text-center",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5,duration:.8},children:[s.jsx(Q.h1,{className:"text-5xl font-bold bg-gradient-to-r from-white via-blue-200 to-purple-200 bg-clip-text text-transparent mb-3",animate:{backgroundPosition:["0%","100%","0%"]},transition:{duration:3,repeat:1/0,ease:"linear"},style:{backgroundSize:"200% 200%"},children:"WanderSphere"}),s.jsx(Q.p,{className:"text-lg text-white/70",initial:{opacity:0},animate:{opacity:1},transition:{delay:.8,duration:.8},children:"Your Travel Companion"})]}),s.jsxs("div",{className:"w-full max-w-xs space-y-3",children:[s.jsx("div",{className:"bg-white/10 backdrop-blur-sm rounded-full h-3 overflow-hidden shadow-inner border border-white/20",children:s.jsx(Q.div,{className:`h-full bg-gradient-to-r ${i} shadow-lg`,initial:{width:0},animate:{width:`${t}%`},transition:{duration:.3,ease:"easeOut"}})}),s.jsxs(Q.p,{className:"text-sm text-white/60 text-center font-medium",initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},transition:{duration:.2},children:[t,"%"]},t)]}),s.jsx(ur,{mode:"wait",children:s.jsx(Q.div,{className:"text-center",initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.5},children:s.jsx(Q.p,{className:`text-base font-medium bg-gradient-to-r ${i} bg-clip-text text-transparent`,children:n[r].text})},r)})]})]})},iS=ra("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),gm=u.forwardRef(({className:t,variant:e,...r},a)=>s.jsx("div",{ref:a,role:"alert",className:Z(iS({variant:e}),t),...r}));gm.displayName="Alert";const lS=u.forwardRef(({className:t,...e},r)=>s.jsx("h5",{ref:r,className:Z("mb-1 font-medium leading-none tracking-tight",t),...e}));lS.displayName="AlertTitle";const xm=u.forwardRef(({className:t,...e},r)=>s.jsx("div",{ref:r,className:Z("text-sm [&_p]:leading-relaxed",t),...e}));xm.displayName="AlertDescription";const Pa=({onRetry:t,dismissible:e=!0,className:r=""})=>{const a=eS(),n=sS(),[o,i]=F.useState(!1),[l,c]=F.useState(!1);F.useEffect(()=>{a&&(i(!1),c(!1))},[a]);const d=async()=>{if(t){c(!0);try{await t()}catch(f){console.warn("Retry failed:",f)}finally{c(!1)}}else window.location.reload()},h=()=>{i(!0)},p=n==="mobile"||n==="tablet"?{title:"You're offline",description:"Showing cached content. Your changes will sync when you're back online."}:{title:"No internet connection",description:"Please check your network connection and try again."};return a||o?null:s.jsx(ur,{children:s.jsx(Q.div,{initial:{opacity:0,y:-50},animate:{opacity:1,y:0},exit:{opacity:0,y:-50},transition:{duration:.3},className:`fixed top-0 left-0 right-0 z-50 ${r}`,children:s.jsxs(gm,{className:"rounded-none border-x-0 border-t-0 bg-orange-50 border-orange-200 dark:bg-orange-950 dark:border-orange-800",children:[s.jsx(dp,{className:"h-4 w-4 text-orange-600 dark:text-orange-400"}),s.jsxs(xm,{className:"flex items-center justify-between w-full",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"font-medium text-orange-800 dark:text-orange-200",children:p.title}),s.jsx("div",{className:"text-sm text-orange-700 dark:text-orange-300 mt-1",children:p.description})]}),s.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[s.jsxs(P,{variant:"outline",size:"sm",onClick:d,disabled:l,className:"border-orange-300 text-orange-700 hover:bg-orange-100 dark:border-orange-700 dark:text-orange-300 dark:hover:bg-orange-900",children:[s.jsx(Wc,{className:`h-3 w-3 mr-1 ${l?"animate-spin":""}`}),l?"Retrying...":"Retry"]}),e&&s.jsx(P,{variant:"ghost",size:"sm",onClick:h,className:"text-orange-600 hover:bg-orange-100 dark:text-orange-400 dark:hover:bg-orange-900 p-1",children:s.jsx(gr,{className:"h-4 w-4"})})]})]})]})})})},cS=({children:t})=>{const e=ai();Ls();const{isAuthenticated:r,isLoading:a}=mt(),[n,o]=u.useState(!1),i=["/login","/register","/forgot-password","/reset-password","/","/find-trips","/trips","/budget","/clubs","/clubs/","/booking"],c=["/map","/journeys","/profile","/settings","/notifications"].some(f=>e.pathname===f||e.pathname.startsWith(f+"/"));i.some(f=>e.pathname===f||e.pathname.startsWith(f));const d=["/login","/register","/forgot-password","/reset-password"].includes(e.pathname),h=u.useRef(!1),[m,p]=u.useState(!0);return F.useEffect(()=>{if(!a&&!h.current){const f=setTimeout(()=>{h.current=!0,p(!1)},300);return()=>clearTimeout(f)}},[a]),a&&m&&!h.current?s.jsx(oS,{}):a&&h.current?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed top-0 left-0 right-0 h-1 bg-primary/10 z-50",children:s.jsx(Q.div,{className:"h-full bg-primary",initial:{width:"0%"},animate:{width:"100%"},transition:{duration:.3}})}),s.jsx(Pa,{}),s.jsx(fo,{}),s.jsx("main",{className:`min-h-screen bg-background pt-16 pb-20 md:pb-0 ${d?"":n?"md:ml-16":"md:ml-64"} transition-all duration-300`,children:t}),!d&&s.jsx("div",{className:"md:hidden",children:s.jsx(Tc,{})})]}):!r&&c?(localStorage.setItem("redirectAfterAuth",window.location.pathname),s.jsxs(s.Fragment,{children:[s.jsx(Pa,{}),s.jsx(fo,{}),s.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:s.jsxs("div",{className:"bg-card p-8 rounded-lg shadow-lg max-w-md w-full text-center",children:[s.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Sign in Required"}),s.jsx("p",{className:"mb-6",children:"You need to sign in to explore this section of WanderSphere."}),s.jsxs("div",{className:"flex gap-4 justify-center",children:[s.jsx(Ne,{to:"/login",className:"bg-primary text-primary-foreground px-4 py-2 rounded-md",children:"Sign In"}),s.jsx(Ne,{to:"/register",className:"bg-secondary text-secondary-foreground px-4 py-2 rounded-md",children:"Register"})]})]})})]})):d?s.jsxs(s.Fragment,{children:[s.jsx(Pa,{}),s.jsx("main",{className:"min-h-screen bg-background",children:t})]}):s.jsxs(s.Fragment,{children:[s.jsx(Pa,{}),s.jsx(fo,{}),!d&&s.jsxs("nav",{className:`fixed left-0 top-16 bottom-0 hidden md:flex flex-col ${n?"w-16":"w-64"} border-r border-border bg-background z-40 transition-all duration-300`,children:[s.jsxs("div",{className:"p-4 space-y-2 flex-1",children:[s.jsxs(Hs,{to:"/",className:({isActive:f})=>Z("flex items-center p-2 rounded-lg transition-all duration-200",f?"text-primary bg-primary/15 shadow-sm":"text-muted-foreground hover:text-foreground hover:bg-accent"),end:!0,children:[s.jsx("span",{className:"flex justify-center items-center w-6 h-6",children:""}),!n&&s.jsx("span",{className:"ml-2",children:"Home"})]}),s.jsxs(Hs,{to:"/find-trips",className:({isActive:f})=>Z("flex items-center p-2 rounded-lg transition-all duration-200",f?"text-primary bg-primary/15 shadow-sm":"text-muted-foreground hover:text-foreground hover:bg-accent"),children:[s.jsx("span",{className:"flex justify-center items-center w-6 h-6",children:""}),!n&&s.jsx("span",{className:"ml-2",children:"Trips"})]}),s.jsxs(Hs,{to:"/map",className:({isActive:f})=>Z("flex items-center p-2 rounded-lg transition-all duration-200",f?"text-primary bg-primary/15 shadow-sm":"text-muted-foreground hover:text-foreground hover:bg-accent"),children:[s.jsx("span",{className:"flex justify-center items-center w-6 h-6",children:""}),!n&&s.jsx("span",{className:"ml-2",children:"Maps"})]}),s.jsxs(Hs,{to:"/budget",className:({isActive:f})=>Z("flex items-center p-2 rounded-lg transition-all duration-200",f?"text-primary bg-primary/15 shadow-sm":"text-muted-foreground hover:text-foreground hover:bg-accent"),children:[s.jsx("span",{className:"flex justify-center items-center w-6 h-6",children:""}),!n&&s.jsx("span",{className:"ml-2",children:"Budget"})]}),s.jsxs(Hs,{to:"/clubs",className:({isActive:f})=>Z("flex items-center p-2 rounded-lg transition-all duration-200",f?"text-primary bg-primary/15 shadow-sm":"text-muted-foreground hover:text-foreground hover:bg-accent"),children:[s.jsx("span",{className:"flex justify-center items-center w-6 h-6",children:""}),!n&&s.jsx("span",{className:"ml-2",children:"Clubs"})]}),s.jsxs(Hs,{to:"/booking",className:({isActive:f})=>Z("flex items-center p-2 rounded-lg transition-all duration-200",f?"text-primary bg-primary/15 shadow-sm":"text-muted-foreground hover:text-foreground hover:bg-accent"),children:[s.jsx("span",{className:"flex justify-center items-center w-6 h-6",children:""}),!n&&s.jsx("span",{className:"ml-2",children:"Bookings"})]})]}),s.jsx("button",{onClick:()=>o(!n),className:"p-2 m-2 rounded-full bg-accent self-end hover:bg-accent/80 transition-colors",children:n?s.jsx(an,{size:16}):s.jsx(ti,{size:16})})]}),s.jsx("main",{className:`min-h-screen bg-background pt-16 pb-20 md:pb-0 ${d?"":n?"md:ml-16":"md:ml-64"} transition-all duration-300`,children:t}),s.jsx("div",{className:"md:hidden",children:s.jsx(Tc,{})})]})};var Tn="Dialog",[vm,YC]=Xe(Tn),[dS,Et]=vm(Tn),ym=t=>{const{__scopeDialog:e,children:r,open:a,defaultOpen:n,onOpenChange:o,modal:i=!0}=t,l=u.useRef(null),c=u.useRef(null),[d,h]=Vt({prop:a,defaultProp:n??!1,onChange:o,caller:Tn});return s.jsx(dS,{scope:e,triggerRef:l,contentRef:c,contentId:Dt(),titleId:Dt(),descriptionId:Dt(),open:d,onOpenChange:h,onOpenToggle:u.useCallback(()=>h(m=>!m),[h]),modal:i,children:r})};ym.displayName=Tn;var wm="DialogTrigger",bm=u.forwardRef((t,e)=>{const{__scopeDialog:r,...a}=t,n=Et(wm,r),o=xe(e,n.triggerRef);return s.jsx(ne.button,{type:"button","aria-haspopup":"dialog","aria-expanded":n.open,"aria-controls":n.contentId,"data-state":Wi(n.open),...a,ref:o,onClick:W(t.onClick,n.onOpenToggle)})});bm.displayName=wm;var zi="DialogPortal",[uS,jm]=vm(zi,{forceMount:void 0}),Nm=t=>{const{__scopeDialog:e,forceMount:r,children:a,container:n}=t,o=Et(zi,e);return s.jsx(uS,{scope:e,forceMount:r,children:u.Children.map(a,i=>s.jsx(ht,{present:r||o.open,children:s.jsx(ta,{asChild:!0,container:n,children:i})}))})};Nm.displayName=zi;var Za="DialogOverlay",Sm=u.forwardRef((t,e)=>{const r=jm(Za,t.__scopeDialog),{forceMount:a=r.forceMount,...n}=t,o=Et(Za,t.__scopeDialog);return o.modal?s.jsx(ht,{present:a||o.open,children:s.jsx(mS,{...n,ref:e})}):null});Sm.displayName=Za;var hS=Rs("DialogOverlay.RemoveScroll"),mS=u.forwardRef((t,e)=>{const{__scopeDialog:r,...a}=t,n=Et(Za,r);return s.jsx(Sn,{as:hS,allowPinchZoom:!0,shards:[n.contentRef],children:s.jsx(ne.div,{"data-state":Wi(n.open),...a,ref:e,style:{pointerEvents:"auto",...a.style}})})}),Ds="DialogContent",_m=u.forwardRef((t,e)=>{const r=jm(Ds,t.__scopeDialog),{forceMount:a=r.forceMount,...n}=t,o=Et(Ds,t.__scopeDialog);return s.jsx(ht,{present:a||o.open,children:o.modal?s.jsx(fS,{...n,ref:e}):s.jsx(pS,{...n,ref:e})})});_m.displayName=Ds;var fS=u.forwardRef((t,e)=>{const r=Et(Ds,t.__scopeDialog),a=u.useRef(null),n=xe(e,r.contentRef,a);return u.useEffect(()=>{const o=a.current;if(o)return Ii(o)},[]),s.jsx(Cm,{...t,ref:n,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:W(t.onCloseAutoFocus,o=>{o.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:W(t.onPointerDownOutside,o=>{const i=o.detail.originalEvent,l=i.button===0&&i.ctrlKey===!0;(i.button===2||l)&&o.preventDefault()}),onFocusOutside:W(t.onFocusOutside,o=>o.preventDefault())})}),pS=u.forwardRef((t,e)=>{const r=Et(Ds,t.__scopeDialog),a=u.useRef(!1),n=u.useRef(!1);return s.jsx(Cm,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{t.onCloseAutoFocus?.(o),o.defaultPrevented||(a.current||r.triggerRef.current?.focus(),o.preventDefault()),a.current=!1,n.current=!1},onInteractOutside:o=>{t.onInteractOutside?.(o),o.defaultPrevented||(a.current=!0,o.detail.originalEvent.type==="pointerdown"&&(n.current=!0));const i=o.target;r.triggerRef.current?.contains(i)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&n.current&&o.preventDefault()}})}),Cm=u.forwardRef((t,e)=>{const{__scopeDialog:r,trapFocus:a,onOpenAutoFocus:n,onCloseAutoFocus:o,...i}=t,l=Et(Ds,r),c=u.useRef(null),d=xe(e,c);return Ri(),s.jsxs(s.Fragment,{children:[s.jsx(bn,{asChild:!0,loop:!0,trapped:a,onMountAutoFocus:n,onUnmountAutoFocus:o,children:s.jsx(xr,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":Wi(l.open),...i,ref:d,onDismiss:()=>l.onOpenChange(!1)})}),s.jsxs(s.Fragment,{children:[s.jsx(gS,{titleId:l.titleId}),s.jsx(vS,{contentRef:c,descriptionId:l.descriptionId})]})]})}),qi="DialogTitle",Em=u.forwardRef((t,e)=>{const{__scopeDialog:r,...a}=t,n=Et(qi,r);return s.jsx(ne.h2,{id:n.titleId,...a,ref:e})});Em.displayName=qi;var km="DialogDescription",Tm=u.forwardRef((t,e)=>{const{__scopeDialog:r,...a}=t,n=Et(km,r);return s.jsx(ne.p,{id:n.descriptionId,...a,ref:e})});Tm.displayName=km;var Pm="DialogClose",Am=u.forwardRef((t,e)=>{const{__scopeDialog:r,...a}=t,n=Et(Pm,r);return s.jsx(ne.button,{type:"button",...a,ref:e,onClick:W(t.onClick,()=>n.onOpenChange(!1))})});Am.displayName=Pm;function Wi(t){return t?"open":"closed"}var Rm="DialogTitleWarning",[QC,Im]=Gp(Rm,{contentName:Ds,titleName:qi,docsSlug:"dialog"}),gS=({titleId:t})=>{const e=Im(Rm),r=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return u.useEffect(()=>{t&&(document.getElementById(t)||console.error(r))},[r,t]),null},xS="DialogDescriptionWarning",vS=({contentRef:t,descriptionId:e})=>{const a=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${Im(xS).contentName}}.`;return u.useEffect(()=>{const n=t.current?.getAttribute("aria-describedby");e&&n&&(document.getElementById(e)||console.warn(a))},[a,t,e]),null},yS=ym,wS=bm,bS=Nm,Dm=Sm,Om=_m,Mm=Em,Lm=Tm,jS=Am;const ut=yS,Gr=wS,NS=bS,$m=u.forwardRef(({className:t,...e},r)=>s.jsx(Dm,{ref:r,className:Z("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e}));$m.displayName=Dm.displayName;const st=u.forwardRef(({className:t,children:e,...r},a)=>s.jsxs(NS,{children:[s.jsx($m,{}),s.jsxs(Om,{ref:a,className:Z("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r,children:[e,s.jsxs(jS,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[s.jsx(gr,{className:"h-4 w-4"}),s.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));st.displayName=Om.displayName;const rt=({className:t,...e})=>s.jsx("div",{className:Z("flex flex-col space-y-1.5 text-center sm:text-left",t),...e});rt.displayName="DialogHeader";const at=u.forwardRef(({className:t,...e},r)=>s.jsx(Mm,{ref:r,className:Z("text-lg font-semibold leading-none tracking-tight",t),...e}));at.displayName=Mm.displayName;const SS=u.forwardRef(({className:t,...e},r)=>s.jsx(Lm,{ref:r,className:Z("text-sm text-muted-foreground",t),...e}));SS.displayName=Lm.displayName;const xs=u.forwardRef(({className:t,...e},r)=>s.jsx("textarea",{className:Z("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...e}));xs.displayName="Textarea";const se=u.forwardRef(({className:t,type:e,...r},a)=>s.jsx("input",{type:e,className:Z("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:a,...r}));se.displayName="Input";function Hi(t){const e=u.useRef({value:t,previous:t});return u.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var Pn="Switch",[_S,XC]=Xe(Pn),[CS,ES]=_S(Pn),Fm=u.forwardRef((t,e)=>{const{__scopeSwitch:r,name:a,checked:n,defaultChecked:o,required:i,disabled:l,value:c="on",onCheckedChange:d,form:h,...m}=t,[p,f]=u.useState(null),b=xe(e,x=>f(x)),g=u.useRef(!1),y=p?h||!!p.closest("form"):!0,[w,v]=Vt({prop:n,defaultProp:o??!1,onChange:d,caller:Pn});return s.jsxs(CS,{scope:r,checked:w,disabled:l,children:[s.jsx(ne.button,{type:"button",role:"switch","aria-checked":w,"aria-required":i,"data-state":qm(w),"data-disabled":l?"":void 0,disabled:l,value:c,...m,ref:b,onClick:W(t.onClick,x=>{v(j=>!j),y&&(g.current=x.isPropagationStopped(),g.current||x.stopPropagation())})}),y&&s.jsx(zm,{control:p,bubbles:!g.current,name:a,value:c,checked:w,required:i,disabled:l,form:h,style:{transform:"translateX(-100%)"}})]})});Fm.displayName=Pn;var Um="SwitchThumb",Bm=u.forwardRef((t,e)=>{const{__scopeSwitch:r,...a}=t,n=ES(Um,r);return s.jsx(ne.span,{"data-state":qm(n.checked),"data-disabled":n.disabled?"":void 0,...a,ref:e})});Bm.displayName=Um;var kS="SwitchBubbleInput",zm=u.forwardRef(({__scopeSwitch:t,control:e,checked:r,bubbles:a=!0,...n},o)=>{const i=u.useRef(null),l=xe(i,o),c=Hi(r),d=xi(e);return u.useEffect(()=>{const h=i.current;if(!h)return;const m=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(m,"checked").set;if(c!==r&&f){const b=new Event("click",{bubbles:a});f.call(h,r),h.dispatchEvent(b)}},[c,r,a]),s.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...n,tabIndex:-1,ref:l,style:{...n.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});zm.displayName=kS;function qm(t){return t?"checked":"unchecked"}var Wm=Fm,TS=Bm;const yt=u.forwardRef(({className:t,...e},r)=>s.jsx(Wm,{className:Z("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...e,ref:r,children:s.jsx(TS,{className:Z("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));yt.displayName=Wm.displayName;async function Nt(){const{data:{user:t},error:e}=await le.auth.getUser();if(e||!t)throw new Error("Not authenticated. Please log in to continue.");return t.id}const Kr={async getUserProfile(t){const{data:e,error:r}=await le.from("users").select("*").eq("id",t).single();if(r){if(r.code==="PGRST116")return null;throw new Error(`Failed to fetch user profile: ${r.message}`)}return e},async getCurrentUserProfile(){const t=await Nt();return this.getUserProfile(t)},async updateUserProfile(t){const e=await Nt(),{data:r,error:a}=await le.from("users").update(t).eq("id",e).select().single();if(a)throw new Error(`Failed to update profile: ${a.message}`);return r},async updateUserPreferences(t){const e=await Nt(),r=await this.getUserProfile(e);if(!r)throw new Error("User not found");const n={...r.preferences||{},...t},{data:o,error:i}=await le.from("users").update({preferences:n}).eq("id",e).select().single();if(i)throw new Error(`Failed to update preferences: ${i.message}`);return o},async getUserCurrency(){try{const t=await this.getCurrentUserProfile();return t?.preferences?.currency?t.preferences.currency:"USD"}catch(t){return console.error("Error getting user currency:",t),"USD"}}},ks={async getMyTrips(){const t=await Nt(),{data:e,error:r}=await le.from("trips").select("*").eq("user_id",t).order("created_at",{ascending:!1});if(r)throw new Error(`Failed to fetch trips: ${r.message}`);return e},async getTripById(t){const{data:e,error:r}=await le.from("trips").select("*").eq("id",t).single();if(r){if(r.code==="PGRST116")return null;throw new Error(`Failed to fetch trip: ${r.message}`)}return e},async getPublicTrips(t=20){const{data:e,error:r}=await le.from("trips").select("*").eq("visibility","public").eq("is_active",!0).order("created_at",{ascending:!1}).limit(t);if(r)throw new Error(`Failed to fetch public trips: ${r.message}`);return e},async createTrip(t){const e=await Nt(),r={...t,user_id:e},{data:a,error:n}=await le.from("trips").insert(r).select().single();if(n)throw new Error(`Failed to create trip: ${n.message}`);return a},async updateTrip(t,e){const r=await Nt(),a=await this.getTripById(t);if(!a||a.user_id!==r)throw new Error("You do not have permission to update this trip");const{data:n,error:o}=await le.from("trips").update(e).eq("id",t).select().single();if(o)throw new Error(`Failed to update trip: ${o.message}`);return n},async deleteTrip(t){const e=await Nt(),r=await this.getTripById(t);if(!r||r.user_id!==e)throw new Error("You do not have permission to delete this trip");const{error:a}=await le.from("trips").delete().eq("id",t);if(a)throw new Error(`Failed to delete trip: ${a.message}`)}},_s={async getMyJourneys(t){const e=await Nt();let r=le.from("journeys").select("*").eq("user_id",e);t&&(r=r.eq("trip_id",t));const{data:a,error:n}=await r.order("journey_date",{ascending:!1});if(n)throw new Error(`Failed to fetch journeys: ${n.message}`);return a},async getPublicJourneys(t=20){const{data:e,error:r}=await le.from("journeys").select("*").eq("is_public",!0).order("journey_date",{ascending:!1}).limit(t);if(r)throw new Error(`Failed to fetch public journeys: ${r.message}`);return e},async getJourneyById(t){const{data:e,error:r}=await le.from("journeys").select("*").eq("id",t).single();if(r){if(r.code==="PGRST116")return null;throw new Error(`Failed to fetch journey: ${r.message}`)}return e},async getJourneysByTripId(t){const{data:e,error:r}=await le.from("journeys").select("*").eq("trip_id",t).order("journey_date",{ascending:!0});if(r)throw new Error(`Failed to fetch journeys: ${r.message}`);return e},async createJourney(t){const e=await Nt(),r={...t,user_id:e};if(r.trip_id){const o=await ks.getTripById(r.trip_id);if(!o)throw new Error("Trip not found");if(o.user_id!==e)throw new Error("You do not have permission to add journeys to this trip")}const{data:a,error:n}=await le.from("journeys").insert(r).select().single();if(n)throw new Error(`Failed to create journey: ${n.message}`);return a},async updateJourney(t,e){const r=await Nt(),a=await this.getJourneyById(t);if(!a||a.user_id!==r)throw new Error("You do not have permission to update this journey");const{data:n,error:o}=await le.from("journeys").update(e).eq("id",t).select().single();if(o)throw new Error(`Failed to update journey: ${o.message}`);return n},async deleteJourney(t){const e=await Nt(),r=await this.getJourneyById(t);if(!r||r.user_id!==e)throw new Error("You do not have permission to delete this journey");const{error:a}=await le.from("journeys").delete().eq("id",t);if(a)throw new Error(`Failed to delete journey: ${a.message}`)}},Pc=Object.freeze(Object.defineProperty({__proto__:null,journeyService:_s,tripService:ks,userService:Kr},Symbol.toStringTag,{value:"Module"}));async function Pr(t){const e=await Kr.getUserProfile(t.user_id);return{id:t.id,title:t.title,description:t.description||"",content:t.description||"",author:{id:e?.id||t.user_id,firstName:e?.first_name||"",lastName:e?.last_name||"",username:e?.username||"",avatar:e?.avatar_url||void 0},images:t.photos||[],tags:[],destinations:t.location?[t.location.city||"",t.location.country||""].filter(Boolean):[],difficulty:"easy",season:[],likes:[],comments:[],views:0,shares:0,featured:!1,isPublic:t.is_public||!1,status:"published",metadata:{readTime:0,wordCount:(t.description||"").split(" ").length},createdAt:t.created_at,updatedAt:t.updated_at,likeCount:0,commentCount:0,isLiked:!1,isOwner:!1}}function PS(t,e){return{title:t.title,description:t.description||t.content,journey_date:new Date().toISOString().split("T")[0],location:t.destinations&&t.destinations.length>0?{city:t.destinations[0]||"",country:t.destinations[1]||""}:void 0,activities:[],photos:t.images,notes:t.content,is_public:t.isPublic!==!1,trip_id:e||null}}class AS{async getJourneys(e={}){try{const r=await _s.getPublicJourneys(e.limit||20),a=await Promise.all(r.map(Pr));return{success:!0,data:a,pagination:{page:e.page||1,limit:e.limit||a.length,total:a.length,totalPages:1}}}catch(r){throw new Error(r instanceof Error?r.message:"Failed to fetch journeys")}}async getMyJourneys(e){try{const r=await _s.getMyJourneys();return{success:!0,data:{journeys:await Promise.all(r.map(Pr))}}}catch(r){throw new Error(r instanceof Error?r.message:"Failed to fetch my journeys")}}async getJourney(e){try{const r=await _s.getJourneyById(e);if(!r)throw new Error("Journey not found");return{success:!0,data:{journey:await Pr(r)}}}catch(r){throw new Error(r instanceof Error?r.message:"Failed to get journey")}}async createJourney(e,r){try{const a=PS(e,r),n=await _s.createJourney(a);return{success:!0,data:{journey:await Pr(n)}}}catch(a){throw new Error(a instanceof Error?a.message:"Failed to create journey")}}async updateJourney(e,r){try{const a={};r.title&&(a.title=r.title),r.description&&(a.description=r.description),r.content&&(a.notes=r.content),r.isPublic!==void 0&&(a.is_public=r.isPublic),r.images&&(a.photos=r.images);const n=await _s.updateJourney(e,a);return{success:!0,data:{journey:await Pr(n)}}}catch(a){throw new Error(a instanceof Error?a.message:"Failed to update journey")}}async deleteJourney(e){try{return await _s.deleteJourney(e),{success:!0,data:{}}}catch(r){throw new Error(r instanceof Error?r.message:"Failed to delete journey")}}async toggleLike(e){throw new Error("Not implemented yet - requires likes table")}async addComment(e,r){throw new Error("Not implemented yet - requires comments table")}async getFeaturedJourneys(){return this.getJourneys({limit:10})}async shareJourney(e){return{success:!0,data:{shareCount:0}}}}const As=new AS;class RS{async getStoriesFeed(){return this.getStories()}async getStories(){try{const e=await te(K(re.stories.list));return{success:!0,data:{stories:e.data.stories.map(a=>({...a,views:a.views||[],user:{...a.user,avatar:a.user.avatar||a.user.avatar_url}})),hasMore:e.data.hasMore||!1}}}catch(e){throw new Error(e instanceof Error?e.message:"Failed to fetch stories")}}async getStoryById(e){try{const r=await te(K(re.stories.detail(e)));return{success:!0,data:{story:{...r.data.story,views:r.data.story.views||[],user:{...r.data.story.user,avatar:r.data.story.user.avatar||r.data.story.user.avatar_url}}}}}catch(r){throw new Error(r instanceof Error?r.message:"Failed to get story")}}async createStory(e,r,a){try{const n=new FormData;e.media&&n.append("media",e.media),r&&n.append("mediaUrl",r),e.mediaType,a&&n.append("tripId",a);const o=await te(K(re.stories.create),{method:"POST",body:n});return{success:!0,data:{story:{...o.data.story,views:[],user:{...o.data.story.user,avatar:o.data.story.user.avatar||o.data.story.user.avatar_url}}}}}catch(n){throw new Error(n instanceof Error?n.message:"Failed to create story")}}async deleteStory(e){try{return await te(K(re.stories.delete(e)),{method:"DELETE"}),{success:!0,data:void 0}}catch(r){throw new Error(r instanceof Error?r.message:"Failed to delete story")}}async viewStory(e){try{return{success:!0,data:(await te(K(re.stories.view(e)),{method:"POST"})).data}}catch(r){throw new Error(r instanceof Error?r.message:"Failed to mark story as viewed")}}}const Vi=new RS,Yt=""+new URL("hero-beach-Bd7odx6V.jpg",import.meta.url).href,IS=(t,e,r)=>{console.error(r),t.currentTarget.src=e},DS=F.memo(({story:t,onClose:e,onNext:r,onPrev:a})=>{const[n,o]=u.useState(0);return u.useEffect(()=>{if(!t)return;const i=setInterval(()=>{o(l=>l>=100?(clearInterval(i),r(),0):l+1)},100);return()=>clearInterval(i)},[t,r]),t?s.jsx("div",{className:"fixed inset-0 bg-black z-50 flex items-center justify-center",children:s.jsxs("div",{className:"relative w-full max-w-md h-full bg-black",children:[s.jsx("div",{className:"absolute top-4 left-4 right-4 z-10",children:s.jsx("div",{className:"w-full bg-gray-600 rounded-full h-1",children:s.jsx("div",{className:"bg-white h-1 rounded-full transition-all duration-100",style:{width:`${n}%`}})})}),s.jsx("button",{onClick:e,className:"absolute top-4 right-4 z-10 text-white hover:text-gray-300",children:s.jsx(gr,{className:"w-6 h-6"})}),s.jsx("img",{src:t.media,alt:"Story",className:"w-full h-full object-cover"}),s.jsx("div",{className:"absolute bottom-4 left-4 right-4 text-white",children:s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsxs(Pe,{className:"w-8 h-8",children:[s.jsx(Ae,{src:t.avatar}),s.jsx(Re,{children:t.user[0]})]}),s.jsx("span",{className:"font-medium",children:t.user})]})}),s.jsx("button",{onClick:a,className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-white hover:text-gray-300",children:s.jsx(ti,{className:"w-8 h-8"})}),s.jsx("button",{onClick:r,className:"absolute right-4 top-1/2 transform -translate-y-1/2 text-white hover:text-gray-300",children:s.jsx(an,{className:"w-8 h-8"})})]})}):null}),OS=F.memo(({open:t,onOpenChange:e})=>{const[r,a]=u.useState(null),[n,o]=u.useState(""),[i,l]=u.useState(""),[c,d]=u.useState(""),[h,m]=u.useState(!0),[p,f]=u.useState(!1),b=u.useRef(null),g=x=>{if(x.target.files&&x.target.files[0]){const j=x.target.files[0];a(j);const N=URL.createObjectURL(j);o(N)}},y=async()=>{if(!(!r||!i.trim()))try{f(!0);const{supabase:x}=await we(async()=>{const{supabase:$}=await Promise.resolve().then(()=>Jt);return{supabase:$}},void 0,import.meta.url),{data:{session:j},error:N}=await x.auth.getSession();if(N||!j?.access_token)throw new Error("No authentication token available. Please log in.");const S=new FormData;S.append("file",r);const{getAuthHeader:_}=await we(async()=>{const{getAuthHeader:$}=await Promise.resolve().then(()=>Ve);return{getAuthHeader:$}},void 0,import.meta.url),E=await _(),k=await te(`${it.baseURL}/media/temp`,{method:"POST",body:S,headers:{...E}});if(!k.success||!k.data)throw new Error("Failed to upload image");const A={title:i.slice(0,50)+(i.length>50?"...":""),description:i.length>=20?i:i+" ".repeat(20-i.length)+"Shared from my travel experience.",content:i.length>=100?i:i+`

This is a wonderful travel moment I wanted to share with everyone. Every journey tells a story, and this particular experience holds special memories that I hope will inspire others to explore and discover new places.`,isPublic:h,images:[k.data.url],destinations:c?[c]:[],tags:[]},B=await As.createJourney(A);if(B.success)ee({title:"Success",description:"Post created successfully!"}),e(!1),w();else throw new Error(B.message||"Failed to create post")}catch(x){console.error("Error creating post:",x),ee({title:"Error",description:x.message||"Failed to create post. Please try again.",variant:"destructive"})}finally{f(!1)}},w=()=>{a(null),o(""),l(""),d(""),m(!0),b.current&&(b.current.value="")},v=()=>{e(!1),w()};return s.jsx(ut,{open:t,onOpenChange:v,children:s.jsxs(st,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsx(rt,{children:s.jsx(at,{children:"Create New Post"})}),s.jsx("div",{className:"space-y-4",children:n?s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"aspect-square rounded-lg overflow-hidden bg-muted max-w-md mx-auto",children:s.jsx("img",{src:n,alt:"Post preview",className:"w-full h-full object-cover"})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Caption"}),s.jsx(xs,{value:i,onChange:x=>l(x.target.value),placeholder:"Write a caption...",rows:3,className:"resize-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Location (optional)"}),s.jsx(se,{value:c,onChange:x=>d(x.target.value),placeholder:"Add location..."})]}),s.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium",children:"Privacy"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:h?"Anyone can see this post":"Only your followers can see this post"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Private"}),s.jsx(yt,{checked:h,onCheckedChange:m}),s.jsx("span",{className:"text-sm text-muted-foreground",children:"Public"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(P,{variant:"outline",onClick:w,className:"flex-1",children:"Change Photo"}),s.jsx(P,{onClick:y,disabled:p||!i.trim(),className:"flex-1 bg-gradient-primary text-white",children:p?s.jsxs(s.Fragment,{children:[s.jsx(ge,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating..."]}):"Share Post"})]})]})]}):s.jsxs("div",{className:"border-2 border-dashed border-muted-foreground/25 rounded-lg p-8 text-center",children:[s.jsx(lt,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:"Select a photo to share"}),s.jsxs(P,{onClick:()=>b.current?.click(),children:[s.jsx(Qe,{className:"w-4 h-4 mr-2"}),"Choose Photo"]}),s.jsx("input",{ref:b,type:"file",accept:"image/*",onChange:g,className:"hidden"})]})})]})})}),MS=F.memo(({open:t,onOpenChange:e})=>{const[r,a]=u.useState(null),[n,o]=u.useState(""),[i,l]=u.useState(!1),c=u.useRef(null),d=f=>{if(f.target.files&&f.target.files[0]){const b=f.target.files[0];a(b);const g=URL.createObjectURL(b);o(g)}},h=async()=>{if(r)try{l(!0);const f=r.type.startsWith("video/")?"video":"image",b={media:r,mediaType:f,duration:f==="video"?15:void 0},g=await Vi.createStory(b);if(g.success)ee({title:"Success",description:"Story uploaded successfully!"}),e(!1),m();else throw new Error(g.message||"Failed to upload story")}catch(f){console.error("Error uploading story:",f),ee({title:"Error",description:f.message||"Failed to upload story. Please try again.",variant:"destructive"})}finally{l(!1)}},m=()=>{a(null),o(""),c.current&&(c.current.value="")},p=()=>{e(!1),m()};return s.jsx(ut,{open:t,onOpenChange:p,children:s.jsxs(st,{className:"max-w-md",children:[s.jsx(rt,{children:s.jsx(at,{children:"Add to Your Story"})}),s.jsx("div",{className:"space-y-4",children:n?s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"aspect-square rounded-lg overflow-hidden bg-muted",children:s.jsx("img",{src:n,alt:"Story preview",className:"w-full h-full object-cover"})}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(P,{variant:"outline",onClick:m,className:"flex-1",children:"Change"}),s.jsx(P,{onClick:h,disabled:i,className:"flex-1 bg-gradient-primary text-white",children:i?s.jsxs(s.Fragment,{children:[s.jsx(ge,{className:"w-4 h-4 mr-2 animate-spin"}),"Uploading..."]}):"Share Story"})]})]}):s.jsxs("div",{className:"border-2 border-dashed border-muted-foreground/25 rounded-lg p-8 text-center",children:[s.jsx(lt,{className:"w-12 h-12 mx-auto mb-4 text-muted-foreground"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:"Select a photo or video to share"}),s.jsxs(P,{onClick:()=>c.current?.click(),children:[s.jsx(Qe,{className:"w-4 h-4 mr-2"}),"Choose File"]}),s.jsx("input",{ref:c,type:"file",accept:"image/*,video/*",onChange:d,className:"hidden"})]})})]})})}),LS=F.memo(()=>s.jsxs(Vo,{children:[s.jsx(Go,{asChild:!0,children:s.jsx(P,{variant:"ghost",size:"icon",children:s.jsx(up,{className:"w-4 h-4"})})}),s.jsxs(Xa,{align:"end",className:"w-56",children:[s.jsxs(Pt,{children:[s.jsx(Xr,{className:"w-4 h-4 mr-2"})," Share to..."]}),s.jsxs(Pt,{children:[s.jsx(Hc,{className:"w-4 h-4 mr-2"})," Copy link"]}),s.jsxs(Pt,{children:[s.jsx(za,{className:"w-4 h-4 mr-2"})," Save"]}),s.jsxs(Pt,{children:[s.jsx(hp,{className:"w-4 h-4 mr-2"})," Unfollow"]}),s.jsxs(Pt,{children:[s.jsx(mp,{className:"w-4 h-4 mr-2"})," Mute"]}),s.jsxs(Pt,{className:"text-destructive",children:[s.jsx(fp,{className:"w-4 h-4 mr-2"})," Report"]})]})]})),$S=F.memo(({commentsCount:t})=>{const[e,r]=u.useState(""),[a,n]=u.useState([]),[o,i]=u.useState(!1);u.useEffect(()=>{},[]);const l=async()=>{if(e.trim())try{i(!0),r("")}catch{ee({title:"Error",description:"Failed to add comment",variant:"destructive"})}finally{i(!1)}};return s.jsxs("div",{className:"p-4 pt-2 space-y-4",children:[a.length===0?s.jsx("p",{className:"text-muted-foreground text-sm",children:"No comments yet. Be the first to comment!"}):a.map(c=>s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsxs(Pe,{className:"w-8 h-8",children:[s.jsx(Ae,{src:c.avatar}),s.jsx(Re,{children:c.user[0]?.toUpperCase()})]}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"font-semibold text-sm",children:c.user}),s.jsx("span",{className:"text-muted-foreground text-xs",children:c.time})]}),s.jsx("p",{className:"text-sm",children:c.text})]})]},c.id)),s.jsxs("div",{className:"flex items-center space-x-2 mt-4",children:[s.jsx(se,{value:e,onChange:c=>r(c.target.value),placeholder:"Add a comment...",className:"flex-1"}),s.jsx(P,{onClick:l,disabled:!e.trim()||o,size:"sm",children:o?s.jsx(ge,{className:"w-4 h-4 animate-spin"}):s.jsx(pp,{className:"w-4 h-4"})})]})]})}),FS=()=>{const{isLoading:t}=mt(),{stories:e,posts:r,setStories:a,setPosts:n,shouldRefetchStories:o,shouldRefetchPosts:i}=x0(),[l,c]=u.useState(!1),[d,h]=u.useState(!1),[m,p]=u.useState(null),[f,b]=u.useState(null),[g,y]=u.useState(""),[w,v]=u.useState("feed"),[x,j]=u.useState(e),[N,S]=u.useState(r),[_,E]=u.useState(!1),[k,A]=u.useState(!1),B=u.useCallback(async()=>{if(N.length>0&&!i()){console.log("[Home] Using cached posts - no refetch needed");return}try{console.log("[Home] Fetching fresh posts from API..."),E(!0);const T=await As.getMyJourneys();if(T&&(T.success||T.data)){const U=T.data?.journeys||T.data||[],{supabase:X}=await we(async()=>{const{supabase:oe}=await Promise.resolve().then(()=>Jt);return{supabase:oe}},void 0,import.meta.url),{data:{session:de}}=await X.auth.getSession();let I=[];if(de?.user){const{data:oe}=await X.from("post_likes").select("post_id").eq("user_id",de.user.id).eq("post_type","journey");I=oe?.map(ce=>ce.post_id)||[]}const L=Array.isArray(U)?U.map(oe=>oe.id?.toString()||""):[];let D={};if(L.length>0){const{data:oe}=await X.from("post_likes").select("post_id").in("post_id",L).eq("post_type","journey");oe&&(D=oe.reduce((ce,ve)=>(ce[ve.post_id]=(ce[ve.post_id]||0)+1,ce),{}))}const ie=Array.isArray(U)?U.map(oe=>{const ce=oe.id?.toString()||"";return{id:parseInt(ce)||oe.id,user:oe.author?.name||oe.author?.firstName||"Anonymous",avatar:oe.author?.avatar||oe.author?.avatar_url||"/placeholder-avatar.jpg",location:oe.destinations?.[0]||"Unknown",time:oe.createdAt?new Date(oe.createdAt).toLocaleDateString():new Date().toLocaleDateString(),image:oe.images?.[0]||Yt,caption:oe.description||oe.content||"",likes:D[ce]||oe.likes||oe.likeCount||0,comments:oe.comments?.length||oe.commentCount||0,isLiked:I.includes(ce),isSaved:oe.isSaved||!1,hasMultipleImages:oe.images?.length>1,hasVideo:!1}}):[];S(ie)}else S([])}catch(T){console.error("Failed to fetch posts:",T),S([]),ee({title:"Error",description:"Failed to load posts. Please try again.",variant:"destructive"})}finally{E(!1)}},[ee]),$=u.useCallback(async()=>{if(x.length>0&&!o()){console.log("[Home] Using cached stories - no refetch needed");return}try{console.log("[Home] Fetching fresh stories from API..."),A(!0);const T=await Vi.getStories();if(T&&(T.success||T.data)){const U=T.data?.stories||T.data||[],X=Array.isArray(U)?U.map(L=>({id:L.id,user:L.isOwner?"Your Story":L.user?.firstName&&L.user?.lastName?`${L.user.firstName} ${L.user.lastName}`:L.user?.username||"Anonymous",avatar:L.user?.avatar||L.user?.avatar_url||"/placeholder-avatar.jpg",media:L.media||L.media_url||"",timestamp:L.createdAt||L.created_at,viewed:L.isViewed||!1,isOwn:L.isOwner||!1,hasStory:!0})):[],de=X.filter(L=>L.isOwn),I=X.filter(L=>!L.isOwn);if(de.length>0){const L=[{id:"user-stories",user:"Your Story",avatar:"",media:de[0].media,isOwn:!0,hasStory:!0},...I];j(L),a(L)}else{const L=[{id:"1",user:"Your Story",avatar:"",media:"",isOwn:!0},...I];j(L),a(L)}}else j([{id:"1",user:"Your Story",avatar:"",media:"",isOwn:!0}])}catch(T){console.error("Failed to fetch stories:",T),j([{id:"1",user:"Your Story",avatar:"",media:"",isOwn:!0}]),ee({title:"Error",description:"Failed to load stories. Please try again.",variant:"destructive"})}finally{A(!1)}},[ee]);u.useEffect(()=>{let T;if(t){console.log("[Home] Waiting for auth to initialize...");return}return console.log("[Home] Auth ready, fetching data..."),B(),$(),T=setTimeout(()=>{console.warn("Data loading timeout reached, forcing loading states to false"),E(!1),A(!1)},3e4),()=>{T&&clearTimeout(T)}},[t,B,$]);const H=u.useCallback(async T=>{try{const{supabase:U}=await we(async()=>{const{supabase:ie}=await Promise.resolve().then(()=>Jt);return{supabase:ie}},void 0,import.meta.url),{data:{session:X},error:de}=await U.auth.getSession();if(de||!X?.user){ee({title:"Error",description:"Please log in to like posts",variant:"destructive"});return}const I=N.find(ie=>ie.id===T);if(!I)return;const L=I.isLiked,D=T.toString();if(L){const{error:ie}=await U.from("post_likes").delete().eq("user_id",X.user.id).eq("post_id",D).eq("post_type","journey");if(ie)throw new Error(ie.message||"Failed to unlike post");S(oe=>oe.map(ce=>ce.id===T?{...ce,isLiked:!1,likes:Math.max(0,ce.likes-1)}:ce))}else{const{error:ie}=await U.from("post_likes").insert({user_id:X.user.id,post_id:D,post_type:"journey"});if(ie&&ie.code!=="23505")throw new Error(ie.message||"Failed to like post");S(oe=>oe.map(ce=>ce.id===T?{...ce,isLiked:!0,likes:ce.likes+1}:ce))}}catch(U){console.error("Error toggling like:",U),ee({title:"Error",description:U.message||"Failed to update like. Please try again.",variant:"destructive"})}},[N,ee]),O=u.useCallback(async T=>{const U=N.find(X=>X.id===T);U&&!U.isLiked&&await H(T)},[N,H]),Y=u.useCallback(T=>{S(U=>U.map(X=>X.id===T?{...X,isSaved:!X.isSaved}:X))},[]),z=u.useCallback(T=>{b(U=>U===T?null:T)},[]),R=u.useCallback(T=>{x[T]?.isOwn?h(!0):p(T)},[x]),M=u.useCallback(()=>p(null),[]),C=u.useCallback(()=>p(T=>T!==null&&T<x.length-1?T+1:null),[x.length]),q=u.useCallback(()=>p(T=>T!==null&&T>0?T-1:null),[]);return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-background to-muted/20 relative",children:[s.jsx("div",{className:"fixed bottom-20 right-4 z-50 lg:hidden",children:s.jsxs("div",{className:"flex flex-col gap-2",children:[s.jsx(P,{onClick:()=>c(!0),className:"h-12 w-12 rounded-full bg-gradient-to-r from-primary to-primary/80 shadow-lg hover:shadow-xl transition-all duration-300",children:s.jsx(Qe,{className:"w-6 h-6"})}),s.jsx(P,{onClick:()=>h(!0),variant:"outline",className:"h-10 w-10 rounded-full bg-background/90 backdrop-blur-sm border-border/50 shadow-md hover:shadow-lg transition-all duration-300",children:s.jsx(lt,{className:"w-4 h-4"})})]})}),s.jsx("div",{className:"flex-1 overflow-y-auto pt-16 lg:pt-6 pb-20 lg:pb-6",children:s.jsxs("div",{className:"w-full max-w-sm sm:max-w-md md:max-w-lg lg:max-w-xl xl:max-w-2xl mx-auto px-3 sm:px-4 md:px-6 py-2 md:py-3",children:[s.jsx("div",{className:"hidden lg:flex justify-end items-center mb-6 lg:mb-8",children:s.jsxs("div",{className:"flex gap-3",children:[s.jsxs(P,{onClick:()=>c(!0),className:"bg-gradient-to-r from-primary to-primary/80 hover:from-primary/90 hover:to-primary/70 shadow-md hover:shadow-lg transition-all duration-300",children:[s.jsx(Qe,{className:"w-4 h-4 mr-2"}),"Create Post"]}),s.jsxs(P,{onClick:()=>h(!0),variant:"outline",className:"border-primary/20 hover:bg-primary/5 shadow-sm hover:shadow-md transition-all duration-300",children:[s.jsx(lt,{className:"w-4 h-4 mr-2"}),"Add Story"]})]})}),s.jsx("div",{className:"mb-3 md:mb-4",children:s.jsxs("div",{className:"relative",children:[s.jsx(Wt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),s.jsx(se,{type:"text",placeholder:"Search...",className:"pl-10 bg-background/60 backdrop-blur-sm border-none rounded-xl h-10 md:h-11 shadow-sm focus:shadow-md transition-all duration-200",value:g,onChange:T=>y(T.target.value)})]})}),w==="feed"&&s.jsxs("div",{className:"space-y-4 lg:space-y-6",children:[k?s.jsx("div",{className:"flex gap-3 overflow-x-auto pb-4 scrollbar-hide",children:[...Array(5)].map((T,U)=>s.jsxs("div",{className:"flex flex-col items-center gap-1 sm:gap-2 min-w-fit",children:[s.jsx("div",{className:"w-14 h-14 sm:w-16 sm:h-16 lg:w-18 lg:h-18 rounded-full bg-gray-200 animate-pulse"}),s.jsx("div",{className:"w-12 h-3 bg-gray-200 rounded animate-pulse"})]},U))}):s.jsx("div",{className:"flex gap-3 overflow-x-auto pb-4 scrollbar-hide",children:x.map((T,U)=>s.jsxs("div",{className:"flex flex-col items-center gap-1 sm:gap-2 min-w-fit cursor-pointer",onClick:()=>R(U),children:[s.jsx("div",{className:`p-[2px] rounded-full ${T.isOwn?"":"bg-gradient-to-tr from-yellow-400 to-purple-600"}`,children:s.jsxs(Pe,{className:"w-14 h-14 sm:w-16 sm:h-16 lg:w-18 lg:h-18 shadow-md",children:[s.jsx(Ae,{src:T.avatar}),s.jsx(Re,{className:"text-xs sm:text-sm",children:T.user.charAt(0)})]})}),s.jsx("span",{className:"text-xs sm:text-sm font-medium text-center max-w-16 truncate",children:T.isOwn?"Your Story":T.user})]},T.id))}),s.jsxs("div",{className:"my-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h2",{className:"text-lg font-semibold",children:"Travel Clubs"}),s.jsx(Hc,{to:"/clubs",className:"text-sm text-primary hover:underline",children:"See all"})]}),s.jsx("div",{className:"flex gap-3 overflow-x-auto pb-2 scrollbar-hide",children:[1,2,3,4].map(T=>s.jsxs(V,{className:"min-w-[140px] sm:min-w-[160px] flex-shrink-0 overflow-hidden shadow-sm hover:shadow-md transition-shadow cursor-pointer",children:[s.jsxs("div",{className:"aspect-video bg-gradient-to-br from-primary/10 to-primary/5 p-3 flex flex-col justify-end",children:[s.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/20 mb-2"}),s.jsx("div",{className:"h-4 bg-primary/20 rounded w-3/4"})]}),s.jsx(G,{className:"p-2",children:s.jsx("p",{className:"text-xs text-muted-foreground",children:"Tap to explore clubs"})})]},T))})]}),_?[...Array(3)].map((T,U)=>s.jsxs(V,{className:"overflow-hidden shadow-sm hover:shadow-md transition-shadow",children:[s.jsx(G,{className:"p-3 sm:p-4 flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[s.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-full bg-gray-200 animate-pulse"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("div",{className:"w-24 h-4 bg-gray-200 rounded animate-pulse mb-1"}),s.jsx("div",{className:"w-32 h-3 bg-gray-200 rounded animate-pulse"})]})]})}),s.jsx("div",{className:"aspect-square bg-gray-200 animate-pulse"}),s.jsx(G,{className:"p-3 sm:p-4",children:s.jsx("div",{className:"w-3/4 h-4 bg-gray-200 rounded animate-pulse"})})]},U)):N.length===0?s.jsx(V,{className:"overflow-hidden shadow-sm",children:s.jsxs(G,{className:"p-8 text-center",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-muted flex items-center justify-center",children:s.jsx(lt,{className:"w-8 h-8 text-muted-foreground"})}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No posts yet"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:"Start following travelers or create your first post to see content here."}),s.jsxs(P,{onClick:()=>c(!0),className:"bg-gradient-to-r from-primary to-primary/80",children:[s.jsx(Qe,{className:"w-4 h-4 mr-2"}),"Create Post"]})]})}):N.map(T=>s.jsx(V,{className:"overflow-hidden shadow-md hover:shadow-xl transition-all duration-300 rounded-xl border-0",children:s.jsxs("div",{id:`post-${T.id}`,className:"relative",children:[s.jsxs(G,{className:"p-4 sm:p-5 flex items-center justify-between bg-white",children:[s.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[s.jsxs(Pe,{className:"w-10 h-10 sm:w-12 sm:h-12 ring-2 ring-offset-2 ring-primary/20",children:[s.jsx(Ae,{src:T.avatar}),s.jsx(Re,{className:"text-sm font-semibold",children:T.user.charAt(0)})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-semibold text-sm sm:text-base truncate",children:T.user}),s.jsxs("p",{className:"text-xs sm:text-sm text-muted-foreground truncate flex items-center gap-1",children:[s.jsx(Ie,{className:"w-3 h-3"}),T.location]})]})]}),s.jsx(LS,{})]}),s.jsx("div",{className:"aspect-square bg-muted relative overflow-hidden",onDoubleClick:()=>O(T.id),children:s.jsx("img",{src:T.image,alt:"Post",className:"w-full h-full object-cover transition-transform duration-300 hover:scale-105",onError:U=>IS(U,Yt,"Post image failed to load")})}),s.jsxs(G,{className:"p-4 sm:p-5 bg-white",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{className:"flex items-center gap-4 sm:gap-5",children:[s.jsx(P,{variant:"ghost",size:"icon",className:"h-9 w-9 sm:h-10 sm:w-10 hover:bg-red-50 transition-colors",onClick:()=>H(T.id),children:s.jsx(Ht,{className:`w-5 h-5 sm:w-6 sm:h-6 transition-all ${T.isLiked?"text-red-500 fill-current scale-110":"text-gray-700"}`})}),s.jsx(P,{variant:"ghost",size:"icon",className:"h-9 w-9 sm:h-10 sm:w-10 hover:bg-blue-50 transition-colors",onClick:()=>z(T.id),children:s.jsx(us,{className:"w-5 h-5 sm:w-6 sm:h-6 text-gray-700"})}),s.jsx(P,{variant:"ghost",size:"icon",className:"h-9 w-9 sm:h-10 sm:w-10 hover:bg-green-50 transition-colors",onClick:async()=>{try{const U=`${window.location.origin}/post/${T.id}`;navigator.share?await navigator.share({title:`${T.user}'s Post`,text:T.caption,url:U}):(await navigator.clipboard.writeText(U),ee({title:"Link copied!",description:"Post link copied to clipboard"}))}catch(U){if(U.name!=="AbortError"){console.error("Share error:",U);try{const X=`${window.location.origin}/post/${T.id}`;await navigator.clipboard.writeText(X),ee({title:"Link copied!",description:"Post link copied to clipboard"})}catch{ee({title:"Error",description:"Failed to share post",variant:"destructive"})}}}},children:s.jsx(Xr,{className:"w-5 h-5 sm:w-6 sm:h-6 text-gray-700"})})]}),s.jsx(P,{variant:"ghost",size:"icon",className:"h-9 w-9 sm:h-10 sm:w-10 hover:bg-blue-50 transition-colors",onClick:()=>Y(T.id),children:s.jsx(za,{className:`w-5 h-5 sm:w-6 sm:h-6 transition-all ${T.isSaved?"text-blue-500 fill-current":"text-gray-700"}`})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("p",{className:"font-semibold text-sm sm:text-base",children:[T.likes.toLocaleString()," likes"]}),s.jsxs("p",{className:"text-sm sm:text-base leading-relaxed",children:[s.jsx("span",{className:"font-semibold mr-2",children:T.user}),s.jsx("span",{className:"text-gray-800",children:T.caption})]}),T.comments>0&&s.jsxs("button",{className:"text-sm text-muted-foreground hover:text-foreground transition-colors font-medium",onClick:()=>z(T.id),children:["View all ",T.comments," ",T.comments===1?"comment":"comments"]}),s.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wide",children:T.time})]}),f===T.id&&s.jsx($S,{commentsCount:T.comments})]})]})},T.id))]}),w==="explore"&&s.jsx("div",{className:"grid grid-cols-3 gap-1",children:N.map(T=>s.jsxs("div",{className:"aspect-square bg-muted relative group",children:[s.jsx("img",{src:T.image,alt:"Explore post",className:"w-full h-full object-cover"}),s.jsxs("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/40 transition-all flex items-center justify-center text-white opacity-0 group-hover:opacity-100",children:[s.jsx(Ht,{className:"w-5 h-5 mr-1"})," ",T.likes]})]},T.id))})]})}),s.jsx(DS,{story:m!==null?x[m]:null,onClose:M,onNext:C,onPrev:q}),s.jsx(MS,{open:d,onOpenChange:h}),s.jsx(OS,{open:l,onOpenChange:c})]})};var US="Label",Hm=u.forwardRef((t,e)=>s.jsx(ne.label,{...t,ref:e,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(t.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));Hm.displayName=US;var Vm=Hm;const BS=ra("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),J=u.forwardRef(({className:t,...e},r)=>s.jsx(Vm,{ref:r,className:Z(BS(),t),...e}));J.displayName=Vm.displayName;function Ac(t,[e,r]){return Math.min(r,Math.max(e,t))}var zS=[" ","Enter","ArrowUp","ArrowDown"],qS=[" ","Enter"],Os="Select",[An,Rn,WS]=cn(Os),[Nr,ZC]=Xe(Os,[WS,br]),In=br(),[HS,vs]=Nr(Os),[VS,GS]=Nr(Os),Gm=t=>{const{__scopeSelect:e,children:r,open:a,defaultOpen:n,onOpenChange:o,value:i,defaultValue:l,onValueChange:c,dir:d,name:h,autoComplete:m,disabled:p,required:f,form:b}=t,g=In(e),[y,w]=u.useState(null),[v,x]=u.useState(null),[j,N]=u.useState(!1),S=wn(d),[_,E]=Vt({prop:a,defaultProp:n??!1,onChange:o,caller:Os}),[k,A]=Vt({prop:i,defaultProp:l,onChange:c,caller:Os}),B=u.useRef(null),$=y?b||!!y.closest("form"):!0,[H,O]=u.useState(new Set),Y=Array.from(H).map(z=>z.props.value).join(";");return s.jsx(su,{...g,children:s.jsxs(HS,{required:f,scope:e,trigger:y,onTriggerChange:w,valueNode:v,onValueNodeChange:x,valueNodeHasChildren:j,onValueNodeHasChildrenChange:N,contentId:Dt(),value:k,onValueChange:A,open:_,onOpenChange:E,dir:S,triggerPointerDownPosRef:B,disabled:p,children:[s.jsx(An.Provider,{scope:e,children:s.jsx(VS,{scope:t.__scopeSelect,onNativeOptionAdd:u.useCallback(z=>{O(R=>new Set(R).add(z))},[]),onNativeOptionRemove:u.useCallback(z=>{O(R=>{const M=new Set(R);return M.delete(z),M})},[]),children:r})}),$?s.jsxs(vf,{"aria-hidden":!0,required:f,tabIndex:-1,name:h,autoComplete:m,value:k,onChange:z=>A(z.target.value),disabled:p,form:b,children:[k===void 0?s.jsx("option",{value:""}):null,Array.from(H)]},Y):null]})})};Gm.displayName=Os;var Km="SelectTrigger",Jm=u.forwardRef((t,e)=>{const{__scopeSelect:r,disabled:a=!1,...n}=t,o=In(r),i=vs(Km,r),l=i.disabled||a,c=xe(e,i.onTriggerChange),d=Rn(r),h=u.useRef("touch"),[m,p,f]=wf(g=>{const y=d().filter(x=>!x.disabled),w=y.find(x=>x.value===i.value),v=bf(y,g,w);v!==void 0&&i.onValueChange(v.value)}),b=g=>{l||(i.onOpenChange(!0),f()),g&&(i.triggerPointerDownPosRef.current={x:Math.round(g.pageX),y:Math.round(g.pageY)})};return s.jsx(wi,{asChild:!0,...o,children:s.jsx(ne.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":yf(i.value)?"":void 0,...n,ref:c,onClick:W(n.onClick,g=>{g.currentTarget.focus(),h.current!=="mouse"&&b(g)}),onPointerDown:W(n.onPointerDown,g=>{h.current=g.pointerType;const y=g.target;y.hasPointerCapture(g.pointerId)&&y.releasePointerCapture(g.pointerId),g.button===0&&g.ctrlKey===!1&&g.pointerType==="mouse"&&(b(g),g.preventDefault())}),onKeyDown:W(n.onKeyDown,g=>{const y=m.current!=="";!(g.ctrlKey||g.altKey||g.metaKey)&&g.key.length===1&&p(g.key),!(y&&g.key===" ")&&zS.includes(g.key)&&(b(),g.preventDefault())})})})});Jm.displayName=Km;var Ym="SelectValue",Qm=u.forwardRef((t,e)=>{const{__scopeSelect:r,className:a,style:n,children:o,placeholder:i="",...l}=t,c=vs(Ym,r),{onValueNodeHasChildrenChange:d}=c,h=o!==void 0,m=xe(e,c.onValueNodeChange);return De(()=>{d(h)},[d,h]),s.jsx(ne.span,{...l,ref:m,style:{pointerEvents:"none"},children:yf(c.value)?s.jsx(s.Fragment,{children:i}):o})});Qm.displayName=Ym;var KS="SelectIcon",Xm=u.forwardRef((t,e)=>{const{__scopeSelect:r,children:a,...n}=t;return s.jsx(ne.span,{"aria-hidden":!0,...n,ref:e,children:a||""})});Xm.displayName=KS;var JS="SelectPortal",Zm=t=>s.jsx(ta,{asChild:!0,...t});Zm.displayName=JS;var Ms="SelectContent",ef=u.forwardRef((t,e)=>{const r=vs(Ms,t.__scopeSelect),[a,n]=u.useState();if(De(()=>{n(new DocumentFragment)},[]),!r.open){const o=a;return o?Zr.createPortal(s.jsx(tf,{scope:t.__scopeSelect,children:s.jsx(An.Slot,{scope:t.__scopeSelect,children:s.jsx("div",{children:t.children})})}),o):null}return s.jsx(sf,{...t,ref:e})});ef.displayName=Ms;var wt=10,[tf,ys]=Nr(Ms),YS="SelectContentImpl",QS=Rs("SelectContent.RemoveScroll"),sf=u.forwardRef((t,e)=>{const{__scopeSelect:r,position:a="item-aligned",onCloseAutoFocus:n,onEscapeKeyDown:o,onPointerDownOutside:i,side:l,sideOffset:c,align:d,alignOffset:h,arrowPadding:m,collisionBoundary:p,collisionPadding:f,sticky:b,hideWhenDetached:g,avoidCollisions:y,...w}=t,v=vs(Ms,r),[x,j]=u.useState(null),[N,S]=u.useState(null),_=xe(e,D=>j(D)),[E,k]=u.useState(null),[A,B]=u.useState(null),$=Rn(r),[H,O]=u.useState(!1),Y=u.useRef(!1);u.useEffect(()=>{if(x)return Ii(x)},[x]),Ri();const z=u.useCallback(D=>{const[ie,...oe]=$().map(ke=>ke.ref.current),[ce]=oe.slice(-1),ve=document.activeElement;for(const ke of D)if(ke===ve||(ke?.scrollIntoView({block:"nearest"}),ke===ie&&N&&(N.scrollTop=0),ke===ce&&N&&(N.scrollTop=N.scrollHeight),ke?.focus(),document.activeElement!==ve))return},[$,N]),R=u.useCallback(()=>z([E,x]),[z,E,x]);u.useEffect(()=>{H&&R()},[H,R]);const{onOpenChange:M,triggerPointerDownPosRef:C}=v;u.useEffect(()=>{if(x){let D={x:0,y:0};const ie=ce=>{D={x:Math.abs(Math.round(ce.pageX)-(C.current?.x??0)),y:Math.abs(Math.round(ce.pageY)-(C.current?.y??0))}},oe=ce=>{D.x<=10&&D.y<=10?ce.preventDefault():x.contains(ce.target)||M(!1),document.removeEventListener("pointermove",ie),C.current=null};return C.current!==null&&(document.addEventListener("pointermove",ie),document.addEventListener("pointerup",oe,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ie),document.removeEventListener("pointerup",oe,{capture:!0})}}},[x,M,C]),u.useEffect(()=>{const D=()=>M(!1);return window.addEventListener("blur",D),window.addEventListener("resize",D),()=>{window.removeEventListener("blur",D),window.removeEventListener("resize",D)}},[M]);const[q,T]=wf(D=>{const ie=$().filter(ve=>!ve.disabled),oe=ie.find(ve=>ve.ref.current===document.activeElement),ce=bf(ie,D,oe);ce&&setTimeout(()=>ce.ref.current.focus())}),U=u.useCallback((D,ie,oe)=>{const ce=!Y.current&&!oe;(v.value!==void 0&&v.value===ie||ce)&&(k(D),ce&&(Y.current=!0))},[v.value]),X=u.useCallback(()=>x?.focus(),[x]),de=u.useCallback((D,ie,oe)=>{const ce=!Y.current&&!oe;(v.value!==void 0&&v.value===ie||ce)&&B(D)},[v.value]),I=a==="popper"?Jo:rf,L=I===Jo?{side:l,sideOffset:c,align:d,alignOffset:h,arrowPadding:m,collisionBoundary:p,collisionPadding:f,sticky:b,hideWhenDetached:g,avoidCollisions:y}:{};return s.jsx(tf,{scope:r,content:x,viewport:N,onViewportChange:S,itemRefCallback:U,selectedItem:E,onItemLeave:X,itemTextRefCallback:de,focusSelectedItem:R,selectedItemText:A,position:a,isPositioned:H,searchRef:q,children:s.jsx(Sn,{as:QS,allowPinchZoom:!0,children:s.jsx(bn,{asChild:!0,trapped:v.open,onMountAutoFocus:D=>{D.preventDefault()},onUnmountAutoFocus:W(n,D=>{v.trigger?.focus({preventScroll:!0}),D.preventDefault()}),children:s.jsx(xr,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:i,onFocusOutside:D=>D.preventDefault(),onDismiss:()=>v.onOpenChange(!1),children:s.jsx(I,{role:"listbox",id:v.contentId,"data-state":v.open?"open":"closed",dir:v.dir,onContextMenu:D=>D.preventDefault(),...w,...L,onPlaced:()=>O(!0),ref:_,style:{display:"flex",flexDirection:"column",outline:"none",...w.style},onKeyDown:W(w.onKeyDown,D=>{const ie=D.ctrlKey||D.altKey||D.metaKey;if(D.key==="Tab"&&D.preventDefault(),!ie&&D.key.length===1&&T(D.key),["ArrowUp","ArrowDown","Home","End"].includes(D.key)){let ce=$().filter(ve=>!ve.disabled).map(ve=>ve.ref.current);if(["ArrowUp","End"].includes(D.key)&&(ce=ce.slice().reverse()),["ArrowUp","ArrowDown"].includes(D.key)){const ve=D.target,ke=ce.indexOf(ve);ce=ce.slice(ke+1)}setTimeout(()=>z(ce)),D.preventDefault()}})})})})})})});sf.displayName=YS;var XS="SelectItemAlignedPosition",rf=u.forwardRef((t,e)=>{const{__scopeSelect:r,onPlaced:a,...n}=t,o=vs(Ms,r),i=ys(Ms,r),[l,c]=u.useState(null),[d,h]=u.useState(null),m=xe(e,_=>h(_)),p=Rn(r),f=u.useRef(!1),b=u.useRef(!0),{viewport:g,selectedItem:y,selectedItemText:w,focusSelectedItem:v}=i,x=u.useCallback(()=>{if(o.trigger&&o.valueNode&&l&&d&&g&&y&&w){const _=o.trigger.getBoundingClientRect(),E=d.getBoundingClientRect(),k=o.valueNode.getBoundingClientRect(),A=w.getBoundingClientRect();if(o.dir!=="rtl"){const ve=A.left-E.left,ke=k.left-ve,qe=_.left-ke,Ft=_.width+qe,Sr=Math.max(Ft,E.width),Bs=window.innerWidth-wt,_r=Ac(ke,[wt,Math.max(wt,Bs-Sr)]);l.style.minWidth=Ft+"px",l.style.left=_r+"px"}else{const ve=E.right-A.right,ke=window.innerWidth-k.right-ve,qe=window.innerWidth-_.right-ke,Ft=_.width+qe,Sr=Math.max(Ft,E.width),Bs=window.innerWidth-wt,_r=Ac(ke,[wt,Math.max(wt,Bs-Sr)]);l.style.minWidth=Ft+"px",l.style.right=_r+"px"}const B=p(),$=window.innerHeight-wt*2,H=g.scrollHeight,O=window.getComputedStyle(d),Y=parseInt(O.borderTopWidth,10),z=parseInt(O.paddingTop,10),R=parseInt(O.borderBottomWidth,10),M=parseInt(O.paddingBottom,10),C=Y+z+H+M+R,q=Math.min(y.offsetHeight*5,C),T=window.getComputedStyle(g),U=parseInt(T.paddingTop,10),X=parseInt(T.paddingBottom,10),de=_.top+_.height/2-wt,I=$-de,L=y.offsetHeight/2,D=y.offsetTop+L,ie=Y+z+D,oe=C-ie;if(ie<=de){const ve=B.length>0&&y===B[B.length-1].ref.current;l.style.bottom="0px";const ke=d.clientHeight-g.offsetTop-g.offsetHeight,qe=Math.max(I,L+(ve?X:0)+ke+R),Ft=ie+qe;l.style.height=Ft+"px"}else{const ve=B.length>0&&y===B[0].ref.current;l.style.top="0px";const qe=Math.max(de,Y+g.offsetTop+(ve?U:0)+L)+oe;l.style.height=qe+"px",g.scrollTop=ie-de+g.offsetTop}l.style.margin=`${wt}px 0`,l.style.minHeight=q+"px",l.style.maxHeight=$+"px",a?.(),requestAnimationFrame(()=>f.current=!0)}},[p,o.trigger,o.valueNode,l,d,g,y,w,o.dir,a]);De(()=>x(),[x]);const[j,N]=u.useState();De(()=>{d&&N(window.getComputedStyle(d).zIndex)},[d]);const S=u.useCallback(_=>{_&&b.current===!0&&(x(),v?.(),b.current=!1)},[x,v]);return s.jsx(e_,{scope:r,contentWrapper:l,shouldExpandOnScrollRef:f,onScrollButtonChange:S,children:s.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:j},children:s.jsx(ne.div,{...n,ref:m,style:{boxSizing:"border-box",maxHeight:"100%",...n.style}})})})});rf.displayName=XS;var ZS="SelectPopperPosition",Jo=u.forwardRef((t,e)=>{const{__scopeSelect:r,align:a="start",collisionPadding:n=wt,...o}=t,i=In(r);return s.jsx(bi,{...i,...o,ref:e,align:a,collisionPadding:n,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Jo.displayName=ZS;var[e_,Gi]=Nr(Ms,{}),Yo="SelectViewport",af=u.forwardRef((t,e)=>{const{__scopeSelect:r,nonce:a,...n}=t,o=ys(Yo,r),i=Gi(Yo,r),l=xe(e,o.onViewportChange),c=u.useRef(0);return s.jsxs(s.Fragment,{children:[s.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),s.jsx(An.Slot,{scope:r,children:s.jsx(ne.div,{"data-radix-select-viewport":"",role:"presentation",...n,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...n.style},onScroll:W(n.onScroll,d=>{const h=d.currentTarget,{contentWrapper:m,shouldExpandOnScrollRef:p}=i;if(p?.current&&m){const f=Math.abs(c.current-h.scrollTop);if(f>0){const b=window.innerHeight-wt*2,g=parseFloat(m.style.minHeight),y=parseFloat(m.style.height),w=Math.max(g,y);if(w<b){const v=w+f,x=Math.min(b,v),j=v-x;m.style.height=x+"px",m.style.bottom==="0px"&&(h.scrollTop=j>0?j:0,m.style.justifyContent="flex-end")}}}c.current=h.scrollTop})})})]})});af.displayName=Yo;var nf="SelectGroup",[t_,s_]=Nr(nf),r_=u.forwardRef((t,e)=>{const{__scopeSelect:r,...a}=t,n=Dt();return s.jsx(t_,{scope:r,id:n,children:s.jsx(ne.div,{role:"group","aria-labelledby":n,...a,ref:e})})});r_.displayName=nf;var of="SelectLabel",lf=u.forwardRef((t,e)=>{const{__scopeSelect:r,...a}=t,n=s_(of,r);return s.jsx(ne.div,{id:n.id,...a,ref:e})});lf.displayName=of;var en="SelectItem",[a_,cf]=Nr(en),df=u.forwardRef((t,e)=>{const{__scopeSelect:r,value:a,disabled:n=!1,textValue:o,...i}=t,l=vs(en,r),c=ys(en,r),d=l.value===a,[h,m]=u.useState(o??""),[p,f]=u.useState(!1),b=xe(e,v=>c.itemRefCallback?.(v,a,n)),g=Dt(),y=u.useRef("touch"),w=()=>{n||(l.onValueChange(a),l.onOpenChange(!1))};if(a==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return s.jsx(a_,{scope:r,value:a,disabled:n,textId:g,isSelected:d,onItemTextChange:u.useCallback(v=>{m(x=>x||(v?.textContent??"").trim())},[]),children:s.jsx(An.ItemSlot,{scope:r,value:a,disabled:n,textValue:h,children:s.jsx(ne.div,{role:"option","aria-labelledby":g,"data-highlighted":p?"":void 0,"aria-selected":d&&p,"data-state":d?"checked":"unchecked","aria-disabled":n||void 0,"data-disabled":n?"":void 0,tabIndex:n?void 0:-1,...i,ref:b,onFocus:W(i.onFocus,()=>f(!0)),onBlur:W(i.onBlur,()=>f(!1)),onClick:W(i.onClick,()=>{y.current!=="mouse"&&w()}),onPointerUp:W(i.onPointerUp,()=>{y.current==="mouse"&&w()}),onPointerDown:W(i.onPointerDown,v=>{y.current=v.pointerType}),onPointerMove:W(i.onPointerMove,v=>{y.current=v.pointerType,n?c.onItemLeave?.():y.current==="mouse"&&v.currentTarget.focus({preventScroll:!0})}),onPointerLeave:W(i.onPointerLeave,v=>{v.currentTarget===document.activeElement&&c.onItemLeave?.()}),onKeyDown:W(i.onKeyDown,v=>{c.searchRef?.current!==""&&v.key===" "||(qS.includes(v.key)&&w(),v.key===" "&&v.preventDefault())})})})})});df.displayName=en;var Ir="SelectItemText",uf=u.forwardRef((t,e)=>{const{__scopeSelect:r,className:a,style:n,...o}=t,i=vs(Ir,r),l=ys(Ir,r),c=cf(Ir,r),d=GS(Ir,r),[h,m]=u.useState(null),p=xe(e,w=>m(w),c.onItemTextChange,w=>l.itemTextRefCallback?.(w,c.value,c.disabled)),f=h?.textContent,b=u.useMemo(()=>s.jsx("option",{value:c.value,disabled:c.disabled,children:f},c.value),[c.disabled,c.value,f]),{onNativeOptionAdd:g,onNativeOptionRemove:y}=d;return De(()=>(g(b),()=>y(b)),[g,y,b]),s.jsxs(s.Fragment,{children:[s.jsx(ne.span,{id:c.textId,...o,ref:p}),c.isSelected&&i.valueNode&&!i.valueNodeHasChildren?Zr.createPortal(o.children,i.valueNode):null]})});uf.displayName=Ir;var hf="SelectItemIndicator",mf=u.forwardRef((t,e)=>{const{__scopeSelect:r,...a}=t;return cf(hf,r).isSelected?s.jsx(ne.span,{"aria-hidden":!0,...a,ref:e}):null});mf.displayName=hf;var Qo="SelectScrollUpButton",ff=u.forwardRef((t,e)=>{const r=ys(Qo,t.__scopeSelect),a=Gi(Qo,t.__scopeSelect),[n,o]=u.useState(!1),i=xe(e,a.onScrollButtonChange);return De(()=>{if(r.viewport&&r.isPositioned){let l=function(){const d=c.scrollTop>0;o(d)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),n?s.jsx(gf,{...t,ref:i,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}}):null});ff.displayName=Qo;var Xo="SelectScrollDownButton",pf=u.forwardRef((t,e)=>{const r=ys(Xo,t.__scopeSelect),a=Gi(Xo,t.__scopeSelect),[n,o]=u.useState(!1),i=xe(e,a.onScrollButtonChange);return De(()=>{if(r.viewport&&r.isPositioned){let l=function(){const d=c.scrollHeight-c.clientHeight,h=Math.ceil(c.scrollTop)<d;o(h)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),n?s.jsx(gf,{...t,ref:i,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}}):null});pf.displayName=Xo;var gf=u.forwardRef((t,e)=>{const{__scopeSelect:r,onAutoScroll:a,...n}=t,o=ys("SelectScrollButton",r),i=u.useRef(null),l=Rn(r),c=u.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return u.useEffect(()=>()=>c(),[c]),De(()=>{l().find(h=>h.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[l]),s.jsx(ne.div,{"aria-hidden":!0,...n,ref:e,style:{flexShrink:0,...n.style},onPointerDown:W(n.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(a,50))}),onPointerMove:W(n.onPointerMove,()=>{o.onItemLeave?.(),i.current===null&&(i.current=window.setInterval(a,50))}),onPointerLeave:W(n.onPointerLeave,()=>{c()})})}),n_="SelectSeparator",xf=u.forwardRef((t,e)=>{const{__scopeSelect:r,...a}=t;return s.jsx(ne.div,{"aria-hidden":!0,...a,ref:e})});xf.displayName=n_;var Zo="SelectArrow",o_=u.forwardRef((t,e)=>{const{__scopeSelect:r,...a}=t,n=In(r),o=vs(Zo,r),i=ys(Zo,r);return o.open&&i.position==="popper"?s.jsx(ji,{...n,...a,ref:e}):null});o_.displayName=Zo;var i_="SelectBubbleInput",vf=u.forwardRef(({__scopeSelect:t,value:e,...r},a)=>{const n=u.useRef(null),o=xe(a,n),i=Hi(e);return u.useEffect(()=>{const l=n.current;if(!l)return;const c=window.HTMLSelectElement.prototype,h=Object.getOwnPropertyDescriptor(c,"value").set;if(i!==e&&h){const m=new Event("change",{bubbles:!0});h.call(l,e),l.dispatchEvent(m)}},[i,e]),s.jsx(ne.select,{...r,style:{...sd,...r.style},ref:o,defaultValue:e})});vf.displayName=i_;function yf(t){return t===""||t===void 0}function wf(t){const e=Ke(t),r=u.useRef(""),a=u.useRef(0),n=u.useCallback(i=>{const l=r.current+i;e(l),(function c(d){r.current=d,window.clearTimeout(a.current),d!==""&&(a.current=window.setTimeout(()=>c(""),1e3))})(l)},[e]),o=u.useCallback(()=>{r.current="",window.clearTimeout(a.current)},[]);return u.useEffect(()=>()=>window.clearTimeout(a.current),[]),[r,n,o]}function bf(t,e,r){const n=e.length>1&&Array.from(e).every(d=>d===e[0])?e[0]:e,o=r?t.indexOf(r):-1;let i=l_(t,Math.max(o,0));n.length===1&&(i=i.filter(d=>d!==r));const c=i.find(d=>d.textValue.toLowerCase().startsWith(n.toLowerCase()));return c!==r?c:void 0}function l_(t,e){return t.map((r,a)=>t[(e+a)%t.length])}var c_=Gm,jf=Jm,d_=Qm,u_=Xm,h_=Zm,Nf=ef,m_=af,Sf=lf,_f=df,f_=uf,p_=mf,Cf=ff,Ef=pf,kf=xf;const fs=c_,ps=d_,Qt=u.forwardRef(({className:t,children:e,...r},a)=>s.jsxs(jf,{ref:a,className:Z("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...r,children:[e,s.jsx(u_,{asChild:!0,children:s.jsx(si,{className:"h-4 w-4 opacity-50"})})]}));Qt.displayName=jf.displayName;const Tf=u.forwardRef(({className:t,...e},r)=>s.jsx(Cf,{ref:r,className:Z("flex cursor-default items-center justify-center py-1",t),...e,children:s.jsx(Vc,{className:"h-4 w-4"})}));Tf.displayName=Cf.displayName;const Pf=u.forwardRef(({className:t,...e},r)=>s.jsx(Ef,{ref:r,className:Z("flex cursor-default items-center justify-center py-1",t),...e,children:s.jsx(si,{className:"h-4 w-4"})}));Pf.displayName=Ef.displayName;const Xt=u.forwardRef(({className:t,children:e,position:r="popper",...a},n)=>s.jsx(h_,{children:s.jsxs(Nf,{ref:n,className:Z("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...a,children:[s.jsx(Tf,{}),s.jsx(m_,{className:Z("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),s.jsx(Pf,{})]})}));Xt.displayName=Nf.displayName;const g_=u.forwardRef(({className:t,...e},r)=>s.jsx(Sf,{ref:r,className:Z("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...e}));g_.displayName=Sf.displayName;const ae=u.forwardRef(({className:t,children:e,...r},a)=>s.jsxs(_f,{ref:a,className:Z("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[s.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:s.jsx(p_,{children:s.jsx(Yr,{className:"h-4 w-4"})})}),s.jsx(f_,{children:e})]}));ae.displayName=_f.displayName;const x_=u.forwardRef(({className:t,...e},r)=>s.jsx(kf,{ref:r,className:Z("-mx-1 my-1 h-px bg-muted",t),...e}));x_.displayName=kf.displayName;class v_{async getClubs(e={}){const r=new URLSearchParams;Object.entries(e).forEach(([i,l])=>{l!=null&&r.append(i,l.toString())});const a=r.toString(),n=a?`${K(re.clubs.list)}?${a}`:K(re.clubs.list),o=`${Ps.clubs()}_${a}`;return await cs(n,o,{ttl:It.MEDIUM,method:"GET",headers:fe()})}async getClubById(e){const r=await cs(K(re.clubs.detail(e)),Ps.clubDetail(e),{ttl:It.MEDIUM,method:"GET",headers:fe()});if(r.success&&r.data)return r.data;throw new Error(r.message||"Failed to get club details")}async createClub(e){const r=await te(K(re.clubs.create),{method:"POST",headers:fe(),body:e});if(r.success&&r.data)return r.data;throw new Error(r.message||"Failed to create club")}async updateClub(e){const r=await te(K(re.clubs.update(e.id)),{method:"PUT",headers:fe(),body:e});if(r.success&&r.data)return r.data;throw new Error(r.message||"Failed to update club")}async deleteClub(e){const r=await te(K(re.clubs.delete(e)),{method:"DELETE",headers:fe()});if(!r.success)throw new Error(r.message||"Failed to delete club")}async joinClub(e){const r=await te(K(re.clubs.join(e)),{method:"POST",headers:fe()});if(!r.success)throw new Error(r.message||"Failed to join club")}async leaveClub(e){const r=await te(K(re.clubs.leave(e)),{method:"POST",headers:fe()});if(!r.success)throw new Error(r.message||"Failed to leave club")}async getClubMembers(e){const r=await te(K(re.clubs.members(e)),{method:"GET",headers:fe()});if(r.success&&r.data)return r.data;throw new Error(r.message||"Failed to get club members")}async getClubPosts(e){const r=await te(K(re.clubs.posts(e)),{method:"GET",headers:fe()});if(r.success&&r.data)return r.data;throw new Error(r.message||"Failed to get club posts")}async searchClubs(e){return this.getClubs(e)}}const qt=new v_,Dn=(t,e=Yt,r="Failed to load image, using fallback")=>{console.error(r),t.currentTarget.src=e},Jr=""+new URL("mountain-adventure-Qk5WLsdY.jpg",import.meta.url).href,y_=()=>{const[t,e]=u.useState([]),[r,a]=u.useState(!0),[n,o]=u.useState(null),[i,l]=u.useState(""),[c,d]=u.useState(""),[h,m]=u.useState("popular"),[p,f]=u.useState(!1),[b,g]=u.useState(!1),[y,w]=u.useState({name:"",description:"",category:"",country:"",state:""}),{toast:v}=Ct();u.useEffect(()=>{(async()=>{try{a(!0),o(null);const k=await qt.getClubs();k.success&&Array.isArray(k.data)?e(k.data):e([])}catch(k){o("Failed to load clubs"),console.error("Error fetching clubs:",k),e([]),v({title:"Error",description:"Failed to load clubs. Please try again.",variant:"destructive"})}finally{a(!1)}})()},[v]);const x=async E=>{try{const k=t.find(A=>A.id===E);if(!k)return;k.isJoined?(await qt.leaveClub(E),v({title:"Success",description:"You have left the club."})):(await qt.joinClub(E),v({title:"Success",description:"You have joined the club!"})),e(t.map(A=>A.id===E?{...A,isJoined:!A.isJoined,members:A.isJoined?A.members-1:A.members+1}:A))}catch(k){console.error("Error toggling club membership:",k),v({title:"Error",description:"Failed to update club membership. Please try again.",variant:"destructive"})}},j=async()=>{if(!y.name||!y.description||!y.category||!y.country){v({title:"Error",description:"Please fill in all required fields.",variant:"destructive"});return}try{g(!0);const E={name:y.name,description:y.description,isPrivate:!1,tags:y.category?[y.category]:[],rules:[]};console.log("Sending club data to backend:",E);const k=await qt.createClub(E);e([k,...t]),f(!1),w({name:"",description:"",category:"",country:"",state:""}),v({title:"Success",description:"Club created successfully!"})}catch(E){console.error("Error creating club:",E),v({title:"Error",description:"Failed to create club. Please try again.",variant:"destructive"})}finally{g(!1)}},N=(Array.isArray(t)?t:[]).filter(E=>E.isJoined),_=[...(Array.isArray(t)?t:[]).filter(E=>((E.category?.toLowerCase()||"").includes(i.toLowerCase())||(E.name?.toLowerCase()||"").includes(i.toLowerCase()))&&(c?(E.name?.toLowerCase()||"").includes(c.toLowerCase()):!0))].sort((E,k)=>{switch(h){case"members":return k.members-E.members;case"new":return k.id.localeCompare(E.id);case"trending":case"active":case"popular":default:return k.members-E.members}});return s.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Discover Travel Clubs"}),s.jsx("p",{className:"text-muted-foreground mt-1",children:"Connect with travelers who share your passions."})]}),s.jsxs(ut,{open:p,onOpenChange:f,children:[s.jsx(Gr,{asChild:!0,children:s.jsxs(P,{className:"bg-gradient-primary text-white shadow-primary",children:[s.jsx(Qe,{className:"w-4 h-4 mr-2"}),"Create New Club"]})}),s.jsxs(st,{children:[s.jsx(rt,{children:s.jsx(at,{children:"Create a New Travel Club"})}),s.jsxs("div",{className:"space-y-4 py-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(J,{htmlFor:"club-name",children:"Club Name"}),s.jsx(se,{id:"club-name",placeholder:"e.g., Adventure Seekers",value:y.name,onChange:E=>w({...y,name:E.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(J,{htmlFor:"club-description",children:"Description"}),s.jsx(xs,{id:"club-description",placeholder:"What is your club about?",value:y.description,onChange:E=>w({...y,description:E.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(J,{htmlFor:"club-category",children:"Category"}),s.jsx(se,{id:"club-category",placeholder:"e.g., Adventure, Food, Culture",value:y.category,onChange:E=>w({...y,category:E.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(J,{htmlFor:"club-country",children:"Country"}),s.jsxs(fs,{value:y.country,onValueChange:E=>w({...y,country:E}),children:[s.jsx(Qt,{children:s.jsx(ps,{placeholder:"Select country"})}),s.jsxs(Xt,{children:[s.jsx(ae,{value:"us",children:"United States"}),s.jsx(ae,{value:"ca",children:"Canada"}),s.jsx(ae,{value:"uk",children:"United Kingdom"}),s.jsx(ae,{value:"fr",children:"France"}),s.jsx(ae,{value:"de",children:"Germany"}),s.jsx(ae,{value:"it",children:"Italy"}),s.jsx(ae,{value:"es",children:"Spain"}),s.jsx(ae,{value:"jp",children:"Japan"}),s.jsx(ae,{value:"au",children:"Australia"}),s.jsx(ae,{value:"in",children:"India"}),s.jsx(ae,{value:"br",children:"Brazil"}),s.jsx(ae,{value:"mx",children:"Mexico"}),s.jsx(ae,{value:"other",children:"Other"})]})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(J,{htmlFor:"club-state",children:"State/Province"}),s.jsx(se,{id:"club-state",placeholder:"e.g., California, Ontario, etc.",value:y.state||"",onChange:E=>w({...y,state:E.target.value})})]}),s.jsx(P,{className:"w-full bg-gradient-primary text-white",onClick:j,disabled:b,children:b?s.jsxs(s.Fragment,{children:[s.jsx(ge,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating..."]}):"Create Club"})]})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"relative lg:col-span-1",children:[s.jsx(gp,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),s.jsx(se,{placeholder:"Search by category...",value:i,onChange:E=>l(E.target.value),className:"pl-10"})]}),s.jsxs("div",{className:"relative lg:col-span-1",children:[s.jsx(Ie,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),s.jsx(se,{placeholder:"Search by country...",value:c,onChange:E=>d(E.target.value),className:"pl-10"})]}),s.jsx("div",{className:"lg:col-span-1",children:s.jsxs(fs,{value:h,onValueChange:m,children:[s.jsx(Qt,{children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(xp,{className:"w-4 h-4 text-muted-foreground"}),s.jsx(ps,{})]})}),s.jsxs(Xt,{children:[s.jsx(ae,{value:"popular",children:"Sort by: Popular"}),s.jsx(ae,{value:"new",children:"Sort by: New"}),s.jsx(ae,{value:"members",children:"Sort by: More Members"}),s.jsx(ae,{value:"trending",children:"Sort by: Trending"}),s.jsx(ae,{value:"active",children:"Sort by: Active"})]})]})})]})]}),s.jsxs(Zt,{defaultValue:"discover",className:"space-y-6",children:[s.jsxs($t,{className:"grid w-full grid-cols-2",children:[s.jsx(ye,{value:"discover",children:"Discover"}),s.jsx(ye,{value:"my-clubs",children:"My Clubs"})]}),s.jsx(be,{value:"discover",className:"space-y-6",children:s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r?[...Array(6)].map((E,k)=>s.jsxs(V,{className:"overflow-hidden hover:shadow-lg transition-all duration-300 group",children:[s.jsx("div",{className:"aspect-video overflow-hidden",children:s.jsx("div",{className:"w-full h-full bg-gray-200 animate-pulse"})}),s.jsx(_e,{className:"pb-2",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsx("div",{className:"w-3/4 h-6 bg-gray-200 rounded animate-pulse"}),s.jsx("div",{className:"w-16 h-5 bg-gray-200 rounded animate-pulse"})]})}),s.jsxs(G,{children:[s.jsx("div",{className:"w-full h-4 bg-gray-200 rounded animate-pulse mb-3"}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"w-20 h-4 bg-gray-200 rounded animate-pulse"}),s.jsx("div",{className:"w-16 h-8 bg-gray-200 rounded animate-pulse"})]})]})]},`loading-skeleton-${k}`)):n?s.jsxs("div",{className:"col-span-full text-center py-12",children:[s.jsx("p",{className:"text-red-500 mb-4",children:n}),s.jsx(P,{onClick:()=>window.location.reload(),variant:"outline",children:"Try Again"})]}):_.length===0?s.jsxs("div",{className:"col-span-full text-center py-12",children:[s.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-muted flex items-center justify-center",children:s.jsx(ze,{className:"w-8 h-8 text-muted-foreground"})}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:t.length===0?"No clubs available":"No clubs match your filters"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:t.length===0?"Be the first to create a travel club and connect with fellow travelers.":"Try adjusting your search criteria or browse all clubs."}),s.jsxs("div",{className:"flex gap-2 justify-center",children:[s.jsxs(P,{className:"bg-gradient-primary text-white",children:[s.jsx(Qe,{className:"w-4 h-4 mr-2"}),"Create Club"]}),t.length>0&&s.jsx(P,{variant:"outline",onClick:()=>{l(""),d(""),m("popular")},children:"Clear Filters"})]})]}):_.map(E=>s.jsx(Rc,{club:E,onJoinToggle:x},E.id))})}),s.jsx(be,{value:"my-clubs",className:"space-y-6",children:N.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:N.map(E=>s.jsx(Rc,{club:E,onJoinToggle:x},E.id))}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx(ze,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No clubs joined yet"}),s.jsx("p",{className:"text-muted-foreground",children:"Discover and join clubs that match your travel interests!"})]})})]})]})},Rc=({club:t,onJoinToggle:e})=>s.jsx(V,{className:"overflow-hidden hover:shadow-lg transition-all duration-300 group",children:s.jsxs(Ne,{to:`/clubs/${t.id}`,className:"block",children:[s.jsx("div",{className:"aspect-video overflow-hidden",children:s.jsx("img",{src:t.image||Jr,alt:t.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",onError:Dn})}),s.jsx(_e,{className:"pb-2",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsx(Ee,{className:"text-lg line-clamp-1",children:t.name}),s.jsx(Le,{variant:"secondary",className:"text-xs",children:t.category})]})}),s.jsxs(G,{children:[s.jsx("p",{className:"text-muted-foreground text-sm mb-3 line-clamp-2",children:t.description}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[s.jsx(ze,{className:"w-4 h-4"}),(t.members||0).toLocaleString()," members"]}),s.jsx(P,{size:"sm",variant:t.isJoined?"secondary":"default",className:t.isJoined?"":"bg-gradient-primary text-white",onClick:r=>{r.preventDefault(),r.stopPropagation(),e(t.id)},children:t.isJoined?"Joined":"Join"})]})]})]})}),w_=()=>{const[t,e]=u.useState(""),[r,a]=u.useState(""),[n,o]=u.useState("any"),[i,l]=u.useState([]),[c,d]=u.useState(!0),[h,m]=u.useState(!1),[p,f]=u.useState({title:"",destination:"",startDate:"",endDate:"",maxParticipants:"",budget:"",type:"",description:"",tags:""}),{toast:b}=Ct(),g=u.useCallback(async()=>{try{d(!0);const v=await te(K(re.trips.list));v.success&&v.data?l(v.data.trips||[]):l([])}catch(v){console.error("Error fetching trips:",v),b({title:"Error",description:"Failed to load trips. Please try again.",variant:"destructive"}),l([])}finally{d(!1)}},[b]);u.useEffect(()=>{g()},[g]);const y=async v=>{v.preventDefault();try{const x=p.destination.split(",").map(A=>A.trim()),j=x[0]||p.destination,N=x[1]||"Unknown";if(!p.title||p.title.length<3){b({title:"Validation Error",description:"Title must be at least 3 characters long.",variant:"destructive"});return}if(!p.description||p.description.length<10){b({title:"Validation Error",description:"Description must be at least 10 characters long.",variant:"destructive"});return}if(!p.startDate||!p.endDate){b({title:"Validation Error",description:"Please select both start and end dates.",variant:"destructive"});return}if(!p.maxParticipants||parseInt(p.maxParticipants)<1||parseInt(p.maxParticipants)>50){b({title:"Validation Error",description:"Max participants must be between 1 and 50.",variant:"destructive"});return}if(!p.type){b({title:"Validation Error",description:"Please select a trip category.",variant:"destructive"});return}const S=new Date(p.startDate).toISOString(),_=new Date(p.endDate).toISOString(),E={title:p.title.trim(),description:p.description.trim(),destination:{country:N.trim(),city:j.trim(),coordinates:{latitude:0,longitude:0}},dates:{startDate:S,endDate:_},budget:{total:parseFloat(p.budget.replace(/[^\d.]/g,""))||0,currency:"USD"},maxParticipants:parseInt(p.maxParticipants)||1,category:p.type,tags:p.tags.split(",").map(A=>A.trim()).filter(Boolean),visibility:"public"},k=await te(K(re.trips.create),{method:"POST",body:E});if(k.success)b({title:"Success",description:"Trip created successfully!"}),m(!1),f({title:"",destination:"",startDate:"",endDate:"",maxParticipants:"",budget:"",type:"",description:"",tags:""}),g();else throw new Error(k.message||"Failed to create trip")}catch(x){console.error("Error creating trip:",x),b({title:"Error",description:x.message||"Failed to create trip. Please try again.",variant:"destructive"})}},w=v=>{switch(v){case"Open":return"bg-success text-success-foreground";case"Seeking Buddies":return"bg-warning text-warning-foreground";case"Almost Full":return"bg-destructive text-destructive-foreground";default:return"bg-muted text-muted-foreground"}};return s.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-6",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Find Your Next Adventure"}),s.jsx("p",{className:"text-muted-foreground mt-1",children:"Looking for a travel buddy or planning a new adventure?"})]}),s.jsxs(ut,{open:h,onOpenChange:m,children:[s.jsx(Gr,{asChild:!0,children:s.jsxs(P,{className:"bg-gradient-adventure text-white shadow-primary",children:[s.jsx(Qe,{className:"w-4 h-4 mr-2"}),"Post Your Trip"]})}),s.jsxs(st,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[s.jsx(rt,{children:s.jsx(at,{children:"Create New Trip"})}),s.jsxs("form",{onSubmit:y,className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsx(J,{htmlFor:"title",children:"Trip Title"}),s.jsx(se,{id:"title",value:p.title,onChange:v=>f({...p,title:v.target.value}),placeholder:"e.g., Bali Adventure",required:!0})]}),s.jsxs("div",{children:[s.jsx(J,{htmlFor:"destination",children:"Destination"}),s.jsx(se,{id:"destination",value:p.destination,onChange:v=>f({...p,destination:v.target.value}),placeholder:"e.g., Bali, Indonesia",required:!0})]}),s.jsxs("div",{children:[s.jsx(J,{htmlFor:"startDate",children:"Start Date"}),s.jsx(se,{id:"startDate",type:"date",value:p.startDate,onChange:v=>f({...p,startDate:v.target.value}),required:!0})]}),s.jsxs("div",{children:[s.jsx(J,{htmlFor:"endDate",children:"End Date"}),s.jsx(se,{id:"endDate",type:"date",value:p.endDate,onChange:v=>f({...p,endDate:v.target.value}),required:!0})]}),s.jsxs("div",{children:[s.jsx(J,{htmlFor:"maxParticipants",children:"Max Participants"}),s.jsx(se,{id:"maxParticipants",type:"number",value:p.maxParticipants,onChange:v=>f({...p,maxParticipants:v.target.value}),placeholder:"e.g., 8",required:!0})]}),s.jsxs("div",{children:[s.jsx(J,{htmlFor:"budget",children:"Budget Range"}),s.jsx(se,{id:"budget",value:p.budget,onChange:v=>f({...p,budget:v.target.value}),placeholder:"e.g., $1000 - $1500",required:!0})]})]}),s.jsxs("div",{children:[s.jsx(J,{htmlFor:"type",children:"Trip Type"}),s.jsxs(fs,{value:p.type,onValueChange:v=>f({...p,type:v}),children:[s.jsx(Qt,{children:s.jsx(ps,{placeholder:"Select trip type"})}),s.jsxs(Xt,{children:[s.jsx(ae,{value:"adventure",children:"Adventure"}),s.jsx(ae,{value:"beach",children:"Beach"}),s.jsx(ae,{value:"city",children:"City Break"}),s.jsx(ae,{value:"culture",children:"Cultural"}),s.jsx(ae,{value:"food",children:"Food & Drink"}),s.jsx(ae,{value:"backpacking",children:"Backpacking"}),s.jsx(ae,{value:"luxury",children:"Luxury"}),s.jsx(ae,{value:"budget",children:"Budget"})]})]})]}),s.jsxs("div",{children:[s.jsx(J,{htmlFor:"description",children:"Description"}),s.jsx(xs,{id:"description",value:p.description,onChange:v=>f({...p,description:v.target.value}),placeholder:"Describe your trip...",rows:3,required:!0})]}),s.jsxs("div",{children:[s.jsx(J,{htmlFor:"tags",children:"Tags (comma separated)"}),s.jsx(se,{id:"tags",value:p.tags,onChange:v=>f({...p,tags:v.target.value}),placeholder:"e.g., Adventure, Beach, Culture"})]}),s.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[s.jsx(P,{type:"button",variant:"outline",onClick:()=>m(!1),children:"Cancel"}),s.jsx(P,{type:"submit",className:"bg-gradient-primary text-white",children:"Create Trip"})]})]})]})]})]}),s.jsx(V,{className:"bg-surface-elevated",children:s.jsx(G,{className:"p-6",children:s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Destination"}),s.jsxs("div",{className:"relative",children:[s.jsx(Ie,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),s.jsx(se,{placeholder:"e.g., Bali, Indonesia",value:t,onChange:v=>e(v.target.value),className:"pl-10"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Dates"}),s.jsx(se,{placeholder:"Select dates",value:r,onChange:v=>a(v.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Trip Type"}),s.jsxs(fs,{value:n,onValueChange:o,children:[s.jsx(Qt,{children:s.jsx(ps,{placeholder:"Any"})}),s.jsxs(Xt,{children:[s.jsx(ae,{value:"any",children:"Any"}),s.jsx(ae,{value:"adventure",children:"Adventure"}),s.jsx(ae,{value:"beach",children:"Beach"}),s.jsx(ae,{value:"city",children:"City Break"}),s.jsx(ae,{value:"culture",children:"Cultural"}),s.jsx(ae,{value:"food",children:"Food & Drink"}),s.jsx(ae,{value:"backpacking",children:"Backpacking"})]})]})]}),s.jsx("div",{className:"flex items-end",children:s.jsxs(P,{className:"w-full bg-gradient-primary text-white",children:[s.jsx(Wt,{className:"w-4 h-4 mr-2"}),"Search Trips"]})})]})})})]}),s.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:c?s.jsxs("div",{className:"col-span-full text-center py-12",children:[s.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),s.jsx("p",{className:"mt-4 text-muted-foreground",children:"Loading trips..."})]}):i.length===0?s.jsxs("div",{className:"col-span-full text-center py-12",children:[s.jsx(lt,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-xl font-semibold mb-2",children:"No trips found"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:"Be the first to create a trip!"}),s.jsxs(P,{onClick:()=>m(!0),className:"bg-gradient-primary text-white",children:[s.jsx(Qe,{className:"w-4 h-4 mr-2"}),"Create Your First Trip"]})]}):i.map(v=>{const x=typeof v.destination=="string"?v.destination:`${v.destination.city}, ${v.destination.country}`,j=new Date(v.dates?.startDate||""),N=new Date(v.dates?.endDate||""),S=j.toLocaleDateString()+" - "+N.toLocaleDateString(),_=v.organizer?typeof v.organizer=="string"?v.organizer:typeof v.organizer=="object"&&v.organizer.name?v.organizer.name:"Nomad Admin":"Nomad Admin",E=v.budget?`$${v.budget.total} ${v.budget.currency}`:"Budget TBD",k=A=>{if(!A||typeof A!="string")return"NA";const B=A.trim().split(" ").filter(Boolean);return B.length===0?"NA":B.map($=>$[0]?.toUpperCase()||"").join("").slice(0,2)};return s.jsx(V,{className:"overflow-hidden hover:shadow-lg transition-all duration-300 cursor-pointer group",children:s.jsxs(Ne,{to:`/trips/${v.id}`,children:[s.jsxs("div",{className:"aspect-video overflow-hidden relative",children:[s.jsx("img",{src:v.images?.[0]||Yt,alt:v.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",onError:Dn}),s.jsx(Le,{className:`absolute top-3 right-3 ${w(v.status||"planning")}`,children:v.status||"Planning"})]}),s.jsxs(_e,{className:"pb-3",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsx(Ee,{className:"text-xl line-clamp-1",children:v.title}),s.jsx(Le,{variant:"outline",className:"text-xs",children:v.category})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.jsxs(Pe,{className:"w-6 h-6",children:[s.jsx(Ae,{src:v.organizerAvatar}),s.jsx(Re,{className:"text-xs bg-primary text-primary-foreground",children:k(_)})]}),s.jsxs("span",{className:"text-sm text-muted-foreground",children:["by ",_]})]})]}),s.jsxs(G,{children:[s.jsx("p",{className:"text-muted-foreground text-sm mb-4 line-clamp-2",children:v.description}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(Ie,{className:"w-4 h-4 text-primary"}),s.jsx("span",{children:x})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(Be,{className:"w-4 h-4 text-primary"}),s.jsx("span",{children:S})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(ze,{className:"w-4 h-4 text-primary"}),s.jsxs("span",{children:[v.participantCount||0,"/",v.maxParticipants," travelers"]})]})]}),s.jsx("div",{className:"flex flex-wrap gap-1 mt-4 mb-4",children:(v.tags||[]).map((A,B)=>s.jsx(Le,{variant:"secondary",className:"text-xs",children:A},B))}),s.jsxs("div",{className:"flex justify-between items-center pt-3 bg-muted/10 rounded-lg px-3 mt-3",children:[s.jsx("span",{className:"font-semibold text-sm",children:E}),s.jsx(P,{size:"sm",className:"bg-gradient-primary text-white",onClick:A=>{A.preventDefault(),console.log("Express interest in trip:",v.title)},children:"I'm Interested"})]})]})]})},v.id)})})]})};class b_{async getProfile(){const e=await cs(K(re.users.profile),Ps.userProfile("current"),{ttl:It.MEDIUM,method:"GET",headers:fe()});if(e.success&&e.data)return e.data;throw new Error(e.message||"Failed to get profile")}async updateProfile(e){const r=await te(K(re.users.updateProfile),{method:"PUT",headers:fe(),body:e});if(r.success&&r.data)return r.data;throw new Error(r.message||"Failed to update profile")}async uploadAvatar(e){const r=new FormData;r.append("avatar",e);const a=await te(K(re.users.uploadAvatar),{method:"POST",headers:{...fe()},body:r});if(a.success&&a.data)return a.data;throw new Error(a.message||"Failed to upload avatar")}async getUserProfile(e){const r=await cs(`${K(re.users.profile)}/${e}`,Ps.userProfile(e),{ttl:It.MEDIUM,method:"GET",headers:fe()});if(r.success&&r.data)return r.data;throw new Error(r.message||"Failed to get user profile")}async followUser(e){const r=await te(K(re.users.follow(e)),{method:"POST",headers:fe()});if(!r.success)throw new Error(r.message||"Failed to follow user")}async unfollowUser(e){const r=await te(K(re.users.unfollow(e)),{method:"POST",headers:fe()});if(!r.success)throw new Error(r.message||"Failed to unfollow user")}async getFollowers(e,r=1,a=20){const n=new URLSearchParams({page:r.toString(),limit:a.toString()});e&&n.append("userId",e);const o=`${K(re.users.followers)}?${n.toString()}`,i=Ps.followers(e||"current");return await cs(o,i,{ttl:It.SHORT,method:"GET",headers:fe()})}async getFollowing(e,r=1,a=20){const n=new URLSearchParams({page:r.toString(),limit:a.toString()});e&&n.append("userId",e);const o=`${K(re.users.following)}?${n.toString()}`,i=Ps.following(e||"current");return await cs(o,i,{ttl:It.SHORT,method:"GET",headers:fe()})}async searchUsers(e){const r=new URLSearchParams;Object.entries(e).forEach(([n,o])=>{o!=null&&(Array.isArray(o)?r.append(n,o.join(",")):r.append(n,o.toString()))});const a=r.toString()?`${K(re.users.search)}?${r.toString()}`:K(re.users.search);return await te(a,{method:"GET",headers:fe()})}async getUserSuggestions(e=10){const r=await te(`${K(re.users.search)}/suggestions?limit=${e}`,{method:"GET",headers:fe()});if(r.success&&r.data)return r.data;throw new Error(r.message||"Failed to get user suggestions")}async getUserStats(e){const r=e?`${K(re.users.profile)}/${e}/stats`:`${K(re.users.profile)}/stats`,a=await te(r,{method:"GET",headers:fe()});if(a.success&&a.data)return a.data;throw new Error(a.message||"Failed to get user stats")}async updatePreferences(e){const r=await te(`${K(re.users.profile)}/preferences`,{method:"PUT",headers:fe(),body:e});if(r.success&&r.data)return r.data;throw new Error(r.message||"Failed to update preferences")}async updateNotificationSettings(e){const r=await te(K(re.notifications.settings),{method:"PUT",headers:fe(),body:e});if(r.success&&r.data)return r.data;throw new Error(r.message||"Failed to update notification settings")}async getNotificationSettings(){const e=await te(K(re.notifications.settings),{method:"GET",headers:fe()});if(e.success&&e.data)return e.data;throw new Error(e.message||"Failed to get notification settings")}async updatePrivacySettings(e){const r=await te(`${K(re.users.profile)}/privacy`,{method:"PUT",headers:fe(),body:e});if(r.success&&r.data)return r.data;throw new Error(r.message||"Failed to update privacy settings")}async changePassword(e,r){const a=await te(`${K(re.users.profile)}/password`,{method:"PUT",headers:fe(),body:{currentPassword:e,newPassword:r}});if(!a.success)throw new Error(a.message||"Failed to change password")}async blockUser(e){const r=await te(`${K(re.users.profile)}/${e}/block`,{method:"POST",headers:fe()});if(!r.success)throw new Error(r.message||"Failed to block user")}async unblockUser(e){const r=await te(`${K(re.users.profile)}/${e}/unblock`,{method:"POST",headers:fe()});if(!r.success)throw new Error(r.message||"Failed to unblock user")}async reportUser(e,r,a){const n=await te(`${K(re.users.profile)}/${e}/report`,{method:"POST",headers:fe(),body:{reason:r,description:a}});if(!n.success)throw new Error(n.message||"Failed to report user")}}const et=new b_;function j_(t,e,r,a){const o=(r-t)*Math.PI/180,i=(a-e)*Math.PI/180,l=Math.sin(o/2)*Math.sin(o/2)+Math.cos(t*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(i/2)*Math.sin(i/2);return 6371*(2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l)))}function Ki(t){if(t.length===0)return{lat:0,lng:0};if(t.length===1)return{lat:t[0].lat,lng:t[0].lng};let e=0,r=0;return t.forEach(a=>{e+=a.lat,r+=a.lng}),{lat:e/t.length,lng:r/t.length}}function N_(t){const e=new Map;return t.forEach(r=>{const a=r.country||"Unknown";e.has(a)||e.set(a,[]),e.get(a).push(r)}),Array.from(e.entries()).map(([r,a])=>{const n=Ki(a);return{id:`country-${r}`,lat:n.lat,lng:n.lng,count:a.length,label:`${r} (${a.length} ${a.length===1?"place":"places"})`,points:a,type:"country"}})}function S_(t){const e=new Map;return t.forEach(r=>{const a=r.state||r.city||"Unknown",n=`${r.country||"Unknown"}-${a}`;e.has(n)||e.set(n,[]),e.get(n).push(r)}),Array.from(e.entries()).map(([r,a])=>{const n=Ki(a),o=a[0],i=o.state||o.city||"Unknown";return{id:`state-${r}`,lat:n.lat,lng:n.lng,count:a.length,label:`${i} (${a.length})`,points:a,type:"state"}})}function __(t,e=50){const r=[],a=new Set;return t.forEach(n=>{if(a.has(n.id))return;const o=[n];a.add(n.id),t.forEach(c=>{if(a.has(c.id))return;j_(n.lat,n.lng,c.lat,c.lng)<=e&&(o.push(c),a.add(c.id))});const i=Ki(o),l=o.length===1?o[0].placeName||o[0].title||"Location":`${o.length} locations`;r.push({id:`cluster-${n.id}`,lat:i.lat,lng:i.lng,count:o.length,label:l,points:o,type:"local"})}),r}function C_(t,e){if(t.length===0)return[];if(t.some(a=>a.country||a.state))return e<5?N_(t):e>=5&&e<10?S_(t):t.map(a=>({id:a.id,lat:a.lat,lng:a.lng,count:1,label:a.placeName||a.title||"Location",points:[a],type:"local"}));{const a=e<5?500:e<10?100:10;return __(t,a)}}function E_(t){return t.filter(e=>e.location?.coordinates?.latitude&&e.location?.coordinates?.longitude).map(e=>({id:e.id,lat:e.location.coordinates.latitude,lng:e.location.coordinates.longitude,title:e.title,country:e.location.country,state:e.location.state,city:e.location.city,placeName:e.location.place_name||e.location.city,photos:e.photos||e.images||[],data:e}))}function k_(t){return t.filter(e=>e.location?.coordinates?.latitude&&e.location?.coordinates?.longitude).map(e=>({id:e.id,lat:e.location.coordinates.latitude,lng:e.location.coordinates.longitude,title:e.title,country:e.location.country,state:e.location.state,city:e.location.city,placeName:e.location.place_name||e.location.city,photo:e.featured_image||e.images?.[0],photos:e.images||[],data:e}))}const T_="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII=",P_="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC",Af=ea.icon({iconUrl:T_,shadowUrl:P_,iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});ea.Marker.prototype.options.icon=Af;function Ic(t){return ea.divIcon({className:"custom-cluster-icon",html:`
      <div class="relative flex items-center justify-center w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 text-white rounded-full shadow-2xl border-3 border-white font-bold text-base">
        ${t}
        <span class="absolute inset-0 rounded-full bg-blue-400 animate-ping opacity-30"></span>
      </div>`,iconSize:[48,48],iconAnchor:[24,24]})}function A_(t){return ea.divIcon({className:"photo-marker",html:`
      <div class="w-14 h-14 rounded-full border-3 border-white shadow-2xl overflow-hidden bg-white transform transition-transform hover:scale-110">
        <img src="${t}" class="w-full h-full object-cover" alt="Memory" />
      </div>`,iconSize:[56,56],iconAnchor:[28,28]})}function R_(){return ea.divIcon({className:"user-location-marker",html:`
      <div class="relative flex items-center justify-center w-8 h-8">
        <div class="absolute w-8 h-8 bg-blue-500 rounded-full opacity-30 animate-ping"></div>
        <div class="w-4 h-4 bg-blue-500 border-2 border-white rounded-full shadow-lg z-10"></div>
      </div>`,iconSize:[32,32],iconAnchor:[16,16]})}function I_({onZoomChange:t}){const e=Up({zoomend:()=>t(e.getZoom()),moveend:()=>t(e.getZoom())});return null}function D_({onLocate:t}){return s.jsx(P,{onClick:t,size:"sm",variant:"secondary",className:"absolute bottom-24 right-4 z-[1000] shadow-2xl rounded-full w-12 h-12 p-0",children:s.jsx(wp,{className:"w-5 h-5"})})}const O_=()=>{const{user:t,isAuthenticated:e,isLoading:r}=mt(),[a,n]=u.useState(!0),[o,i]=u.useState([]),[l,c]=u.useState([]),[d,h]=u.useState([]),[m,p]=u.useState(3),[f,b]=u.useState("journeys"),[g,y]=u.useState(null),[w,v]=u.useState(null),[x,j]=u.useState(0),[N,S]=u.useState(null),[_,E]=u.useState(null),{toast:k}=Ct(),A=()=>{window.scrollTo({top:0,behavior:"smooth"})},B=()=>{window.scrollTo({top:document.documentElement.scrollHeight,behavior:"smooth"})},$=u.useCallback(()=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition(C=>{const{latitude:q,longitude:T}=C.coords;S([q,T]),E(null),k({title:" Location Found",description:`Your current position: ${q.toFixed(4)}, ${T.toFixed(4)}`,duration:3e3})},C=>{console.error("Geolocation error:",C),E(C.message),k({title:" Location Access Denied",description:"Please enable location services to see your current position on the map.",variant:"destructive"})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0}):k({title:" Geolocation Not Supported",description:"Your browser doesn't support location services.",variant:"destructive"})},[k]),H=u.useCallback(async()=>{if(!(!t||!e)){n(!0);try{const[C,q,T]=await Promise.all([et.getUserStats(),As.getMyJourneys(),Vi.getStories()]);i([{icon:nn,value:C.countriesVisited||0,label:"Countries",color:"text-blue-600",bg:"bg-blue-50 dark:bg-blue-900/30"},{icon:Ie,value:C.citiesVisited||0,label:"Cities",color:"text-green-600",bg:"bg-green-50 dark:bg-green-900/30"},{icon:vp,value:`${Math.round((C.totalDistance||0)/1e3)}k`,label:"KM Traveled",color:"text-purple-600",bg:"bg-purple-50 dark:bg-purple-900/30"},{icon:yp,value:C.totalTrips||0,label:"Trips",color:"text-orange-600",bg:"bg-orange-50 dark:bg-orange-900/30"}]),c(Array.isArray(q.data?.journeys)?q.data.journeys:[]),h(Array.isArray(T.data?.stories)?T.data.stories:[])}catch(C){console.error("Failed to fetch data:",C),k({title:"Failed to load data",description:"Please try refreshing the page.",variant:"destructive"})}finally{n(!1)}}},[t,e,k]);u.useEffect(()=>{H(),$()},[H,$]);const O=u.useMemo(()=>f==="journeys"?E_(l):k_(d),[f,l,d]),Y=u.useMemo(()=>C_(O,m),[O,m]),z=u.useMemo(()=>{if(N)return N;if(O.length===0)return[20,0];const C=O.map(T=>T.lat),q=O.map(T=>T.lng);return[(Math.max(...C)+Math.min(...C))/2,(Math.max(...q)+Math.min(...q))/2]},[O,N]),R=u.useCallback(C=>{y(q=>q===C?null:C)},[]),M=u.useCallback(C=>{if(f==="memories"&&C.points.length>0){const q=C.points.flatMap(T=>T.photos||(T.photo?[T.photo]:[])).filter(Boolean);q.length>0&&(v({photos:q,title:C.label}),j(0))}},[f]);return r?s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsxs("div",{className:"text-center",children:[s.jsx(ge,{className:"w-12 h-12 animate-spin mx-auto mb-4 text-primary"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading your travel map..."})]})}):e?s.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-white dark:from-slate-950 dark:to-slate-900",children:[s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[s.jsxs(Q.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(Ne,{to:"/",className:"p-2.5 rounded-full bg-white dark:bg-slate-800 shadow-lg hover:shadow-xl transition-all hover:scale-105",children:s.jsx(ct,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl md:text-4xl font-bold tracking-tight bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Your Travel World"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Explore your journey across the globe"})]})]}),s.jsxs(P,{onClick:()=>{H(),$()},variant:"outline",size:"sm",className:"shadow-md hover:shadow-lg transition-all",children:[s.jsx(Wc,{className:"w-4 h-4 mr-2"})," Refresh"]})]}),s.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:o.map((C,q)=>s.jsx(Q.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:q*.1,type:"spring"},children:s.jsx(V,{className:"overflow-hidden border-none shadow-lg hover:shadow-2xl transition-all duration-300 hover:-translate-y-1 cursor-default",children:s.jsx(G,{className:"p-6",children:s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:`p-3 rounded-2xl ${C.bg}`,children:s.jsx(C.icon,{className:`w-6 h-6 ${C.color}`})}),s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-bold",children:C.value}),s.jsx("div",{className:"text-xs uppercase tracking-wider text-muted-foreground",children:C.label})]})]})})})},q))}),s.jsx(Q.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.2},children:s.jsxs(V,{className:"relative overflow-hidden border-none shadow-2xl",children:[s.jsx("div",{className:"absolute top-6 left-1/2 -translate-x-1/2 z-[1000] w-full max-w-xs px-4",children:s.jsxs("div",{className:"bg-white/90 dark:bg-slate-900/90 backdrop-blur-2xl border border-slate-200 dark:border-slate-700 shadow-2xl rounded-full p-1.5 flex gap-1.5",children:[s.jsxs(P,{className:"flex-1 rounded-full text-xs h-10 font-semibold transition-all",variant:f==="journeys"?"default":"ghost",onClick:()=>b("journeys"),children:[s.jsx(qc,{className:"w-4 h-4 mr-2"})," Journeys"]}),s.jsxs(P,{className:"flex-1 rounded-full text-xs h-10 font-semibold transition-all",variant:f==="memories"?"default":"ghost",onClick:()=>b("memories"),children:[s.jsx(lt,{className:"w-4 h-4 mr-2"})," Memories"]})]})}),s.jsx("div",{className:"h-[700px] w-full relative",children:a?s.jsx("div",{className:"flex items-center justify-center h-full",children:s.jsx(ge,{className:"w-12 h-12 animate-spin text-primary"})}):s.jsxs(s.Fragment,{children:[s.jsxs($p,{center:z,zoom:N?12:m,className:"h-full w-full",zoomControl:!0,scrollWheelZoom:!0,children:[s.jsx(Fp,{url:"https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",attribution:' <a href="https://carto.com/">CARTO</a>'}),s.jsx(I_,{onZoomChange:p}),N&&s.jsx(Er,{position:N,icon:R_(),children:s.jsx(Bn,{children:s.jsx("div",{className:"text-center font-semibold",children:" You are here"})})}),Y.map(C=>{const q=g===C.id;if(f==="memories"){const T=C.points[0]?.photo||C.points[0]?.photos?.[0];return T?s.jsx(Er,{position:[C.lat,C.lng],icon:A_(T),eventHandlers:{click:()=>M(C)}},C.id):null}if(q&&C.count>1){const T=2*Math.PI/C.points.length;return s.jsxs("div",{children:[C.points.map((U,X)=>s.jsx(Er,{position:[C.lat+.01*Math.cos(X*T),C.lng+.01*Math.sin(X*T)],children:s.jsx(Bn,{className:"font-medium",children:U.title||U.placeName})},U.id)),s.jsx(Er,{position:[C.lat,C.lng],icon:Ic(C.count),eventHandlers:{click:()=>R(C.id)}})]},C.id)}return s.jsx(Er,{position:[C.lat,C.lng],icon:C.count>1?Ic(C.count):Af,eventHandlers:{click:()=>C.count>1&&R(C.id)},children:C.count===1&&s.jsx(Bn,{children:s.jsx("div",{className:"font-semibold",children:C.points[0].title||C.points[0].placeName})})},C.id)})]}),s.jsx(D_,{onLocate:$}),s.jsxs("div",{className:"md:hidden absolute right-4 top-1/2 -translate-y-1/2 z-[999] flex flex-col gap-3",children:[s.jsx(P,{onClick:A,size:"icon",className:"w-12 h-12 rounded-full shadow-2xl bg-white/95 dark:bg-slate-900/95 hover:bg-white dark:hover:bg-slate-800 border-2 border-blue-500 text-blue-600 dark:text-blue-400",children:s.jsx(Vc,{className:"w-6 h-6"})}),s.jsx(P,{onClick:B,size:"icon",className:"w-12 h-12 rounded-full shadow-2xl bg-white/95 dark:bg-slate-900/95 hover:bg-white dark:hover:bg-slate-800 border-2 border-blue-500 text-blue-600 dark:text-blue-400",children:s.jsx(si,{className:"w-6 h-6"})})]})]})})]})})]}),s.jsx(ur,{children:w&&s.jsx(ut,{open:!!w,onOpenChange:()=>v(null),children:s.jsxs(st,{className:"max-w-4xl",children:[s.jsx(rt,{children:s.jsx(at,{className:"text-xl font-bold",children:w.title})}),w.photos.length>0&&s.jsxs("div",{className:"relative",children:[s.jsx(Q.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"aspect-video bg-slate-100 dark:bg-slate-800 rounded-lg overflow-hidden",children:s.jsx("img",{src:w.photos[x],alt:`Memory ${x+1}`,className:"w-full h-full object-cover",onError:C=>Dn(C,Yt,"Gallery image error")})},x),w.photos.length>1&&s.jsxs("div",{className:"flex items-center justify-between mt-4",children:[s.jsx(P,{variant:"outline",size:"icon",onClick:()=>j(C=>C===0?w.photos.length-1:C-1),children:s.jsx(ti,{className:"w-5 h-5"})}),s.jsxs("span",{className:"text-sm font-medium",children:[x+1," / ",w.photos.length]}),s.jsx(P,{variant:"outline",size:"icon",onClick:()=>j(C=>(C+1)%w.photos.length),children:s.jsx(an,{className:"w-5 h-5"})})]})]})]})})})]}):s.jsx(Qc,{to:"/login",replace:!0})},M_=async t=>{const{supabase:e}=await we(async()=>{const{supabase:c}=await Promise.resolve().then(()=>Jt);return{supabase:c}},void 0,import.meta.url),{data:{session:r},error:a}=await e.auth.getSession();if(a||!r?.access_token)throw new Error("No authentication token available. Please log in.");let n=K(re.budget.list);if(t){const c=new URLSearchParams;Object.entries(t).forEach(([d,h])=>{h!=null&&c.append(d,h.toString())}),c.toString()&&(n+=`?${c.toString()}`)}const{getAuthHeader:o}=await we(async()=>{const{getAuthHeader:c}=await Promise.resolve().then(()=>Ve);return{getAuthHeader:c}},void 0,import.meta.url),i=await o();return(await te(n,{headers:i})).data},Ji=async t=>{const{supabase:e}=await we(async()=>{const{supabase:m}=await Promise.resolve().then(()=>Jt);return{supabase:m}},void 0,import.meta.url),{data:{session:r},error:a}=await e.auth.getSession();if(a||!r?.user)throw new Error("No authentication token available. Please log in.");const{data:n,error:o}=await e.from("budgets").select("*").eq("id",t).single();if(o)throw console.error("Budget fetch error:",o),console.error("Budget ID:",t),console.error("User ID:",r.user.id),console.error("Error code:",o.code),console.error("Error details:",o.details),o.code==="PGRST116"?new Error("Budget not found. Please check the budget ID."):o.message?.includes("row-level security")?new Error("Access denied. This budget does not belong to you."):new Error(`Budget not found or access denied: ${o.message}`);if(!n)throw new Error("Budget not found");if(n.user_id!==r.user.id)throw console.error("Budget ownership mismatch:",{budgetUserId:n.user_id,sessionUserId:r.user.id}),new Error("Access denied: Budget does not belong to current user");const i=n.trip_id;let l=[];if(i){const{data:m,error:p}=await e.from("expenses").select("*").eq("trip_id",i).eq("user_id",r.user.id).order("date",{ascending:!1});!p&&m&&(l=m.map(f=>({id:f.id,budgetId:t,category:f.category||"Miscellaneous",amount:parseFloat(f.amount?.toString()||"0"),description:f.description||"",date:f.date||f.expense_date,currency:f.currency||n.currency||"USD",createdAt:f.created_at,updatedAt:f.updated_at})))}const{data:c,error:d}=await e.from("budget_expenses").select("*").eq("budget_id",t).order("expense_date",{ascending:!1});if(!d&&c&&c.length>0){const m=new Set(l.map(f=>f.id)),p=c.filter(f=>!m.has(f.id)).map(f=>({id:f.id,budgetId:t,category:f.category||"Miscellaneous",amount:parseFloat(f.amount?.toString()||"0"),description:f.description||"",date:f.expense_date||f.date,currency:n.currency||"USD",createdAt:f.created_at,updatedAt:f.updated_at}));l=[...l,...p]}return{budget:{id:n.id,title:n.title,destination:n.description||"",totalBudget:parseFloat(n.total_amount?.toString()||"0"),spent:parseFloat(n.spent_amount?.toString()||"0"),remaining:parseFloat(n.total_amount?.toString()||"0")-parseFloat(n.spent_amount?.toString()||"0"),startDate:n.start_date||"",endDate:n.end_date||"",status:n.status||"active",currency:n.currency||"USD",noMaxBudget:!1,userId:n.user_id,expenses:l,createdAt:n.created_at,updatedAt:n.updated_at,progress:n.total_amount>0?Math.round(parseFloat(n.spent_amount?.toString()||"0")/parseFloat(n.total_amount.toString())*100):0},expenses:l}},L_=async t=>{const{budget:e}=await Ji(t);return e},$_=async t=>{const{supabase:e}=await we(async()=>{const{supabase:c}=await Promise.resolve().then(()=>Jt);return{supabase:c}},void 0,import.meta.url),{data:{session:r},error:a}=await e.auth.getSession();if(a||!r?.access_token)throw new Error("No authentication token available. Please log in.");const n={title:t.title,description:t.destination,total_budget:t.totalBudget||0,currency:t.currency,budget_limit:t.totalBudget||0,start_date:t.startDate,end_date:t.endDate,trip_id:null},{getAuthHeader:o}=await we(async()=>{const{getAuthHeader:c}=await Promise.resolve().then(()=>Ve);return{getAuthHeader:c}},void 0,import.meta.url),i=await o();return(await te(K(re.budget.create),{method:"POST",headers:{...i,"Content-Type":"application/json"},body:n})).data},F_=async t=>{const{supabase:e}=await we(async()=>{const{supabase:m}=await Promise.resolve().then(()=>Jt);return{supabase:m}},void 0,import.meta.url),{data:{session:r},error:a}=await e.auth.getSession();if(a||!r?.user)throw new Error("No authentication token available. Please log in.");const{id:n,...o}=t,{data:i,error:l}=await e.from("budgets").select("id, trip_id, user_id").eq("id",n).eq("user_id",r.user.id).single();if(l||!i)throw new Error("Budget not found or access denied");const c={updated_at:new Date().toISOString()};o.title&&(c.title=o.title),o.destination&&(c.description=o.destination),o.totalBudget!==void 0&&(c.total_amount=o.totalBudget),o.currency&&(c.currency=o.currency),o.status&&(c.status=o.status),o.startDate&&(c.start_date=o.startDate),o.endDate&&(c.end_date=o.endDate);const{data:d,error:h}=await e.from("budgets").update(c).eq("id",n).eq("user_id",r.user.id).select().single();if(h)throw console.error("Supabase budget update error:",h),console.error("Update data attempted:",c),console.error("Budget ID:",n),console.error("User ID:",r.user.id),new Error(h?.message||"Failed to update budget in database");if(!d)throw new Error("Budget update returned no data");if(i.trip_id&&(o.startDate||o.endDate||o.status)){const m={updated_at:new Date().toISOString()};o.startDate&&(m.start_date=o.startDate),o.endDate&&(m.end_date=o.endDate),o.status&&(m.status=o.status);const{error:p}=await e.from("trips").update(m).eq("id",i.trip_id).eq("user_id",r.user.id);p&&console.warn("Supabase trip update error (non-critical):",p)}return{id:d.id,title:d.title,destination:d.description||"",totalBudget:parseFloat(d.total_amount?.toString()||"0"),spent:parseFloat(d.spent_amount?.toString()||"0"),remaining:parseFloat(d.total_amount?.toString()||"0")-parseFloat(d.spent_amount?.toString()||"0"),startDate:d.start_date||o.startDate||"",endDate:d.end_date||o.endDate||"",status:d.status||"active",currency:d.currency||"USD",noMaxBudget:!1,userId:d.user_id,expenses:[],createdAt:d.created_at,updatedAt:d.updated_at,progress:d.total_amount>0?Math.round(parseFloat(d.spent_amount?.toString()||"0")/parseFloat(d.total_amount.toString())*100):0}},U_=async t=>{await te(K(re.budget.delete(t)),{method:"DELETE",headers:fe()})},B_=async t=>{const{expenses:e}=await Ji(t);return e},z_=async(t,e)=>{const{supabase:r}=await we(async()=>{const{supabase:h}=await Promise.resolve().then(()=>Jt);return{supabase:h}},void 0,import.meta.url),{data:{session:a},error:n}=await r.auth.getSession();if(n||!a?.user)throw new Error("No authentication token available. Please log in.");const{data:o,error:i}=await r.from("budgets").select("id, trip_id, user_id, currency").eq("id",t).eq("user_id",a.user.id).single();if(i)throw console.error("Budget fetch error:",i),new Error(`Budget not found or access denied: ${i.message}`);if(!o)throw new Error("Budget not found");const{data:l,error:c}=await r.from("budget_expenses").insert({budget_id:t,category:e.category,amount:e.amount,description:e.description||null,expense_date:e.date}).select().single();if(c||!l)throw console.error("Budget expenses insert error:",c),new Error(c?.message||"Failed to save expense to database");if(o.trip_id){const{error:h}=await r.from("expenses").insert({trip_id:o.trip_id,user_id:a.user.id,category:e.category,amount:e.amount,description:e.description||null,date:e.date,currency:e.currency||o.currency||"USD"});h&&console.warn("Expenses table insert failed (non-critical):",h)}const d={id:l.id,category:l.category,amount:l.amount,description:l.description,date:l.expense_date,currency:e.currency||o.currency||"USD",created_at:l.created_at,updated_at:l.updated_at};return{id:d.id,budgetId:t,category:d.category,amount:parseFloat(d.amount.toString()),description:d.description||"",date:d.date,currency:d.currency||"USD",createdAt:d.created_at,updatedAt:d.updated_at}},q_=async(t,e)=>{const{id:r,...a}=e;return(await te(K(re.budget.updateExpense(t,r)),{method:"PUT",headers:{...fe(),"Content-Type":"application/json"},body:a})).data},W_=async(t,e)=>{await te(K(re.budget.deleteExpense(t,e)),{method:"DELETE",headers:fe()})},Ts={getBudgets:M_,getBudgetById:L_,getTripBudgetDetails:Ji,createBudget:$_,updateBudget:F_,deleteBudget:U_,getBudgetExpenses:B_,addBudgetExpense:z_,updateBudgetExpense:q_,deleteBudgetExpense:W_};var Yi="Progress",Qi=100,[H_,eE]=Xe(Yi),[V_,G_]=H_(Yi),Rf=u.forwardRef((t,e)=>{const{__scopeProgress:r,value:a=null,max:n,getValueLabel:o=K_,...i}=t;(n||n===0)&&!Dc(n)&&console.error(J_(`${n}`,"Progress"));const l=Dc(n)?n:Qi;a!==null&&!Oc(a,l)&&console.error(Y_(`${a}`,"Progress"));const c=Oc(a,l)?a:null,d=tn(c)?o(c,l):void 0;return s.jsx(V_,{scope:r,value:c,max:l,children:s.jsx(ne.div,{"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":tn(c)?c:void 0,"aria-valuetext":d,role:"progressbar","data-state":Of(c,l),"data-value":c??void 0,"data-max":l,...i,ref:e})})});Rf.displayName=Yi;var If="ProgressIndicator",Df=u.forwardRef((t,e)=>{const{__scopeProgress:r,...a}=t,n=G_(If,r);return s.jsx(ne.div,{"data-state":Of(n.value,n.max),"data-value":n.value??void 0,"data-max":n.max,...a,ref:e})});Df.displayName=If;function K_(t,e){return`${Math.round(t/e*100)}%`}function Of(t,e){return t==null?"indeterminate":t===e?"complete":"loading"}function tn(t){return typeof t=="number"}function Dc(t){return tn(t)&&!isNaN(t)&&t>0}function Oc(t,e){return tn(t)&&!isNaN(t)&&t<=e&&t>=0}function J_(t,e){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${Qi}\`.`}function Y_(t,e){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${Qi} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Mf=Rf,Q_=Df;const sn=u.forwardRef(({className:t,value:e,...r},a)=>s.jsx(Mf,{ref:a,className:Z("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...r,children:s.jsx(Q_,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(e||0)}%)`}})}));sn.displayName=Mf.displayName;const X_=()=>{const[t,e]=u.useState("USD"),[r,a]=u.useState([]),[n,o]=u.useState(!0),[i,l]=u.useState(null),[c,d]=u.useState(!1),[h,m]=u.useState(!1),[p,f]=u.useState({title:"",destination:"",totalBudget:0,startDate:"",endDate:"",status:"active",currency:"USD",noMaxBudget:!1}),{toast:b}=Ct();u.useEffect(()=>{(async()=>{try{const A=await Kr.getUserCurrency();e(A)}catch(A){console.error("Error loading currency preference:",A)}})()},[]);const g=async k=>{e(k);try{await Kr.updateUserPreferences({currency:k})}catch(A){console.error("Error saving currency preference:",A),b({title:"Warning",description:"Currency preference could not be saved, but it will work for this session.",variant:"default"})}};u.useEffect(()=>{(async()=>{try{o(!0),l(null);const B=(await Ts.getBudgets()).filter(Boolean);a(B)}catch(A){l("Failed to load budgets"),console.error("Error fetching budgets:",A),b({title:"Error",description:"Failed to load budgets. Please try again.",variant:"destructive"})}finally{o(!1)}})()},[b]);const y=k=>{switch(k){case"USD":case"CAD":case"AUD":return"$";case"EUR":return"";case"GBP":return"";case"JPY":case"CNY":return"";case"INR":return"";case"RUB":return"";case"BRL":return"R$";default:return"$"}},w=async()=>{if(!p.title||!p.destination||!p.startDate||!p.endDate){b({title:"Error",description:"Please fill in all required fields.",variant:"destructive"});return}if(!(localStorage.getItem("user")!==null)){b({title:"Authentication Required",description:"Please log in or sign up to save your budget."}),localStorage.setItem("pendingBudget",JSON.stringify(p)),localStorage.setItem("redirectAfterAuth","/budget"),window.location.href="/login";return}try{d(!0);const A={title:p.title,destination:p.destination,totalBudget:p.noMaxBudget?void 0:p.totalBudget||0,startDate:p.startDate,endDate:p.endDate,status:p.status,currency:p.currency||"USD",noMaxBudget:p.noMaxBudget},B=await Ts.createBudget(A);a($=>[B,...$]),m(!1),f({title:"",destination:"",totalBudget:0,startDate:"",endDate:"",status:"active",currency:"USD",noMaxBudget:!1}),b({title:"Success",description:"Budget created successfully!"})}catch(A){console.error("Error creating budget:",A),b({title:"Error",description:"Failed to create budget. Please try again.",variant:"destructive"})}finally{d(!1)}};r.length,r.filter(k=>k.status==="active").length,r.reduce((k,A)=>k+(A.spent||0),0),r.reduce((k,A)=>k+(A.remaining||0),0);const v=r.filter(k=>k.status==="active"),x=r.filter(k=>k.status==="upcoming"),j=r.filter(k=>k.status==="completed"),N=k=>k.reduce((A,B)=>({totalBudget:A.totalBudget+(B?.totalBudget||0),spent:A.spent+(B?.spent||0),remaining:A.remaining+(B?.remaining||0),count:A.count+1}),{totalBudget:0,spent:0,remaining:0,count:0}),S=N(v),_=N(x),E=N(j);return s.jsx("div",{className:"max-w-6xl mx-auto px-4 py-6",children:s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(Ne,{to:"/",className:"flex items-center justify-center w-10 h-10 rounded-full bg-surface-elevated hover:bg-surface-elevated/80 transition-colors",children:s.jsx(ct,{className:"w-5 h-5 text-foreground"})}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Trip Budget Planner"}),s.jsx("p",{className:"text-muted-foreground mt-1",children:"Keep your travel expenses organized and on track."})]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(fs,{value:t,onValueChange:g,children:[s.jsx(Qt,{className:"w-24",children:s.jsx(ps,{})}),s.jsxs(Xt,{children:[s.jsx(ae,{value:"USD",children:"USD ($)"}),s.jsx(ae,{value:"EUR",children:"EUR ()"}),s.jsx(ae,{value:"GBP",children:"GBP ()"}),s.jsx(ae,{value:"JPY",children:"JPY ()"}),s.jsx(ae,{value:"CNY",children:"CNY ()"}),s.jsx(ae,{value:"INR",children:"INR ()"}),s.jsx(ae,{value:"CAD",children:"CAD (C$)"}),s.jsx(ae,{value:"AUD",children:"AUD (A$)"}),s.jsx(ae,{value:"RUB",children:"RUB ()"}),s.jsx(ae,{value:"BRL",children:"BRL (R$)"})]})]}),s.jsxs(ut,{open:h,onOpenChange:m,children:[s.jsx(Gr,{asChild:!0,children:s.jsxs(P,{className:"bg-gradient-primary text-white shadow-primary",children:[s.jsx(Qe,{className:"w-4 h-4 mr-2"}),"Create New"]})}),s.jsxs(st,{children:[s.jsx(rt,{children:s.jsx(at,{children:"Create New Budget"})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(J,{htmlFor:"title",children:"Trip Title"}),s.jsx(se,{id:"title",placeholder:"Enter trip title",value:p.title||"",onChange:k=>f(A=>({...A,title:k.target.value}))})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(J,{htmlFor:"destination",children:"Destination"}),s.jsx(se,{id:"destination",placeholder:"Enter destination",value:p.destination||"",onChange:k=>f(A=>({...A,destination:k.target.value}))})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(J,{htmlFor:"startDate",children:"Start Date"}),s.jsx(se,{id:"startDate",type:"date",value:p.startDate||"",onChange:k=>f(A=>({...A,startDate:k.target.value}))})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(J,{htmlFor:"endDate",children:"End Date"}),s.jsx(se,{id:"endDate",type:"date",value:p.endDate||"",onChange:k=>f(A=>({...A,endDate:k.target.value}))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsxs(J,{htmlFor:"budget",children:["Budget Amount (",t,")"]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",id:"noMaxBudget",className:"mr-2",checked:p.noMaxBudget||!1,onChange:k=>f(A=>({...A,noMaxBudget:k.target.checked}))}),s.jsx(J,{htmlFor:"noMaxBudget",className:"text-sm",children:"No Max Budget"})]})]}),s.jsx(se,{id:"budget",type:"number",placeholder:"0.00",value:p.totalBudget||"",onChange:k=>f(A=>({...A,totalBudget:Number(k.target.value)})),disabled:p.noMaxBudget})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(J,{htmlFor:"status",children:"Status"}),s.jsxs(fs,{value:p.status||"active",onValueChange:k=>f(A=>({...A,status:k})),children:[s.jsx(Qt,{children:s.jsx(ps,{})}),s.jsxs(Xt,{children:[s.jsx(ae,{value:"active",children:"Active"}),s.jsx(ae,{value:"upcoming",children:"Upcoming"})]})]})]}),s.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[s.jsx(P,{variant:"outline",onClick:()=>m(!1),children:"Cancel"}),s.jsx(P,{className:"bg-gradient-primary text-white",onClick:w,disabled:c,children:c?s.jsxs(s.Fragment,{children:[s.jsx(ge,{className:"w-4 h-4 mr-2 animate-spin"}),"Creating..."]}):"Create Budget"})]})]})]})]})]})]}),s.jsxs(Zt,{defaultValue:"active",className:"space-y-6",children:[s.jsxs($t,{className:"grid w-full grid-cols-3",children:[s.jsx(ye,{value:"active",children:"Active"}),s.jsx(ye,{value:"upcoming",children:"Upcoming"}),s.jsx(ye,{value:"completed",children:"Completed"})]}),s.jsx(be,{value:"active",className:"space-y-6",children:n?s.jsxs("div",{className:"flex items-center justify-center py-12",children:[s.jsx(ge,{className:"w-8 h-8 animate-spin text-primary"}),s.jsx("span",{className:"ml-2 text-muted-foreground",children:"Loading budgets..."})]}):i?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("p",{className:"text-red-500 mb-4",children:i}),s.jsx(P,{onClick:()=>window.location.reload(),variant:"outline",children:"Try Again"})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[s.jsx(V,{className:"bg-surface-elevated",children:s.jsx(G,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:s.jsx(ir,{className:"w-5 h-5 text-primary"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Budgeted"}),s.jsxs("p",{className:"text-lg font-semibold",children:[y(t),(S?.totalBudget||0).toLocaleString()]})]})]})})}),s.jsx(V,{className:"bg-surface-elevated",children:s.jsx(G,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-destructive/10 rounded-lg",children:s.jsx(Or,{className:"w-5 h-5 text-destructive"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Spent"}),s.jsxs("p",{className:"text-lg font-semibold",children:[y(t),(S?.spent||0).toLocaleString()]})]})]})})}),s.jsx(V,{className:"bg-surface-elevated",children:s.jsx(G,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-success/10 rounded-lg",children:s.jsx(Da,{className:"w-5 h-5 text-success"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Remaining"}),s.jsxs("p",{className:"text-lg font-semibold",children:[y(t),(S?.remaining||0).toLocaleString()]})]})]})})}),s.jsx(V,{className:"bg-surface-elevated",children:s.jsx(G,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-warning/10 rounded-lg",children:s.jsx(Be,{className:"w-5 h-5 text-warning"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Active Trips"}),s.jsx("p",{className:"text-lg font-semibold",children:S.count})]})]})})})]}),s.jsx(po,{budgets:v,currency:t})]})}),s.jsx(be,{value:"upcoming",className:"space-y-6",children:n?s.jsxs("div",{className:"flex items-center justify-center py-12",children:[s.jsx(ge,{className:"w-8 h-8 animate-spin text-primary"}),s.jsx("span",{className:"ml-2 text-muted-foreground",children:"Loading budgets..."})]}):i?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("p",{className:"text-red-500 mb-4",children:i}),s.jsx(P,{onClick:()=>window.location.reload(),variant:"outline",children:"Try Again"})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[s.jsx(V,{className:"bg-surface-elevated",children:s.jsx(G,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:s.jsx(ir,{className:"w-5 h-5 text-primary"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Budgeted"}),s.jsxs("p",{className:"text-lg font-semibold",children:[y(t),(_?.totalBudget||0).toLocaleString()]})]})]})})}),s.jsx(V,{className:"bg-surface-elevated",children:s.jsx(G,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-destructive/10 rounded-lg",children:s.jsx(Or,{className:"w-5 h-5 text-destructive"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Spent"}),s.jsxs("p",{className:"text-lg font-semibold",children:[y(t),(_?.spent||0).toLocaleString()]})]})]})})}),s.jsx(V,{className:"bg-surface-elevated",children:s.jsx(G,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-success/10 rounded-lg",children:s.jsx(Da,{className:"w-5 h-5 text-success"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Remaining"}),s.jsxs("p",{className:"text-lg font-semibold",children:[y(t),(_?.remaining||0).toLocaleString()]})]})]})})}),s.jsx(V,{className:"bg-surface-elevated",children:s.jsx(G,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-warning/10 rounded-lg",children:s.jsx(Be,{className:"w-5 h-5 text-warning"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Upcoming Trips"}),s.jsx("p",{className:"text-lg font-semibold",children:_.count})]})]})})})]}),s.jsx(po,{budgets:x,currency:t})]})}),s.jsx(be,{value:"completed",className:"space-y-6",children:n?s.jsxs("div",{className:"flex items-center justify-center py-12",children:[s.jsx(ge,{className:"w-8 h-8 animate-spin text-primary"}),s.jsx("span",{className:"ml-2 text-muted-foreground",children:"Loading budgets..."})]}):i?s.jsxs("div",{className:"text-center py-12",children:[s.jsx("p",{className:"text-red-500 mb-4",children:i}),s.jsx(P,{onClick:()=>window.location.reload(),variant:"outline",children:"Try Again"})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[s.jsx(V,{className:"bg-surface-elevated",children:s.jsx(G,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:s.jsx(ir,{className:"w-5 h-5 text-primary"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Budgeted"}),s.jsxs("p",{className:"text-lg font-semibold",children:[y(t),(E?.totalBudget||0).toLocaleString()]})]})]})})}),s.jsx(V,{className:"bg-surface-elevated",children:s.jsx(G,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-destructive/10 rounded-lg",children:s.jsx(Or,{className:"w-5 h-5 text-destructive"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Spent"}),s.jsxs("p",{className:"text-lg font-semibold",children:[y(t),(E?.spent||0).toLocaleString()]})]})]})})}),s.jsx(V,{className:"bg-surface-elevated",children:s.jsx(G,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-success/10 rounded-lg",children:s.jsx(Da,{className:"w-5 h-5 text-success"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Remaining"}),s.jsxs("p",{className:"text-lg font-semibold",children:[y(t),(E?.remaining||0).toLocaleString()]})]})]})})}),s.jsx(V,{className:"bg-surface-elevated",children:s.jsx(G,{className:"p-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-warning/10 rounded-lg",children:s.jsx(Be,{className:"w-5 h-5 text-warning"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Completed Trips"}),s.jsx("p",{className:"text-lg font-semibold",children:E.count})]})]})})})]}),s.jsx(po,{budgets:j,currency:t})]})})]})]})})},po=({budgets:t,currency:e})=>{const r=Ls(),n=(o=>{switch(o){case"EUR":return"";case"GBP":return"";case"JPY":return"";case"CNY":return"";case"INR":return"";case"CAD":return"C$";case"AUD":return"A$";case"RUB":return"";case"BRL":return"R$";default:return"$"}})(e);return t.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(ir,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No budgets found"}),s.jsx("p",{className:"text-muted-foreground",children:"Create your first trip budget to get started!"})]}):s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(o=>s.jsx(V,{className:"overflow-hidden hover:shadow-lg transition-all duration-300 cursor-pointer group",children:s.jsxs(Ne,{to:`/budget/${o.id}`,children:[s.jsxs(_e,{className:"pb-3",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsx(Ee,{className:"text-lg line-clamp-1",children:o.title}),s.jsx(Le,{className:`${o.status==="active"?"bg-success text-success-foreground":o.status==="upcoming"?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"}`,children:o.status.charAt(0).toUpperCase()+o.status.slice(1)})]}),s.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[s.jsx(Ie,{className:"w-3 h-3"}),o.destination]}),s.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[s.jsx(Be,{className:"w-3 h-3"}),o.startDate&&o.endDate?`${new Date(o.startDate).toLocaleDateString("en-US",{month:"short",day:"numeric"})} - ${new Date(o.endDate).toLocaleDateString("en-US",{month:"short",day:"numeric"})}`:"Dates not set"]})]}),s.jsx(G,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsx("span",{children:"Budget Progress"}),s.jsxs("span",{children:[o.progress,"%"]})]}),s.jsx(sn,{value:o.progress,className:"h-2"})]}),s.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Budget"}),s.jsxs("p",{className:"font-semibold",children:[n,(o?.totalBudget||0).toLocaleString()]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-muted-foreground",children:"Spent"}),s.jsxs("p",{className:"font-semibold text-destructive",children:[n,(o?.spent||0).toLocaleString()]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-muted-foreground",children:"Remaining"}),s.jsxs("p",{className:"font-semibold text-success",children:[n,(o?.remaining||0).toLocaleString()]})]})]}),s.jsx(P,{size:"sm",className:"w-full bg-gradient-primary text-white",onClick:i=>{i.preventDefault(),i.stopPropagation(),r(`/budget/${o.id}`)},children:"View & Add Expenses"})]})})]})},o.id))})},Z_="/images/hero-beach.jpg";function Ba(t,e=Z_,r="Failed to load image",a=!1){const n=t.target;n.onerror=null,n.src=e,console.error(r),a&&ee({title:"Image Error",description:"Failed to load image. Using placeholder instead.",variant:"destructive"})}class eC{async getWalletDetails(e){try{const{data:r,error:a}=await le.from("wallets").select("*").eq("user_id",e).single();if(a&&a.code!=="PGRST116")throw new Error(a.message||"Failed to fetch wallet");let n;if(r)n=r;else{const{data:l,error:c}=await le.from("wallets").insert({user_id:e,balance:0,currency:"INR"}).select().single();if(c)throw new Error(c.message||"Failed to create wallet");n=l}const{data:o,error:i}=await le.from("wallet_transactions").select("*").eq("wallet_id",n.id).order("created_at",{ascending:!1}).limit(50);return i&&console.error("Error fetching transactions:",i),{wallet:n,transactions:o||[],recentTransactions:(o||[]).slice(0,10)}}catch(r){throw console.error("Error getting wallet details:",r),new Error(r.message||"Failed to get wallet details")}}async addFunds(e){try{const{data:{session:r},error:a}=await le.auth.getSession();if(a||!r?.user)throw new Error("Please log in to add funds");if(e<=0||e<100)throw new Error("Minimum amount is 100");const n=await ot(),{endpoints:o}=await we(async()=>{const{endpoints:l}=await Promise.resolve().then(()=>Ve);return{endpoints:l}},void 0,import.meta.url),i=await te(K(o.wallet.createOrder),{method:"POST",headers:n,body:{amount:Math.round(e*100),currency:"INR",receipt:`wallet_${r.user.id}_${Date.now()}`}});if(!i.success||!i.data)throw new Error(i.message||"Failed to create payment order");return{orderId:i.data.id,razorpayOrder:i.data}}catch(r){throw console.error("Error creating payment order:",r),new Error(r.message||"Failed to create payment order")}}async processDeposit(e,r,a){try{const{data:{session:n},error:o}=await le.auth.getSession();if(o||!n?.user)throw new Error("Please log in to process payment");const{data:i,error:l}=await le.rpc("process_wallet_transaction",{p_user_id:n.user.id,p_amount:e,p_type:"deposit",p_description:"Wallet deposit via Razorpay",p_reference_id:r});if(l)throw new Error(l.message||"Failed to process wallet transaction");if(!i||!i.success)throw new Error("Transaction failed");return await this.getWalletDetails(n.user.id)}catch(n){throw console.error("Error processing deposit:",n),new Error(n.message||"Failed to process deposit")}}async processTripPayment(e){try{const{data:{session:r},error:a}=await le.auth.getSession();if(a||!r?.user)throw new Error("Please log in to process payment");const o=(await this.getWalletDetails(r.user.id)).wallet.balance,i=Math.min(o,e),l=Math.max(0,e-o),c=l>0;return{walletAmountUsed:i,razorpayAmount:l,needsRazorpay:c,walletBalance:o}}catch(r){throw console.error("Error processing trip payment:",r),new Error(r.message||"Failed to process trip payment")}}async deductForTrip(e,r,a){try{const{data:{session:n},error:o}=await le.auth.getSession();if(o||!n?.user)throw new Error("Please log in to process payment");const{data:i,error:l}=await le.rpc("process_wallet_transaction",{p_user_id:n.user.id,p_amount:-e,p_type:"booking_payment",p_description:a||`Trip payment for trip ${r}`,p_reference_id:`trip_${r}_${Date.now()}`});if(l)throw new Error(l.message||"Failed to process wallet transaction");if(!i||!i.success)throw new Error("Transaction failed");return await this.getWalletDetails(n.user.id)}catch(n){throw console.error("Error deducting for trip:",n),new Error(n.message||"Failed to deduct from wallet")}}async requestWithdrawal(e){try{const{data:{session:r},error:a}=await le.auth.getSession();if(a||!r?.user)throw new Error("Please log in to request withdrawal");if(e<=0)throw new Error("Amount must be greater than zero");if((await this.getWalletDetails(r.user.id)).wallet.balance<e)throw new Error("Insufficient wallet balance");const{data:o,error:i}=await le.rpc("process_wallet_transaction",{p_user_id:r.user.id,p_amount:-e,p_type:"withdrawal",p_description:"Withdrawal request - Contact support for payout",p_reference_id:`withdrawal_${Date.now()}`});if(i)throw new Error(i.message||"Failed to process withdrawal");if(!o||!o.success)throw new Error("Withdrawal request failed");return await this.getWalletDetails(r.user.id)}catch(r){throw console.error("Error processing withdrawal:",r),new Error(r.message||"Failed to process withdrawal")}}}const pr=new eC,Lf=({open:t,onOpenChange:e,onSuccess:r})=>{const{user:a}=mt(),[n,o]=u.useState(""),[i,l]=u.useState(!1),c=[500,1e3,2e3,5e3],d=m=>{o(m.toString())},h=async()=>{const m=parseFloat(n);if(!m||m<100){ee({title:"Invalid Amount",description:"Minimum amount is 100",variant:"destructive"});return}if(!a?.id){ee({title:"Error",description:"Please log in to add money",variant:"destructive"});return}try{l(!0);const{orderId:p,razorpayOrder:f}=await pr.addFunds(m),b=document.createElement("script");b.src="https://checkout.razorpay.com/v1/checkout.js",b.async=!0,b.onload=()=>{const g={key:"",amount:f.amount,currency:f.currency,name:"WanderSphere",description:"Add money to wallet",order_id:p,handler:async w=>{try{await pr.processDeposit(m,w.razorpay_payment_id,w.razorpay_order_id),ee({title:"Success",description:`${m} added to your wallet successfully!`}),e(!1),o(""),r&&r()}catch(v){ee({title:"Error",description:v.message||"Failed to process payment",variant:"destructive"})}finally{l(!1)}},prefill:{email:a.email||"",name:`${a.firstName} ${a.lastName}`.trim()||"User"},theme:{color:"#6366f1"},modal:{ondismiss:()=>{l(!1)}}},y=new window.Razorpay(g);y.open(),y.on("payment.failed",w=>{ee({title:"Payment Failed",description:w.error.description||"Payment could not be processed",variant:"destructive"}),l(!1)})},b.onerror=()=>{ee({title:"Error",description:"Failed to load payment gateway",variant:"destructive"}),l(!1)},document.body.appendChild(b)}catch(p){console.error("Error initiating payment:",p),ee({title:"Error",description:p.message||"Failed to initiate payment",variant:"destructive"}),l(!1)}};return s.jsx(ut,{open:t,onOpenChange:e,children:s.jsxs(st,{className:"sm:max-w-md",children:[s.jsx(rt,{children:s.jsxs(at,{className:"flex items-center gap-2",children:[s.jsx(Qr,{className:"w-5 h-5"}),"Add Money to Wallet"]})}),s.jsxs("div",{className:"space-y-6 py-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Amount ()"}),s.jsx(se,{type:"number",placeholder:"Enter amount",value:n,onChange:m=>o(m.target.value),min:"100",step:"100",className:"text-lg"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Minimum: 100"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium mb-2",children:"Quick Add"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:c.map(m=>s.jsxs(P,{variant:"outline",size:"sm",onClick:()=>d(m),className:n===m.toString()?"bg-primary text-primary-foreground":"",children:["+",m.toLocaleString()]},m))})]}),s.jsx(P,{onClick:h,disabled:i||!n||parseFloat(n)<100,className:"w-full bg-gradient-to-r from-primary to-primary/80",children:i?s.jsxs(s.Fragment,{children:[s.jsx(ge,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):"Proceed to Pay"})]})]})})},tC=()=>{const{user:t}=mt(),[e,r]=u.useState(null),[a,n]=u.useState(!0),[o,i]=u.useState(!1),[l,c]=u.useState(!1),[d,h]=u.useState(""),[m,p]=u.useState(!1),f=async()=>{if(!t?.id){n(!1);return}try{n(!0);const j=await pr.getWalletDetails(t.id);r(j)}catch(j){console.error("Error fetching wallet details:",j),ee({title:"Error",description:j.message||"Failed to load wallet details",variant:"destructive"})}finally{n(!1)}};u.useEffect(()=>{f()},[t?.id]);const b=()=>{f()},g=async()=>{const j=parseFloat(d);if(!j||j<=0){ee({title:"Invalid Amount",description:"Please enter a valid amount",variant:"destructive"});return}if(!e||e.wallet.balance<j){ee({title:"Insufficient Balance",description:"You don't have enough balance in your wallet",variant:"destructive"});return}try{p(!0),await pr.requestWithdrawal(j),ee({title:"Withdrawal Requested",description:"Your withdrawal request has been submitted. Please contact support for payout processing."}),c(!1),h(""),f()}catch(N){ee({title:"Error",description:N.message||"Failed to process withdrawal",variant:"destructive"})}finally{p(!1)}},y=j=>({deposit:"Deposit",booking_payment:"Booking Payment",refund:"Refund",withdrawal:"Withdrawal",cashback:"Cashback"})[j]||j,w=j=>new Date(j).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"});if(a)return s.jsx("div",{className:"max-w-4xl mx-auto px-4 py-6 flex items-center justify-center min-h-[400px]",children:s.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[s.jsx(ge,{className:"w-6 h-6 animate-spin"}),s.jsx("span",{children:"Loading wallet..."})]})});if(!t)return s.jsx("div",{className:"max-w-4xl mx-auto px-4 py-6",children:s.jsx(V,{children:s.jsx(G,{className:"p-8 text-center",children:s.jsx("p",{className:"text-muted-foreground",children:"Please log in to view your wallet"})})})});const v=e?.wallet.balance||0,x=e?.recentTransactions||[];return s.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6",children:[s.jsxs("div",{className:"mb-6",children:[s.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Nomad Wallet"}),s.jsx("p",{className:"text-muted-foreground",children:"Manage your travel funds"})]}),s.jsx(V,{className:"bg-gradient-to-r from-primary to-primary/80 text-white mb-6",children:s.jsx(G,{className:"p-8",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm opacity-90 mb-2",children:"Available Balance"}),s.jsxs("p",{className:"text-5xl font-bold",children:["",v.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsxs("p",{className:"text-sm opacity-80 mt-2",children:["Currency: ",e?.wallet.currency||"INR"]})]}),s.jsx("div",{className:"p-4 bg-white/20 rounded-full",children:s.jsx(Qr,{className:"w-12 h-12"})})]})})}),s.jsxs("div",{className:"flex gap-4 mb-6",children:[s.jsxs(P,{onClick:()=>i(!0),className:"flex-1 bg-green-600 hover:bg-green-700 text-white",size:"lg",children:[s.jsx(Qe,{className:"w-5 h-5 mr-2"}),"Add Money"]}),s.jsxs(P,{onClick:()=>c(!0),variant:"outline",className:"flex-1",size:"lg",disabled:v===0,children:[s.jsx(il,{className:"w-5 h-5 mr-2"}),"Withdraw"]})]}),s.jsxs(V,{children:[s.jsx(_e,{children:s.jsxs(Ee,{className:"flex items-center gap-2",children:[s.jsx(ll,{className:"w-5 h-5"}),"Transaction History"]})}),s.jsx(G,{children:x.length===0?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(ll,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4 opacity-50"}),s.jsx("p",{className:"text-muted-foreground",children:"No transactions yet"}),s.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Start by adding money to your wallet"})]}):s.jsx("div",{className:"space-y-3",children:x.map(j=>{const N=j.amount>0;return s.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50 transition-colors",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx("div",{className:`p-3 rounded-full ${N?"bg-green-100 text-green-600":"bg-red-100 text-red-600"}`,children:N?s.jsx(bp,{className:"w-5 h-5"}):s.jsx(il,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:y(j.type)}),s.jsx("p",{className:"text-sm text-muted-foreground",children:j.description||"No description"}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:w(j.created_at)})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:`font-bold text-lg ${N?"text-green-600":"text-red-600"}`,children:[N?"+":"-","",Math.abs(j.amount).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]}),s.jsx("p",{className:`text-xs mt-1 ${j.status==="completed"?"text-green-600":j.status==="pending"?"text-yellow-600":"text-red-600"}`,children:j.status.charAt(0).toUpperCase()+j.status.slice(1)})]})]},j.id)})})})]}),s.jsx(Lf,{open:o,onOpenChange:i,onSuccess:b}),s.jsx(ut,{open:l,onOpenChange:c,children:s.jsxs(st,{children:[s.jsx(rt,{children:s.jsx(at,{children:"Request Withdrawal"})}),s.jsxs("div",{className:"space-y-4 py-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Amount ()"}),s.jsx(se,{type:"number",placeholder:"Enter amount",value:d,onChange:j=>h(j.target.value),min:"1",max:v.toString(),step:"0.01"}),s.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Available balance: ",v.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),s.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:s.jsxs("p",{className:"text-sm text-yellow-800",children:[s.jsx("strong",{children:"Note:"})," Withdrawal requests are processed manually. Please contact support for payout processing."]})}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx(P,{variant:"outline",onClick:()=>{c(!1),h("")},className:"flex-1",children:"Cancel"}),s.jsx(P,{onClick:g,disabled:m||!d||parseFloat(d)<=0||parseFloat(d)>v,className:"flex-1",children:m?s.jsxs(s.Fragment,{children:[s.jsx(ge,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):"Request Withdrawal"})]})]})]})})]})},rn=""+new URL("street-food-DbwOjaMu.jpg",import.meta.url).href,On=""+new URL("castle-europe-BD18iVCr.jpg",import.meta.url).href,sC=""+new URL("travel-community-DKENGzcf.jpg",import.meta.url).href,rC=()=>{const{user:t}=mt(),[e,r]=u.useState(!1),[a,n]=u.useState(!1),[o,i]=u.useState(null),[l,c]=u.useState([]),[d,h]=u.useState([]),[m,p]=u.useState(!0),[f,b]=u.useState(!1),[g,y]=u.useState(!1),[w,v]=u.useState([]),[x,j]=u.useState(!1),[N,S]=u.useState(!1),_=u.useRef(null),E=async()=>{if(!x)try{j(!0);const R=await As.getMyJourneys("published");v(R.data?.journeys||[])}catch(R){console.error("Failed to fetch user journeys:",R),v([])}finally{j(!1)}},k=async R=>{const M=R.target.files?.[0];if(M){if(!M.type.startsWith("image/")){ee({title:"Invalid file type",description:"Please select an image file.",variant:"destructive"});return}if(M.size>5*1024*1024){ee({title:"File too large",description:"Please select an image smaller than 5MB.",variant:"destructive"});return}try{S(!0);const C=await et.uploadAvatar(M);o&&i({...o,avatar:C.avatarUrl}),ee({title:"Success",description:"Profile photo updated successfully!"})}catch(C){console.error("Failed to upload avatar:",C),ee({title:"Upload failed",description:"Failed to update profile photo. Please try again.",variant:"destructive"})}finally{S(!1),_.current&&(_.current.value="")}}},A=()=>{_.current?.click()},B=[{id:1,image:Jr,user:"sarah_travels"},{id:2,image:rn,user:"foodie_explorer"},{id:3,image:On,user:"historic_wanderer"}],$=[{id:1,image:sC,user:"travel_squad",location:"Bali, Indonesia"},{id:2,image:Yt,user:"sunset_chasers",location:"Maldives"}];u.useEffect(()=>{(async()=>{if(t)try{p(!0);const M=await et.getProfile();i(M)}catch(M){console.error("Failed to fetch user profile:",M),t&&i({...t,name:`${t.firstName} ${t.lastName}`.trim(),verified:t.isVerified||!1,followersCount:t.stats?.followersCount||0,followingCount:t.stats?.followingCount||0,tripsCount:t.stats?.tripsCompleted||0,journeysCount:0,stats:{countriesVisited:t.stats?.countriesVisited||0,citiesVisited:t.stats?.citiesVisited||0,totalDistance:t.stats?.totalDistance||0,totalTrips:t.stats?.tripsCompleted||0},preferences:{travelStyle:t.preferences?.travelPreferences?.travelStyle?[t.preferences.travelPreferences.travelStyle]:[],budget:"mid-range",interests:t.preferences?.travelPreferences?.interests||[],languages:["English"]},socialLinks:{}})}finally{p(!1)}})(),E()},[t]);const H=async()=>{if(!(f||l.length>0))try{b(!0);const R=await et.getFollowers();c(R.data||[])}catch(R){console.error("Failed to fetch followers:",R)}finally{b(!1)}},O=async()=>{if(!(g||d.length>0))try{y(!0);const R=await et.getFollowing();h(R.data||[])}catch(R){console.error("Failed to fetch following:",R)}finally{y(!1)}},Y=async(R,M)=>{try{M?await et.unfollowUser(R):await et.followUser(R),c(C=>C.map(q=>q.id===R?{...q,isFollowing:!M}:q)),h(C=>C.map(q=>q.id===R?{...q,isFollowing:!M}:q))}catch(C){console.error("Failed to toggle follow:",C)}},z=R=>`Joined ${new Date(R).toLocaleDateString("en-US",{month:"long",year:"numeric"})}`;return m||!o?s.jsx("div",{className:"max-w-4xl mx-auto px-4 py-6 flex items-center justify-center min-h-[400px]",children:s.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[s.jsx(ge,{className:"w-6 h-6 animate-spin"}),s.jsx("span",{children:"Loading profile..."})]})}):s.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6",children:[s.jsx(V,{className:"bg-surface-elevated mb-8",children:s.jsx(G,{className:"p-6",children:s.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:items-start gap-6",children:[s.jsxs("div",{className:"relative group",children:[s.jsxs(Pe,{className:"w-32 h-32 cursor-pointer",onClick:A,children:[s.jsx(Ae,{src:o.avatar||""}),s.jsx(Re,{className:"bg-primary text-primary-foreground text-4xl",children:o.name?o.name.split(" ").map(R=>R[0]).join(""):"U"})]}),N&&s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 rounded-full flex items-center justify-center",children:s.jsx(ge,{className:"w-6 h-6 text-white animate-spin"})}),s.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 rounded-full transition-all duration-200 flex items-center justify-center opacity-0 group-hover:opacity-100",children:s.jsx(lt,{className:"w-6 h-6 text-white"})}),s.jsx("input",{ref:_,type:"file",accept:"image/*",onChange:k,className:"hidden"})]}),s.jsxs("div",{className:"flex-1 text-center sm:text-left",children:[s.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-4 mb-4",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-foreground",children:o.name||`${t?.firstName} ${t?.lastName}`.trim()}),s.jsxs("p",{className:"text-muted-foreground",children:["@",o.username||t?.username]})]}),s.jsx("div",{className:"flex gap-2",children:s.jsx(P,{asChild:!0,variant:"secondary",children:s.jsxs(Ne,{to:"/settings",children:[s.jsx(ei,{className:"w-4 h-4 mr-2"}),"Edit Profile"]})})})]}),s.jsx("p",{className:"text-foreground mb-4 max-w-md",children:o.bio||"No bio available"}),s.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-4 text-sm text-muted-foreground mb-4",children:[o.location&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Ie,{className:"w-4 h-4"}),o.location]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Be,{className:"w-4 h-4"}),z(o.createdAt||t?.createdAt||new Date().toISOString())]})]}),s.jsxs("div",{className:"flex justify-center sm:justify-start gap-8",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-xl font-bold text-foreground",children:w.length}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Posts"})]}),s.jsxs(ut,{open:e,onOpenChange:R=>{r(R),R&&H()},children:[s.jsx(Gr,{asChild:!0,children:s.jsxs("button",{className:"text-center hover:opacity-70 transition-opacity",children:[s.jsx("p",{className:"text-xl font-bold text-foreground",children:o.followersCount?.toLocaleString()||"0"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Followers"})]})}),s.jsxs(st,{children:[s.jsx(rt,{children:s.jsx(at,{children:"Followers"})}),s.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:f?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(ge,{className:"w-6 h-6 animate-spin"})}):l.length>0?l.map(R=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(Pe,{className:"w-10 h-10",children:[s.jsx(Ae,{src:R.avatar||""}),s.jsx(Re,{className:"bg-primary text-primary-foreground",children:R.name?R.name.split(" ").map(M=>M[0]).join(""):"U"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:R.name}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["@",R.username]})]})]}),s.jsx(P,{size:"sm",variant:R.isFollowing?"secondary":"default",onClick:()=>Y(R.id,R.isFollowing),children:R.isFollowing?"Following":"Follow"})]},R.id)):s.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No followers yet"})})]})]}),s.jsxs(ut,{open:a,onOpenChange:R=>{n(R),R&&O()},children:[s.jsx(Gr,{asChild:!0,children:s.jsxs("button",{className:"text-center hover:opacity-70 transition-opacity",children:[s.jsx("p",{className:"text-xl font-bold text-foreground",children:o.followingCount?.toLocaleString()||"0"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Following"})]})}),s.jsxs(st,{children:[s.jsx(rt,{children:s.jsx(at,{children:"Following"})}),s.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:g?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsx(ge,{className:"w-6 h-6 animate-spin"})}):d.length>0?d.map(R=>s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(Pe,{className:"w-10 h-10",children:[s.jsx(Ae,{src:R.avatar||""}),s.jsx(Re,{className:"bg-primary text-primary-foreground",children:R.name?R.name.split(" ").map(M=>M[0]).join(""):"U"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium",children:R.name}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:["@",R.username]})]})]}),s.jsx(P,{size:"sm",variant:"secondary",onClick:()=>Y(R.id,!0),children:"Following"})]},R.id)):s.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Not following anyone yet"})})]})]})]})]})]})})}),s.jsxs(Zt,{defaultValue:"posts",className:"space-y-6",children:[s.jsxs($t,{className:"grid w-full grid-cols-4",children:[s.jsxs(ye,{value:"posts",className:"flex items-center gap-2",children:[s.jsx(cl,{className:"w-4 h-4"}),"Posts"]}),s.jsxs(ye,{value:"wallet",className:"flex items-center gap-2",children:[s.jsx(Qr,{className:"w-4 h-4"}),"Wallet"]}),s.jsxs(ye,{value:"saved",className:"flex items-center gap-2",children:[s.jsx(za,{className:"w-4 h-4"}),"Saved"]}),s.jsxs(ye,{value:"tagged",className:"flex items-center gap-2",children:[s.jsx(dl,{className:"w-4 h-4"}),"Tagged"]})]}),s.jsx(be,{value:"wallet",children:s.jsx(tC,{})}),s.jsx(be,{value:"posts",children:s.jsx("div",{className:"grid grid-cols-3 gap-1",children:x?Array.from({length:6}).map((R,M)=>s.jsx("div",{className:"aspect-square bg-gray-200 animate-pulse"},M)):w.length>0?w.map(R=>s.jsxs("div",{className:"aspect-square relative group cursor-pointer overflow-hidden",children:[s.jsx("img",{src:R.images?.[0]||Yt,alt:R.title,className:"w-full h-full object-cover",onError:M=>Ba(M,"/images/hero-beach.jpg",`Failed to load journey image for ${R.title}`)}),s.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:s.jsxs("div",{className:"flex items-center gap-4 text-white",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Ht,{className:`w-5 h-5 fill-current ${R.isLiked?"text-red-500":""}`}),s.jsx("span",{className:"font-medium",children:R.likeCount||0})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(us,{className:"w-5 h-5 fill-current"}),s.jsx("span",{className:"font-medium",children:R.commentCount||0})]})]})}),!R.isPublic&&s.jsx("div",{className:"absolute top-2 right-2",children:s.jsx(Gc,{className:"w-4 h-4 text-white drop-shadow-lg"})})]},R.id)):s.jsx("div",{className:"col-span-3 text-center py-12",children:s.jsxs("div",{className:"text-muted-foreground",children:[s.jsx(cl,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),s.jsx("p",{className:"text-lg font-medium mb-2",children:"No posts yet"}),s.jsx("p",{className:"text-sm",children:"Start sharing your travel journeys!"})]})})})}),s.jsx(be,{value:"saved",children:B.length>0?s.jsx("div",{className:"grid grid-cols-3 gap-1",children:B.map(R=>s.jsxs("div",{className:"aspect-square relative group cursor-pointer overflow-hidden",children:[s.jsx("img",{src:R.image,alt:"Saved post",className:"w-full h-full object-cover",onError:M=>Ba(M,"/images/hero-beach.jpg","Failed to load saved post image")}),s.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:s.jsx("div",{className:"text-white text-center",children:s.jsxs("p",{className:"font-medium",children:["@",R.user]})})})]},R.id))}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx(za,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No saved posts yet"}),s.jsx("p",{className:"text-muted-foreground",children:"Save posts you want to revisit later"})]})}),s.jsx(be,{value:"tagged",children:$.length>0?s.jsx("div",{className:"grid grid-cols-3 gap-1",children:$.map(R=>s.jsxs("div",{className:"aspect-square relative group cursor-pointer overflow-hidden",children:[s.jsx("img",{src:R.image,alt:"Tagged post",className:"w-full h-full object-cover",onError:M=>Ba(M,"/images/hero-beach.jpg","Failed to load tagged post image")}),s.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:s.jsxs("div",{className:"text-white text-center",children:[s.jsxs("p",{className:"font-medium",children:["@",R.user]}),s.jsx("p",{className:"text-sm opacity-80",children:R.location})]})})]},R.id))}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx(dl,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No tagged posts yet"}),s.jsx("p",{className:"text-muted-foreground",children:"Posts you're tagged in will appear here"})]})})]})]})};var aC="Separator",Mc="horizontal",nC=["horizontal","vertical"],$f=u.forwardRef((t,e)=>{const{decorative:r,orientation:a=Mc,...n}=t,o=oC(a)?a:Mc,l=r?{role:"none"}:{"aria-orientation":o==="vertical"?o:void 0,role:"separator"};return s.jsx(ne.div,{"data-orientation":o,...l,...n,ref:e})});$f.displayName=aC;function oC(t){return nC.includes(t)}var Ff=$f;const Tt=u.forwardRef(({className:t,orientation:e="horizontal",decorative:r=!0,...a},n)=>s.jsx(Ff,{ref:n,decorative:r,orientation:e,className:Z("shrink-0 bg-border",e==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...a}));Tt.displayName=Ff.displayName;const iC=()=>{const{toast:t}=Ct(),[e,r]=u.useState(!0),[a,n]=u.useState({profile:!1,notifications:!1,privacy:!1,password:!1}),[o,i]=u.useState({name:"",username:"",email:"",bio:"",location:"",avatar:""}),[l,c]=u.useState({likes:!0,comments:!0,follows:!0,trips:!0,clubs:!1,email:!0,push:!0}),[d,h]=u.useState({privateAccount:!1,showLocation:!0,showTravelStats:!0,allowTagging:!0}),[m,p]=u.useState({currentPassword:"",newPassword:"",confirmPassword:""});u.useEffect(()=>{(async()=>{try{r(!0);const[x,j]=await Promise.all([et.getProfile(),et.getNotificationSettings().catch(()=>l)]);i({name:x.name||"",username:x.username||"",email:x.email||"",bio:x.bio||"",location:x.location||"",avatar:x.avatar||""}),(x.privacy_settings||typeof x.is_private<"u")&&h({privateAccount:x.is_private||!1,showLocation:x.privacy_settings?.show_location??!0,showTravelStats:x.privacy_settings?.show_travel_stats??!0,allowTagging:x.privacy_settings?.allow_tagging??!0}),j&&typeof j=="object"&&c(N=>({...N,...j})),x&&h({privateAccount:x.is_private||!1,showLocation:x.preferences?.privacy?.showLocation??!0,showTravelStats:x.preferences?.privacy?.showTravelStats??!0,allowTagging:x.preferences?.privacy?.allowTagging??!0})}catch(x){console.error("Error loading user data:",x),t({title:"Error",description:"Failed to load user settings. Please refresh the page.",variant:"destructive"})}finally{r(!1)}})()},[t]);const f=async()=>{try{n(v=>({...v,profile:!0})),await et.updateProfile(o),t({title:"Profile updated",description:"Your profile has been successfully updated."})}catch(v){console.error("Error updating profile:",v),t({title:"Error",description:"Failed to update profile. Please try again.",variant:"destructive"})}finally{n(v=>({...v,profile:!1}))}},b=async()=>{try{n(v=>({...v,notifications:!0})),await et.updateNotificationSettings(l),t({title:"Notifications updated",description:"Your notification preferences have been saved."})}catch(v){console.error("Error updating notifications:",v),t({title:"Error",description:"Failed to update notification settings. Please try again.",variant:"destructive"})}finally{n(v=>({...v,notifications:!1}))}},g=async()=>{try{n(x=>({...x,privacy:!0}));const v={...d,isPrivate:d.privateAccount};await et.updatePrivacySettings(v),t({title:"Privacy settings updated",description:"Your privacy preferences have been saved."})}catch(v){console.error("Error updating privacy settings:",v),t({title:"Error",description:"Failed to update privacy settings. Please try again.",variant:"destructive"})}finally{n(v=>({...v,privacy:!1}))}},y=async()=>{if(m.newPassword!==m.confirmPassword){t({title:"Error",description:"New passwords do not match.",variant:"destructive"});return}if(m.newPassword.length<6){t({title:"Error",description:"Password must be at least 6 characters long.",variant:"destructive"});return}try{n(v=>({...v,password:!0})),await et.changePassword(m.currentPassword,m.newPassword),p({currentPassword:"",newPassword:"",confirmPassword:""}),t({title:"Password updated",description:"Your password has been successfully changed."})}catch(v){console.error("Error changing password:",v),t({title:"Error",description:"Failed to change password. Please check your current password and try again.",variant:"destructive"})}finally{n(v=>({...v,password:!1}))}},w=async()=>{try{await Ue.logout(),t({title:"Logged out",description:"You have been successfully logged out."})}catch(v){console.error("Error logging out:",v),t({title:"Error",description:"Failed to log out. Please try again.",variant:"destructive"})}};return e?s.jsx("div",{className:"max-w-4xl mx-auto px-4 py-6",children:s.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:s.jsx(ge,{className:"w-8 h-8 animate-spin"})})}):s.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Settings"}),s.jsx("p",{className:"text-muted-foreground mt-1",children:"Manage your account settings and preferences."})]}),s.jsxs(Zt,{defaultValue:"profile",className:"space-y-6",children:[s.jsxs($t,{className:"grid w-full grid-cols-4",children:[s.jsxs(ye,{value:"profile",className:"flex items-center gap-2",children:[s.jsx(jp,{className:"w-4 h-4"}),"Profile"]}),s.jsxs(ye,{value:"account",className:"flex items-center gap-2",children:[s.jsx(Gc,{className:"w-4 h-4"}),"Account"]}),s.jsxs(ye,{value:"privacy",className:"flex items-center gap-2",children:[s.jsx(Kc,{className:"w-4 h-4"}),"Privacy"]}),s.jsxs(ye,{value:"notifications",className:"flex items-center gap-2",children:[s.jsx(Dr,{className:"w-4 h-4"}),"Notifications"]})]}),s.jsx(be,{value:"profile",className:"space-y-6",children:s.jsxs(V,{children:[s.jsx(_e,{children:s.jsx(Ee,{children:"Edit Profile"})}),s.jsxs(G,{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-6",children:[s.jsxs(Pe,{className:"w-24 h-24",children:[s.jsx(Ae,{src:o.avatar}),s.jsx(Re,{className:"bg-primary text-primary-foreground text-2xl",children:o.name.split(" ").map(v=>v[0]).join("")})]}),s.jsxs(P,{variant:"outline",className:"flex items-center gap-2",children:[s.jsx(lt,{className:"w-4 h-4"}),"Change Photo"]})]}),s.jsx(Tt,{}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(J,{htmlFor:"name",children:"Full Name"}),s.jsx(se,{id:"name",value:o.name,onChange:v=>i({...o,name:v.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(J,{htmlFor:"username",children:"Username"}),s.jsx(se,{id:"username",value:o.username,onChange:v=>i({...o,username:v.target.value})})]}),s.jsxs("div",{className:"space-y-2 md:col-span-2",children:[s.jsx(J,{htmlFor:"email",children:"Email"}),s.jsx(se,{id:"email",type:"email",value:o.email,onChange:v=>i({...o,email:v.target.value})})]}),s.jsxs("div",{className:"space-y-2 md:col-span-2",children:[s.jsx(J,{htmlFor:"bio",children:"Bio"}),s.jsx(xs,{id:"bio",value:o.bio,onChange:v=>i({...o,bio:v.target.value}),className:"min-h-24"})]}),s.jsxs("div",{className:"space-y-2 md:col-span-2",children:[s.jsx(J,{htmlFor:"location",children:"Location"}),s.jsx(se,{id:"location",value:o.location,onChange:v=>i({...o,location:v.target.value})})]})]}),s.jsx(P,{onClick:f,disabled:a.profile,className:"bg-gradient-primary text-white",children:a.profile?s.jsxs(s.Fragment,{children:[s.jsx(ge,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(da,{className:"w-4 h-4 mr-2"}),"Save Changes"]})})]})]})}),s.jsxs(be,{value:"account",className:"space-y-6",children:[s.jsxs(V,{children:[s.jsx(_e,{children:s.jsx(Ee,{children:"Account Security"})}),s.jsxs(G,{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(J,{htmlFor:"current-password",children:"Current Password"}),s.jsx(se,{id:"current-password",type:"password",value:m.currentPassword,onChange:v=>p({...m,currentPassword:v.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(J,{htmlFor:"new-password",children:"New Password"}),s.jsx(se,{id:"new-password",type:"password",value:m.newPassword,onChange:v=>p({...m,newPassword:v.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(J,{htmlFor:"confirm-password",children:"Confirm New Password"}),s.jsx(se,{id:"confirm-password",type:"password",value:m.confirmPassword,onChange:v=>p({...m,confirmPassword:v.target.value})})]})]}),s.jsx(P,{onClick:y,disabled:a.password,className:"bg-gradient-primary text-white",children:a.password?s.jsxs(s.Fragment,{children:[s.jsx(ge,{className:"w-4 h-4 mr-2 animate-spin"}),"Updating..."]}):s.jsxs(s.Fragment,{children:[s.jsx(da,{className:"w-4 h-4 mr-2"}),"Update Password"]})})]})]}),s.jsxs(V,{children:[s.jsx(_e,{children:s.jsx(Ee,{children:"Account Actions"})}),s.jsx(G,{children:s.jsxs(P,{variant:"destructive",onClick:w,className:"flex items-center gap-2",children:[s.jsx(zc,{className:"w-4 h-4"}),"Log Out"]})})]})]}),s.jsx(be,{value:"privacy",className:"space-y-6",children:s.jsxs(V,{children:[s.jsx(_e,{children:s.jsx(Ee,{children:"Privacy Settings"})}),s.jsxs(G,{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(J,{children:"Private Account"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Only approved followers can see your posts"})]}),s.jsx(yt,{checked:d.privateAccount,onCheckedChange:v=>h({...d,privateAccount:v})})]}),s.jsx(Tt,{}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(J,{children:"Show Location"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Display your location on your profile"})]}),s.jsx(yt,{checked:d.showLocation,onCheckedChange:v=>h({...d,showLocation:v})})]}),s.jsx(Tt,{}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(J,{children:"Show Travel Stats"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Display your travel achievements publicly"})]}),s.jsx(yt,{checked:d.showTravelStats,onCheckedChange:v=>h({...d,showTravelStats:v})})]}),s.jsx(Tt,{}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(J,{children:"Allow Tagging"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Let others tag you in their posts"})]}),s.jsx(yt,{checked:d.allowTagging,onCheckedChange:v=>h({...d,allowTagging:v})})]})]}),s.jsx(P,{onClick:g,disabled:a.privacy,className:"bg-gradient-primary text-white",children:a.privacy?s.jsxs(s.Fragment,{children:[s.jsx(ge,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(da,{className:"w-4 h-4 mr-2"}),"Save Privacy Settings"]})})]})]})}),s.jsx(be,{value:"notifications",className:"space-y-6",children:s.jsxs(V,{children:[s.jsx(_e,{children:s.jsx(Ee,{children:"Notification Preferences"})}),s.jsxs(G,{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(J,{children:"Likes"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"When someone likes your posts"})]}),s.jsx(yt,{checked:l.likes,onCheckedChange:v=>c({...l,likes:v})})]}),s.jsx(Tt,{}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(J,{children:"Comments"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"When someone comments on your posts"})]}),s.jsx(yt,{checked:l.comments,onCheckedChange:v=>c({...l,comments:v})})]}),s.jsx(Tt,{}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(J,{children:"New Followers"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"When someone starts following you"})]}),s.jsx(yt,{checked:l.follows,onCheckedChange:v=>c({...l,follows:v})})]}),s.jsx(Tt,{}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(J,{children:"Trip Updates"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Updates about trips you're interested in"})]}),s.jsx(yt,{checked:l.trips,onCheckedChange:v=>c({...l,trips:v})})]}),s.jsx(Tt,{}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx(J,{children:"Club Activity"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Activity in travel clubs you've joined"})]}),s.jsx(yt,{checked:l.clubs,onCheckedChange:v=>c({...l,clubs:v})})]})]}),s.jsx(P,{onClick:b,disabled:a.notifications,className:"bg-gradient-primary text-white",children:a.notifications?s.jsxs(s.Fragment,{children:[s.jsx(ge,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):s.jsxs(s.Fragment,{children:[s.jsx(da,{className:"w-4 h-4 mr-2"}),"Save Notification Settings"]})})]})]})})]})]})},lC=()=>{const[t,e]=u.useState(""),r=[{tag:"#bali",posts:15234},{tag:"#solotravel",posts:8945},{tag:"#foodie",posts:7623},{tag:"#backpacking",posts:6891},{tag:"#adventure",posts:5432}],a=[{id:1,name:"Sarah Chen",username:"@sarah_travels",bio:"Adventure seeker   Mountain lover   Travel photographer",followers:15600,avatar:"",isFollowing:!1},{id:2,name:"Alex Explorer",username:"@alex_explorer",bio:"Digital nomad   Visiting all 7 continents  Currently in Bali",followers:12300,avatar:"",isFollowing:!0},{id:3,name:"Maria Lopez",username:"@maria_wanders",bio:"Foodie traveler   Street food expert  Culture enthusiast",followers:9800,avatar:"",isFollowing:!1}],n=[{id:1,user:"sarah_travels",image:Yt,caption:"Paradise found in the Maldives! The water is so clear you can see your toes  #maldives #paradise #beachlife",likes:247,location:"Maldives"},{id:2,user:"alex_explorer",image:Jr,caption:"Conquered my first 4000m peak today! The view from the Swiss Alps is absolutely breathtaking  #swissalps #mountaineering #adventure",likes:189,location:"Swiss Alps, Switzerland"},{id:3,user:"maria_wanders",image:rn,caption:"This ramen in Tokyo is life-changing!  The perfect end to an amazing day exploring the city #tokyo #ramen #foodie",likes:156,location:"Tokyo, Japan"}],o=[{id:1,name:"Adventure Seekers",description:"For thrill-seekers and outdoor enthusiasts",members:2847,image:Jr,category:"Adventure"},{id:2,name:"Foodie Explorers",description:"Discover the world's best cuisine together",members:1923,image:rn,category:"Food"},{id:3,name:"Historic Wanderers",description:"Explore ancient sites and cultural landmarks",members:1456,image:On,category:"Culture"}],i=a.filter(d=>d.name.toLowerCase().includes(t.toLowerCase())||d.username.toLowerCase().includes(t.toLowerCase())),l=n.filter(d=>d.caption.toLowerCase().includes(t.toLowerCase())||d.location.toLowerCase().includes(t.toLowerCase())),c=o.filter(d=>d.name.toLowerCase().includes(t.toLowerCase())||d.description.toLowerCase().includes(t.toLowerCase()));return s.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6",children:[s.jsxs("div",{className:"mb-8",children:[s.jsx("h1",{className:"text-3xl font-bold text-foreground mb-4",children:"Search"}),s.jsxs("div",{className:"relative",children:[s.jsx(Wt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-5 h-5"}),s.jsx(se,{placeholder:"Search for places, people, or posts...",value:t,onChange:d=>e(d.target.value),className:"pl-10 h-12 text-base"})]})]}),!t&&s.jsx(V,{className:"bg-surface-elevated mb-8",children:s.jsxs(G,{className:"p-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(Or,{className:"w-5 h-5 text-primary"}),s.jsx("h2",{className:"text-lg font-semibold",children:"Trending Hashtags"})]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:r.map((d,h)=>s.jsxs(P,{variant:"secondary",className:"h-auto p-3 flex flex-col items-start",onClick:()=>e(d.tag),children:[s.jsx("span",{className:"font-semibold text-primary",children:d.tag}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:[d.posts.toLocaleString()," posts"]})]},h))})]})}),t&&s.jsxs(Zt,{defaultValue:"all",className:"space-y-6",children:[s.jsxs($t,{className:"grid w-full grid-cols-4",children:[s.jsx(ye,{value:"all",children:"All"}),s.jsx(ye,{value:"users",children:"Users"}),s.jsx(ye,{value:"posts",children:"Posts"}),s.jsx(ye,{value:"clubs",children:"Clubs"})]}),s.jsxs(be,{value:"all",className:"space-y-8",children:[i.length>0&&s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[s.jsx(ze,{className:"w-5 h-5"}),"People"]}),s.jsx("div",{className:"space-y-4",children:i.slice(0,3).map(d=>s.jsx(Lc,{user:d},d.id))})]}),l.length>0&&s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[s.jsx(Np,{className:"w-5 h-5"}),"Posts"]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:l.slice(0,6).map(d=>s.jsx($c,{post:d},d.id))})]}),c.length>0&&s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[s.jsx(ze,{className:"w-5 h-5"}),"Clubs"]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:c.slice(0,3).map(d=>s.jsx(Fc,{club:d},d.id))})]})]}),s.jsx(be,{value:"users",children:s.jsx("div",{className:"space-y-4",children:i.map(d=>s.jsx(Lc,{user:d},d.id))})}),s.jsx(be,{value:"posts",children:s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:l.map(d=>s.jsx($c,{post:d},d.id))})}),s.jsx(be,{value:"clubs",children:s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map(d=>s.jsx(Fc,{club:d},d.id))})})]}),t&&i.length===0&&l.length===0&&c.length===0&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(Wt,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No results found"}),s.jsx("p",{className:"text-muted-foreground",children:"Try searching for different keywords or check your spelling"})]})]})},Lc=({user:t})=>s.jsx(V,{className:"hover:shadow-md transition-shadow",children:s.jsx(G,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(Pe,{className:"w-12 h-12",children:[s.jsx(Ae,{src:t.avatar}),s.jsx(Re,{className:"bg-primary text-primary-foreground",children:t.name.split(" ").map(e=>e[0]).join("")})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-semibold",children:t.name}),s.jsx("p",{className:"text-sm text-muted-foreground",children:t.username}),s.jsx("p",{className:"text-sm text-muted-foreground line-clamp-1",children:t.bio}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:[t.followers.toLocaleString()," followers"]})]})]}),s.jsx(P,{size:"sm",variant:t.isFollowing?"secondary":"default",children:t.isFollowing?"Following":"Follow"})]})})}),$c=({post:t})=>s.jsxs(V,{className:"overflow-hidden hover:shadow-md transition-shadow cursor-pointer",children:[s.jsx("div",{className:"aspect-square overflow-hidden",children:s.jsx("img",{src:t.image,alt:"Post",className:"w-full h-full object-cover hover:scale-105 transition-transform duration-300",onError:e=>Ba(e,"/images/hero-beach.jpg","Failed to load post image")})}),s.jsxs(G,{className:"p-3",children:[s.jsxs("p",{className:"text-sm font-medium",children:["@",t.user]}),s.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2 mt-1",children:t.caption}),s.jsxs("div",{className:"flex items-center justify-between mt-2",children:[s.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[s.jsx(Ie,{className:"w-3 h-3"}),t.location]}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:[t.likes," likes"]})]})]})]}),Fc=({club:t})=>s.jsxs(V,{className:"overflow-hidden hover:shadow-md transition-shadow cursor-pointer",children:[s.jsx("div",{className:"aspect-video overflow-hidden",children:s.jsx("img",{src:t.image,alt:t.name,className:"w-full h-full object-cover hover:scale-105 transition-transform duration-300"})}),s.jsxs(G,{className:"p-4",children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsx("h4",{className:"font-semibold line-clamp-1",children:t.name}),s.jsx(Le,{variant:"secondary",className:"text-xs",children:t.category})]}),s.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 mb-3",children:t.description}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("span",{className:"text-xs text-muted-foreground",children:[t.members.toLocaleString()," members"]}),s.jsx(P,{size:"sm",variant:"outline",children:"Join"})]})]})]}),cC=()=>{const{user:t}=mt(),[e,r]=u.useState(null),[a,n]=u.useState(!0),[o,i]=u.useState(!1),l=async()=>{if(!t?.id){n(!1);return}try{n(!0);const d=await pr.getWalletDetails(t.id);r(d)}catch(d){console.error("Error fetching wallet details:",d)}finally{n(!1)}};u.useEffect(()=>{l()},[t?.id]);const c=()=>{l()};return t?s.jsxs(s.Fragment,{children:[s.jsx(V,{className:"bg-gradient-to-r from-primary/10 to-primary/5 border-primary/20",children:s.jsx(G,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:s.jsx(Qr,{className:"w-5 h-5 text-primary"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Your Balance"}),a?s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsx(ge,{className:"w-4 h-4 animate-spin text-muted-foreground"}),s.jsx("span",{className:"text-xs text-muted-foreground",children:"Loading..."})]}):s.jsxs("p",{className:"text-xl font-bold text-foreground",children:["",e?.wallet.balance.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})||"0.00"]})]})]}),s.jsxs(P,{size:"sm",onClick:()=>i(!0),className:"bg-primary hover:bg-primary/90",children:[s.jsx(Qe,{className:"w-4 h-4 mr-1"}),"Add"]})]})})}),s.jsx(Lf,{open:o,onOpenChange:i,onSuccess:c})]}):null},dC=()=>{const t=Ls(),[e,r]=u.useState("bus"),[a,n]=u.useState({from:"",to:"",date:""}),[o,i]=u.useState({from:"",to:"",date:"",returnDate:"",passengers:1}),[l,c]=u.useState({city:"",checkIn:"",checkOut:"",guests:1}),d=()=>{a.from&&a.to&&a.date&&t("/booking/bus",{state:{searchParams:a}})},h=()=>{console.log("Flight search:",o)},m=()=>{console.log("Hotel search:",l)},p=[{name:"IndiGo",icon:""},{name:"Air India",icon:""},{name:"Vistara",icon:""},{name:"SpiceJet",icon:""},{name:"RedBus",icon:""},{name:"Volvo",icon:""},{name:"Marriott",icon:""},{name:"Taj Hotels",icon:""},{name:"OYO",icon:""},{name:"MakeMyTrip",icon:""}],f=[{icon:Kc,title:"Secure Payments",description:"Your transactions are protected with bank-level encryption",color:"from-blue-500 to-cyan-500"},{icon:Oa,title:"Instant Confirmation",description:"Get your booking confirmed within seconds",color:"from-green-500 to-emerald-500"},{icon:ri,title:"Best Price Guarantee",description:"We match any lower price you find elsewhere",color:"from-purple-500 to-pink-500"}],b=new Date().toISOString().split("T")[0];return s.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-purple-50",children:[s.jsx("div",{className:"max-w-7xl mx-auto px-4 pt-6",children:s.jsx(cC,{})}),s.jsxs("div",{className:"relative min-h-[60vh] flex items-center justify-center overflow-hidden",children:[s.jsx(Q.div,{className:"absolute inset-0 bg-gradient-to-br from-blue-600 via-purple-600 to-pink-600",animate:{backgroundPosition:["0% 0%","100% 100%"]},transition:{duration:20,repeat:1/0,repeatType:"reverse"},style:{backgroundSize:"200% 200%"}}),s.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[s.jsx(Q.div,{className:"absolute top-20 left-20 w-72 h-72 bg-white/10 rounded-full blur-3xl",animate:{x:[0,100,0],y:[0,-50,0]},transition:{duration:15,repeat:1/0,ease:"easeInOut"}}),s.jsx(Q.div,{className:"absolute bottom-20 right-20 w-96 h-96 bg-purple-300/10 rounded-full blur-3xl",animate:{x:[0,-80,0],y:[0,60,0]},transition:{duration:18,repeat:1/0,ease:"easeInOut"}})]}),s.jsxs("div",{className:"relative z-10 w-full max-w-6xl mx-auto px-4 py-12",children:[s.jsxs(Q.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-8",children:[s.jsx(Q.h1,{className:"text-5xl md:text-6xl font-bold text-white mb-4",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.2,duration:.6},children:"Your Journey Starts Here"}),s.jsx(Q.p,{className:"text-xl text-white/90 max-w-2xl mx-auto",initial:{opacity:0},animate:{opacity:1},transition:{delay:.4,duration:.6},children:"Book buses, flights, and hotels with ease. Trusted by millions of travelers."})]}),s.jsx(Q.div,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},transition:{delay:.3,duration:.6},className:"backdrop-blur-xl bg-white/20 border border-white/30 rounded-2xl shadow-2xl p-6 md:p-8",children:s.jsxs(Zt,{value:e,onValueChange:g=>r(g),className:"w-full",children:[s.jsxs($t,{className:"grid w-full grid-cols-3 bg-white/10 backdrop-blur-sm mb-6",children:[s.jsxs(ye,{value:"bus",className:"data-[state=active]:bg-white/20 data-[state=active]:text-white",children:[s.jsx(Sp,{className:"w-4 h-4 mr-2"}),"Bus"]}),s.jsxs(ye,{value:"flight",className:"data-[state=active]:bg-white/20 data-[state=active]:text-white",children:[s.jsx(_p,{className:"w-4 h-4 mr-2"}),"Flight"]}),s.jsxs(ye,{value:"hotel",className:"data-[state=active]:bg-white/20 data-[state=active]:text-white",children:[s.jsx(Cp,{className:"w-4 h-4 mr-2"}),"Hotel"]})]}),s.jsxs(be,{value:"bus",className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(J,{className:"text-white/90 flex items-center gap-2",children:[s.jsx(Ie,{className:"w-4 h-4"}),"From"]}),s.jsx(se,{placeholder:"Enter origin city",value:a.from,onChange:g=>n({...a,from:g.target.value}),className:"bg-white/90 backdrop-blur-sm border-white/30"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(J,{className:"text-white/90 flex items-center gap-2",children:[s.jsx(Ie,{className:"w-4 h-4"}),"To"]}),s.jsx(se,{placeholder:"Enter destination city",value:a.to,onChange:g=>n({...a,to:g.target.value}),className:"bg-white/90 backdrop-blur-sm border-white/30"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(J,{className:"text-white/90 flex items-center gap-2",children:[s.jsx(Be,{className:"w-4 h-4"}),"Travel Date"]}),s.jsx(se,{type:"date",value:a.date,onChange:g=>n({...a,date:g.target.value}),min:b,className:"bg-white/90 backdrop-blur-sm border-white/30"})]})]}),s.jsxs(P,{onClick:d,disabled:!a.from||!a.to||!a.date,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white text-lg py-6 shadow-lg relative overflow-hidden group",children:[s.jsxs("span",{className:"relative z-10 flex items-center justify-center gap-2",children:[s.jsx(Wt,{className:"w-5 h-5"}),"Search Buses"]}),s.jsx(Q.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent",animate:{x:["-100%","100%"]},transition:{duration:2,repeat:1/0,repeatDelay:1}})]})]}),s.jsxs(be,{value:"flight",className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(J,{className:"text-white/90 flex items-center gap-2",children:[s.jsx(Ie,{className:"w-4 h-4"}),"From"]}),s.jsx(se,{placeholder:"Enter origin",value:o.from,onChange:g=>i({...o,from:g.target.value}),className:"bg-white/90 backdrop-blur-sm border-white/30"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(J,{className:"text-white/90 flex items-center gap-2",children:[s.jsx(Ie,{className:"w-4 h-4"}),"To"]}),s.jsx(se,{placeholder:"Enter destination",value:o.to,onChange:g=>i({...o,to:g.target.value}),className:"bg-white/90 backdrop-blur-sm border-white/30"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(J,{className:"text-white/90 flex items-center gap-2",children:[s.jsx(Be,{className:"w-4 h-4"}),"Departure"]}),s.jsx(se,{type:"date",value:o.date,onChange:g=>i({...o,date:g.target.value}),min:b,className:"bg-white/90 backdrop-blur-sm border-white/30"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(J,{className:"text-white/90 flex items-center gap-2",children:[s.jsx(ze,{className:"w-4 h-4"}),"Passengers"]}),s.jsx(se,{type:"number",min:"1",max:"9",value:o.passengers,onChange:g=>i({...o,passengers:parseInt(g.target.value)||1}),className:"bg-white/90 backdrop-blur-sm border-white/30"})]})]}),s.jsxs(P,{onClick:h,disabled:!o.from||!o.to||!o.date,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white text-lg py-6 shadow-lg relative overflow-hidden group",children:[s.jsxs("span",{className:"relative z-10 flex items-center justify-center gap-2",children:[s.jsx(Wt,{className:"w-5 h-5"}),"Search Flights"]}),s.jsx(Q.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent",animate:{x:["-100%","100%"]},transition:{duration:2,repeat:1/0,repeatDelay:1}})]})]}),s.jsxs(be,{value:"hotel",className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(J,{className:"text-white/90 flex items-center gap-2",children:[s.jsx(Ie,{className:"w-4 h-4"}),"City or Hotel"]}),s.jsx(se,{placeholder:"Enter city or hotel name",value:l.city,onChange:g=>c({...l,city:g.target.value}),className:"bg-white/90 backdrop-blur-sm border-white/30"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(J,{className:"text-white/90 flex items-center gap-2",children:[s.jsx(Be,{className:"w-4 h-4"}),"Check-in"]}),s.jsx(se,{type:"date",value:l.checkIn,onChange:g=>c({...l,checkIn:g.target.value}),min:b,className:"bg-white/90 backdrop-blur-sm border-white/30"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(J,{className:"text-white/90 flex items-center gap-2",children:[s.jsx(Be,{className:"w-4 h-4"}),"Check-out"]}),s.jsx(se,{type:"date",value:l.checkOut,onChange:g=>c({...l,checkOut:g.target.value}),min:l.checkIn||b,className:"bg-white/90 backdrop-blur-sm border-white/30"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(J,{className:"text-white/90 flex items-center gap-2",children:[s.jsx(ze,{className:"w-4 h-4"}),"Guests"]}),s.jsx(se,{type:"number",min:"1",max:"10",value:l.guests,onChange:g=>c({...l,guests:parseInt(g.target.value)||1}),className:"bg-white/90 backdrop-blur-sm border-white/30"})]})]}),s.jsxs(P,{onClick:m,disabled:!l.city||!l.checkIn||!l.checkOut,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white text-lg py-6 shadow-lg relative overflow-hidden group",children:[s.jsxs("span",{className:"relative z-10 flex items-center justify-center gap-2",children:[s.jsx(Wt,{className:"w-5 h-5"}),"Search Hotels"]}),s.jsx(Q.div,{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/20 to-transparent",animate:{x:["-100%","100%"]},transition:{duration:2,repeat:1/0,repeatDelay:1}})]})]})]})})]})]}),s.jsx("div",{className:"py-12 bg-white/50 backdrop-blur-sm",children:s.jsx("div",{className:"max-w-7xl mx-auto px-4",children:s.jsxs(Q.div,{initial:{opacity:0},whileInView:{opacity:1},viewport:{once:!0},transition:{duration:.6},className:"text-center mb-8",children:[s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Trusted by 50+ Partners"}),s.jsx("div",{className:"relative overflow-hidden",children:s.jsx("div",{className:"flex gap-8 animate-scroll",children:[...p,...p].map((g,y)=>s.jsxs(Q.div,{className:"flex-shrink-0 flex items-center justify-center w-32 h-16 bg-white rounded-lg shadow-sm border border-gray-200 px-4 hover:shadow-md transition-shadow",whileHover:{scale:1.05},children:[s.jsx("span",{className:"text-2xl mr-2",children:g.icon}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:g.name})]},y))})})]})})}),s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-16",children:[s.jsxs(Q.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.6},className:"text-center mb-12",children:[s.jsx("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Why Choose WanderSphere?"}),s.jsx("p",{className:"text-xl text-gray-600",children:"Experience travel booking like never before"})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:f.map((g,y)=>s.jsx(Q.div,{initial:{opacity:0,y:30},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:y*.1,duration:.6},whileHover:{scale:1.02,y:-5},className:"group",children:s.jsx(V,{className:"h-full border-2 hover:border-primary/50 transition-all duration-300 shadow-lg hover:shadow-xl",children:s.jsxs(G,{className:"p-8",children:[s.jsx(Q.div,{className:Z("w-16 h-16 rounded-2xl bg-gradient-to-br flex items-center justify-center mb-6 shadow-lg",g.color),whileHover:{rotate:360},transition:{duration:.6},children:s.jsx(g.icon,{className:"w-8 h-8 text-white"})}),s.jsx("h3",{className:"text-2xl font-bold mb-3 text-gray-900",children:g.title}),s.jsx("p",{className:"text-gray-600 leading-relaxed",children:g.description})]})})},y))})]})]})},uC=()=>{const{id:t}=on(),[e,r]=u.useState(null),[a,n]=u.useState([]),[o,i]=u.useState([]),[l,c]=u.useState([]),[d,h]=u.useState(!0),[m,p]=u.useState(!0),[f,b]=u.useState(null),[g,y]=u.useState(!1),{toast:w}=Ct();u.useEffect(()=>{const x=async()=>{if(t)try{h(!0),b(null);const N=await qt.getClubById(t);r(N)}catch(N){b("Failed to load club details"),console.error("Error fetching club details:",N),w({title:"Error",description:"Failed to load club details. Please try again.",variant:"destructive"})}finally{h(!1)}},j=async()=>{if(t)try{p(!0);const[N,S]=await Promise.all([qt.getClubPosts(t),qt.getClubMembers(t)]);n(N),i(S),c([])}catch(N){console.error("Error fetching club data:",N),w({title:"Error",description:"Failed to load some club data.",variant:"destructive"})}finally{p(!1)}};t&&(x(),j())},[t,w]);const v=async()=>{if(!(!t||!e))try{y(!0),e.isJoined?(await qt.leaveClub(t),w({title:"Success",description:"You have left the club."}),r({...e,isJoined:!1,members:e.members-1})):(await qt.joinClub(t),w({title:"Success",description:"You have joined the club!"}),r({...e,isJoined:!0,members:e.members+1}))}catch(x){console.error("Error joining/leaving club:",x),w({title:"Error",description:"Failed to update club membership. Please try again.",variant:"destructive"})}finally{y(!1)}};return d?s.jsx("div",{className:"max-w-4xl mx-auto px-4 py-6",children:s.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:s.jsxs("div",{className:"text-center",children:[s.jsx(ge,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-primary"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading club details..."})]})})}):f?s.jsx("div",{className:"max-w-4xl mx-auto px-4 py-6",children:s.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-red-500 mb-4",children:f}),s.jsx(P,{onClick:()=>window.location.reload(),variant:"outline",children:"Try Again"})]})})}):e?s.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6",children:[s.jsx(P,{variant:"ghost",asChild:!0,className:"mb-4",children:s.jsxs(Ne,{to:"/clubs",children:[s.jsx(ct,{className:"w-4 h-4 mr-2"}),"Back to Clubs"]})}),s.jsxs(V,{className:"bg-surface-elevated mb-8 overflow-hidden",children:[s.jsxs("div",{className:"aspect-video relative",children:[s.jsx("img",{src:e.image,alt:e.name,className:"w-full h-full object-cover"}),s.jsx("div",{className:"absolute inset-0 bg-black/40"}),s.jsxs("div",{className:"absolute bottom-6 left-6 text-white",children:[s.jsx(Le,{className:"mb-2 bg-white/20 text-white",children:e.category}),s.jsx("h1",{className:"text-3xl font-bold mb-2",children:e.name}),s.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(ze,{className:"w-4 h-4"}),e.members?.toLocaleString()||0," members"]}),e.createdAt&&s.jsxs("span",{children:["Created ",new Date(e.createdAt).toLocaleDateString("en-US",{month:"long",year:"numeric"})]})]})]}),s.jsx("div",{className:"absolute top-6 right-6",children:s.jsx(P,{onClick:v,className:e.isJoined?"bg-secondary text-secondary-foreground":"bg-gradient-primary text-white",disabled:g,children:g?s.jsxs(s.Fragment,{children:[s.jsx(ge,{className:"mr-2 h-4 w-4 animate-spin"}),e.isJoined?"Leaving...":"Joining..."]}):e.isJoined?"Leave Club":"Join Club"})})]}),s.jsx(G,{className:"p-6",children:s.jsx("p",{className:"text-muted-foreground leading-relaxed",children:e.description||"No description available."})})]}),s.jsxs(Zt,{defaultValue:"feed",className:"space-y-6",children:[s.jsxs($t,{className:"grid w-full grid-cols-3",children:[s.jsx(ye,{value:"feed",children:"Feed"}),s.jsx(ye,{value:"members",children:"Members"}),s.jsx(ye,{value:"events",children:"Events"})]}),s.jsx(be,{value:"feed",className:"space-y-6",children:m?s.jsx("div",{className:"flex items-center justify-center py-8",children:s.jsxs("div",{className:"text-center",children:[s.jsx(ge,{className:"w-6 h-6 animate-spin mx-auto mb-2 text-primary"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading posts..."})]})}):a.length===0?s.jsx("div",{className:"text-center py-8",children:s.jsx("p",{className:"text-muted-foreground",children:"No posts yet. Be the first to share something!"})}):a.map(x=>s.jsx(V,{className:"bg-surface-elevated",children:s.jsxs(G,{className:"p-4",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[s.jsxs(Pe,{className:"w-10 h-10",children:[s.jsx(Ae,{src:x.author?.avatar}),s.jsx(Re,{className:"bg-primary text-primary-foreground",children:x.author?.name?.charAt(0).toUpperCase()||"U"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:x.author?.name||"Unknown User"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:x.createdAt?new Date(x.createdAt).toLocaleDateString():"Recently"})]})]}),s.jsx("p",{className:"mb-4",children:x.content}),x.images&&x.images.length>0&&s.jsx("div",{className:"mb-4 rounded-lg overflow-hidden",children:s.jsx("img",{src:x.images[0],alt:"Post",className:"w-full aspect-video object-cover",onError:j=>Dn(j,"/images/hero-beach.jpg","Failed to load club post image")})}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(P,{variant:"ghost",size:"sm",children:[s.jsx(Ht,{className:"w-4 h-4 mr-1"}),x.likes||0]}),s.jsxs(P,{variant:"ghost",size:"sm",children:[s.jsx(us,{className:"w-4 h-4 mr-1"}),x.comments||0]}),s.jsx(P,{variant:"ghost",size:"sm",children:s.jsx(Xr,{className:"w-4 h-4"})})]})]})},x.id))}),s.jsxs(be,{value:"members",className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsxs("h3",{className:"text-lg font-semibold",children:["Club Members (",e.members?.toLocaleString()||0,")"]}),s.jsxs(P,{variant:"outline",size:"sm",children:[s.jsx(ei,{className:"w-4 h-4 mr-2"}),"Manage"]})]}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:o.map(x=>s.jsx(V,{className:"bg-surface-elevated",children:s.jsx(G,{className:"p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(Pe,{className:"w-12 h-12",children:[s.jsx(Ae,{src:x.avatar}),s.jsx(Re,{className:"bg-primary text-primary-foreground",children:x.name?.split(" ").map(j=>j[0]).join("")||"U"})]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:x.name}),s.jsx("p",{className:"text-sm text-muted-foreground",children:x.username||`@${x.name?.toLowerCase().replace(/\s+/g,"_")}`})]})]}),s.jsx(Le,{variant:x.role==="admin"?"default":x.role==="organizer"?"secondary":"outline",children:x.role?.charAt(0).toUpperCase()+x.role?.slice(1)||"Member"})]})})},x.id))})]}),s.jsxs(be,{value:"events",className:"space-y-4",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Upcoming Events"}),s.jsxs(P,{className:"bg-gradient-primary text-white",children:[s.jsx(Be,{className:"w-4 h-4 mr-2"}),"Create Event"]})]}),s.jsx("div",{className:"space-y-4",children:l.length>0?l.map(x=>s.jsx(V,{className:"bg-surface-elevated hover:shadow-md transition-shadow cursor-pointer",children:s.jsx(G,{className:"p-4",children:s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h4",{className:"font-semibold text-lg mb-2",children:x.title}),s.jsxs("div",{className:"space-y-1 text-sm text-muted-foreground",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Be,{className:"w-4 h-4"}),x.date]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ie,{className:"w-4 h-4"}),x.location]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ze,{className:"w-4 h-4"}),x.attendees,"/",x.maxAttendees," attending"]})]})]}),s.jsx(P,{size:"sm",variant:"outline",children:"Join Event"})]})})},x.id)):s.jsx(V,{className:"bg-surface-elevated",children:s.jsxs(G,{className:"p-6 text-center text-muted-foreground",children:[s.jsx(Be,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"No events scheduled yet."})]})})})]})]})]}):s.jsx("div",{className:"max-w-4xl mx-auto px-4 py-6",children:s.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Club not found"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:"The club you're looking for doesn't exist or has been removed."}),s.jsx(P,{onClick:()=>window.history.back(),variant:"outline",children:"Go Back"})]})})})};async function Aa(t){const e=await Kr.getUserProfile(t.user_id),r=t.destination?.city&&t.destination?.country?`${t.destination.city}, ${t.destination.country}`:"Unknown destination",a=t.budget?.total?`${t.budget.currency||"USD"} ${t.budget.total}`:"Not specified",n=new Date(t.start_date),o=new Date(t.end_date),i=Math.ceil((o.getTime()-n.getTime())/(1e3*60*60*24)),l=`${i} day${i!==1?"s":""}`;return{id:t.id,title:t.title,description:t.description||"",destination:r,startDate:t.start_date,endDate:t.end_date,duration:l,budget:a,maxParticipants:t.max_participants||1,currentParticipants:t.current_participants||1,organizer:{id:e?.id||t.user_id,name:e?`${e.first_name} ${e.last_name}`:"Unknown",username:e?.username||"",avatar:e?.avatar_url||void 0,bio:e?.bio||void 0},participants:[],images:t.images||[],tags:t.tags||[],type:t.trip_type||"",status:mC(t.status||"planning"),requirements:[],itinerary:t.itinerary||[],createdAt:t.created_at,updatedAt:t.updated_at}}function hC(t){return{title:t.title,description:t.description,destination:{city:t.destination.city,country:t.destination.country,coordinates:t.destination.coordinates},start_date:t.dates.startDate,end_date:t.dates.endDate,budget:{total:t.budget.total,currency:t.budget.currency},max_participants:t.maxParticipants,trip_type:t.category,difficulty_level:t.difficulty,visibility:t.visibility||"public",tags:t.tags,images:t.images,itinerary:t.itinerary,status:"planning",is_active:!0}}function mC(t){switch(t){case"active":return"open";case"completed":return"completed";case"cancelled":return"closed";default:return"open"}}class fC{async getTrips(e={}){try{const r=await ks.getMyTrips(),a=await Promise.all(r.map(Aa));return{success:!0,data:a,pagination:{page:e.page||1,limit:e.limit||a.length,total:a.length,totalPages:1}}}catch(r){throw new Error(r instanceof Error?r.message:"Failed to fetch trips")}}async getTripById(e){try{const a=(await te(K(re.trips.detail(e)),{method:"GET"})).data.trip,n=(a.participants||[]).filter(h=>h.status==="accepted"),o=typeof a.destination=="object"&&a.destination?.city?`${a.destination.city}, ${a.destination.country||""}`:typeof a.destination=="string"?a.destination:"Unknown destination",i=new Date(a.start_date),l=new Date(a.end_date),c=Math.ceil((l.getTime()-i.getTime())/(1e3*60*60*24)),d=`${c} day${c!==1?"s":""}`;return{id:a.id,title:a.title,description:a.description||"",destination:o,startDate:a.start_date||"",endDate:a.end_date||"",duration:d,budget:typeof a.budget=="object"&&a.budget?.total?`${a.budget.currency||"USD"} ${a.budget.total}`:typeof a.budget=="string"?a.budget:"",maxParticipants:a.max_participants||a.maxParticipants||1,currentParticipants:n.length||1,organizer:{id:a.organizer?.id||a.organizer_id||"",name:a.organizer?`${a.organizer.first_name||""} ${a.organizer.last_name||""}`.trim():"",username:a.organizer?.username||"",avatar:a.organizer?.avatar_url||void 0,bio:""},participants:(a.participants||[]).map(h=>({id:h.id,userId:h.user?.id||"",name:h.user?`${h.user.first_name||""} ${h.user.last_name||""}`.trim():"",username:h.user?.username||"",avatar:h.user?.avatar_url||void 0,role:h.role==="organizer"?"organizer":"participant",joinedAt:h.joined_at})),images:a.images||[],tags:a.tags||[],type:a.category||a.trip_type||"",status:a.status==="cancelled"?"closed":n.length>=(a.max_participants||0)?"full":"open",meetingPoint:a.meetingPoint,requirements:a.requirements||[],itinerary:a.itinerary||[],createdAt:a.created_at||"",updatedAt:a.updated_at||""}}catch(r){throw new Error(r instanceof Error?r.message:"Failed to get trip details")}}async createTrip(e){try{const r=hC(e),a=await ks.createTrip(r);return await Aa(a)}catch(r){throw new Error(r instanceof Error?r.message:"Failed to create trip")}}async updateTrip(e){try{const r={};e.title&&(r.title=e.title),e.description&&(r.description=e.description),e.destination&&(r.destination={city:e.destination.city,country:e.destination.country,coordinates:e.destination.coordinates}),e.dates&&(r.start_date=e.dates.startDate,r.end_date=e.dates.endDate),e.budget&&(r.budget={total:e.budget.total,currency:e.budget.currency}),e.maxParticipants&&(r.max_participants=e.maxParticipants),e.category&&(r.trip_type=e.category),e.difficulty&&(r.difficulty_level=e.difficulty),e.visibility&&(r.visibility=e.visibility),e.tags&&(r.tags=e.tags),e.images&&(r.images=e.images),e.itinerary&&(r.itinerary=e.itinerary);const a=await ks.updateTrip(e.id,r);return await Aa(a)}catch(r){throw new Error(r instanceof Error?r.message:"Failed to update trip")}}async deleteTrip(e){try{await ks.deleteTrip(e)}catch(r){throw new Error(r instanceof Error?r.message:"Failed to delete trip")}}async joinTrip(e,r){await te(K(re.trips.request(e)),{method:"POST",body:{message:r||""}})}async leaveTrip(e){throw new Error("Not implemented yet - requires trip_participants table")}async getMyTripRequests(){try{return(await te(K(re.trips.requestsMy),{method:"GET"})).data||[]}catch(e){throw new Error(e instanceof Error?e.message:"Failed to fetch trip requests")}}async getTripRequests(e){try{return(await te(K(re.trips.requestsForTrip(e)),{method:"GET"})).data||[]}catch(r){throw new Error(r instanceof Error?r.message:"Failed to fetch trip requests")}}async approveTripRequest(e){await te(K(re.trips.approveRequest(e)),{method:"POST"})}async rejectTripRequest(e){await te(K(re.trips.rejectRequest(e)),{method:"POST"})}async getTripParticipants(e){return[]}async getTripComments(e){return((await te(K(re.trips.detail(e)),{method:"GET"})).data.trip.comments||[]).map(n=>({id:n.id,userId:n.user?.id||"",user:{name:n.user?`${n.user.first_name||""} ${n.user.last_name||""}`.trim():"Unknown",username:n.user?.username||"",avatar:n.user?.avatar_url||void 0},content:n.content,likes:n.likes??0,isLiked:!1,createdAt:n.created_at,updatedAt:n.updated_at}))}async addTripComment(e,r){const n=(await te(K(re.trips.comments(e)),{method:"POST",body:{content:r}})).data.comment;return{id:n.id,userId:n.user?.id||"",user:{name:n.user?`${n.user.first_name||""} ${n.user.last_name||""}`.trim():"Unknown",username:n.user?.username||"",avatar:n.user?.avatar_url||void 0},content:n.content,likes:n.likes??0,isLiked:!1,createdAt:n.created_at,updatedAt:n.updated_at}}async toggleTripLike(e){throw new Error("Not implemented yet - requires trip_likes table")}async searchTrips(e){return this.getTrips(e)}async getNearbyTrips(e,r,a=50){const n=await ks.getPublicTrips();return await Promise.all(n.map(Aa))}}const Ra=new fC,pC=()=>{const{id:t}=on(),{toast:e}=Ct(),[r,a]=u.useState(null),[n,o]=u.useState([]),[i,l]=u.useState(!0),[c,d]=u.useState(null),[h,m]=u.useState(""),[p,f]=u.useState(!1),[b,g]=u.useState(!1);u.useEffect(()=>{(async()=>{if(t)try{l(!0),d(null);const[j,N]=await Promise.all([Ra.getTripById(t),Ra.getTripComments(t)]);a(j),o(N)}catch(j){d(j.message||"Failed to load trip details"),console.error("Error fetching trip details:",j)}finally{l(!1)}})()},[t]);const y=x=>{const j=new Date(x),S=Math.floor((new Date().getTime()-j.getTime())/(1e3*60*60));return S<1?"Just now":S<24?`${S}h ago`:S<48?"1d ago":`${Math.floor(S/24)}d ago`},w=async()=>{if(!t)return;if(!(localStorage.getItem("user")!==null)){e({title:"Authentication Required",description:"Please log in or sign up to join this trip."}),localStorage.setItem("redirectAfterAuth",window.location.pathname),window.location.href="/login";return}try{if(p){e({title:"Already sent",description:"You've already expressed interest in this trip."});return}await Ra.joinTrip(t),f(!0),e({title:"Interest expressed!",description:"The organizer will be notified of your interest."})}catch(j){e({title:"Error",description:j.message||"Failed to update interest",variant:"destructive"}),console.error("Error expressing interest:",j)}},v=async()=>{if(!h.trim()||!t||b)return;if(!(localStorage.getItem("user")!==null)){e({title:"Authentication Required",description:"Please log in or sign up to comment on this trip."}),localStorage.setItem("redirectAfterAuth",window.location.pathname),window.location.href="/login";return}try{g(!0);const j=await Ra.addTripComment(t,h.trim());o(N=>[j,...N]),m(""),e({title:"Comment added",description:"Your comment has been posted successfully."})}catch(j){e({title:"Error",description:j.message||"Failed to add comment",variant:"destructive"}),console.error("Error adding comment:",j)}finally{g(!1)}};return i?s.jsx("div",{className:"max-w-4xl mx-auto px-4 py-6",children:s.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:s.jsxs("div",{className:"text-center",children:[s.jsx(ge,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-primary"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading trip details..."})]})})}):c?s.jsx("div",{className:"max-w-4xl mx-auto px-4 py-6",children:s.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-red-500 mb-4",children:c}),s.jsx(P,{onClick:()=>window.location.reload(),variant:"outline",children:"Try Again"})]})})}):r?s.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-6",children:[s.jsx(P,{variant:"ghost",asChild:!0,className:"mb-4",children:s.jsxs(Ne,{to:"/find-trips",children:[s.jsx(ct,{className:"w-4 h-4 mr-2"}),"Back to Find Trips"]})}),s.jsx(V,{className:"bg-surface-elevated mb-8 overflow-hidden",children:s.jsxs("div",{className:"aspect-video relative",children:[s.jsx("img",{src:r.images?.[0]||On,alt:r.title,className:"w-full h-full object-cover"}),s.jsx("div",{className:"absolute inset-0 bg-black/40"}),s.jsx("div",{className:"absolute top-4 right-4",children:s.jsx(Le,{className:`${r.status==="open"?"bg-green-500":r.status==="full"?"bg-yellow-500":"bg-red-500"} text-white`,children:r.status.charAt(0).toUpperCase()+r.status.slice(1)})}),s.jsxs("div",{className:"absolute bottom-6 left-6 text-white",children:[s.jsx("h1",{className:"text-3xl font-bold mb-4",children:r.title}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ie,{className:"w-4 h-4"}),typeof r.destination=="string"?r.destination:`${r.destination.city}, ${r.destination.country}`]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Be,{className:"w-4 h-4"}),new Date(r.startDate).toLocaleDateString()," - ",new Date(r.endDate).toLocaleDateString()]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ze,{className:"w-4 h-4"}),r.currentParticipants,"/",r.maxParticipants," travelers"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(ir,{className:"w-4 h-4"}),typeof r.budget=="string"?r.budget:`${r.budget.currency} ${r.budget.total}`]})]})]})]})}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[s.jsxs(V,{className:"bg-surface-elevated",children:[s.jsx(_e,{children:s.jsx(Ee,{children:"Organized by"})}),s.jsx(G,{children:s.jsxs("div",{className:"flex items-start gap-4",children:[s.jsxs(Pe,{className:"w-16 h-16",children:[s.jsx(Ae,{src:r.organizer?.avatar}),s.jsx(Re,{className:"bg-primary text-primary-foreground text-lg",children:(typeof r.organizer?.name=="string"&&r.organizer.name||r.organizer?.username||"Nomad Admin").split(" ").filter(Boolean).map(j=>j[0]?.toUpperCase()||"").join("").slice(0,2)||"NA"})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("h3",{className:"text-lg font-semibold",children:r.organizer?.name||r.organizer?.username||"Nomad Admin"}),s.jsx("p",{className:"text-muted-foreground text-sm mb-3",children:r.organizer?.bio||"Travel enthusiast"}),s.jsx(P,{size:"sm",variant:"outline",children:"View Profile"})]})]})})]}),s.jsxs(V,{className:"bg-surface-elevated",children:[s.jsx(_e,{children:s.jsx(Ee,{children:"About This Trip"})}),s.jsxs(G,{children:[s.jsx("div",{className:"prose prose-sm max-w-none",children:r.description.split(`
`).map((x,j)=>s.jsx("p",{className:"mb-3 leading-relaxed",children:x},j))}),s.jsx("div",{className:"flex flex-wrap gap-2 mt-6",children:r.tags.map(x=>s.jsx(Le,{variant:"secondary",children:x},x))})]})]}),s.jsxs(V,{className:"bg-surface-elevated",children:[s.jsx(_e,{children:s.jsxs(Ee,{children:["Discussion (",n.length,")"]})}),s.jsxs(G,{className:"space-y-6",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsx(xs,{placeholder:"Ask a question or share your thoughts about this trip...",value:h,onChange:x=>m(x.target.value),className:"min-h-20"}),s.jsx(P,{onClick:v,size:"sm",className:"bg-gradient-primary text-white",disabled:b||!h.trim(),children:b?s.jsxs(s.Fragment,{children:[s.jsx(ge,{className:"w-4 h-4 mr-2 animate-spin"}),"Adding..."]}):"Add Comment"})]}),s.jsx(Tt,{}),s.jsx("div",{className:"space-y-6",children:n.map(x=>s.jsxs("div",{className:"flex gap-4",children:[s.jsxs(Pe,{className:"w-10 h-10",children:[s.jsx(Ae,{src:x.user.avatar}),s.jsx(Re,{className:"bg-primary text-primary-foreground",children:x.user.name.charAt(0).toUpperCase()})]}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsx("span",{className:"font-semibold text-sm",children:x.user.name}),s.jsx("span",{className:"text-xs text-muted-foreground",children:y(x.createdAt)})]}),s.jsx("p",{className:"text-sm mb-2",children:x.content}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(P,{variant:"ghost",size:"sm",className:"text-xs h-6 px-2",children:[s.jsx(Ht,{className:`w-3 h-3 mr-1 ${x.isLiked?"fill-red-500 text-red-500":""}`}),x.likes]}),s.jsx(P,{variant:"ghost",size:"sm",className:"text-xs h-6 px-2",children:"Reply"})]})]})]},x.id))})]})]})]}),s.jsxs("div",{className:"space-y-6",children:[s.jsx(V,{className:"bg-surface-elevated",children:s.jsx(G,{className:"p-6",children:s.jsxs("div",{className:"text-center space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("p",{className:"text-2xl font-bold text-primary",children:typeof r.budget=="string"?r.budget:`${r.budget.currency} ${r.budget.total}`}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"per person"})]}),s.jsx(P,{onClick:w,className:`w-full ${p?"bg-secondary text-secondary-foreground":"bg-gradient-primary text-white"}`,size:"lg",children:p?"Interest Sent!":"I'm Interested"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"You can contact the organizer directly after expressing interest"})]})})}),s.jsxs(V,{className:"bg-surface-elevated",children:[s.jsx(_e,{children:s.jsx(Ee,{className:"text-lg",children:"Trip Details"})}),s.jsx(G,{className:"space-y-4",children:s.jsxs("div",{className:"space-y-3 text-sm",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-medium mb-1",children:"Duration"}),s.jsx("p",{className:"text-muted-foreground",children:r.duration})]}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium mb-1",children:"Trip Type"}),s.jsx("p",{className:"text-muted-foreground",children:r.type})]}),r.meetingPoint&&s.jsxs("div",{children:[s.jsx("p",{className:"font-medium mb-1",children:"Meeting Point"}),s.jsx("p",{className:"text-muted-foreground",children:r.meetingPoint})]}),r.requirements&&r.requirements.length>0&&s.jsxs("div",{children:[s.jsx("p",{className:"font-medium mb-1",children:"Requirements"}),s.jsx("ul",{className:"text-muted-foreground space-y-1",children:r.requirements.map((x,j)=>s.jsxs("li",{className:"text-xs",children:[" ",x]},j))})]})]})})]}),s.jsxs(V,{className:"bg-surface-elevated",children:[s.jsx(_e,{children:s.jsx(Ee,{className:"text-lg",children:"Who's Going"})}),s.jsx(G,{children:s.jsxs("div",{className:"space-y-3",children:[r.participants.map(x=>s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs(Pe,{className:"w-10 h-10",children:[s.jsx(Ae,{src:x.avatar}),s.jsx(Re,{className:"bg-primary text-primary-foreground",children:x.name.split(" ").map(j=>j[0]).join("")})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx("p",{className:"font-medium text-sm",children:x.name}),s.jsx("p",{className:"text-xs text-muted-foreground",children:x.username})]}),x.role==="organizer"&&s.jsx(Le,{variant:"outline",className:"text-xs",children:"Organizer"})]},x.id)),s.jsx("div",{className:"text-center pt-2",children:s.jsxs("p",{className:"text-xs text-muted-foreground",children:[r.maxParticipants-r.currentParticipants," spots remaining"]})})]})})]}),s.jsx(V,{className:"bg-surface-elevated",children:s.jsx(G,{className:"p-4",children:s.jsxs(P,{variant:"outline",className:"w-full",children:[s.jsx(Xr,{className:"w-4 h-4 mr-2"}),"Share Trip"]})})})]})]})]}):s.jsx("div",{className:"max-w-4xl mx-auto px-4 py-6",children:s.jsx("div",{className:"flex items-center justify-center min-h-[60vh]",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Trip not found"}),s.jsx("p",{className:"text-muted-foreground mb-4",children:"The trip you're looking for doesn't exist or has been removed."}),s.jsx(P,{asChild:!0,variant:"outline",children:s.jsx(Ne,{to:"/find-trips",children:"Browse Trips"})})]})})})},gC=()=>{const{id:t}=on(),[e,r]=u.useState(null),[a,n]=u.useState(!0),[o,i]=u.useState(null),[l,c]=u.useState(!1),[d,h]=u.useState(""),[m,p]=u.useState(!1),{toast:f}=Ct();u.useEffect(()=>{(async()=>{if(t)try{n(!0),i(null);const _=await As.getJourney(t);_.success&&_.data&&(r(_.data.journey),c(_.data.journey.isLiked||!1))}catch(_){console.error("Error fetching journey:",_),_ instanceof Error&&_.message.includes("404")?i("Journey not found"):i("Failed to load journey details")}finally{n(!1)}})()},[t]);const b=async()=>{if(e)try{const S=await As.toggleLike(e.id);S.success&&S.data&&(c(S.data.isLiked),r(_=>_&&{..._,likeCount:S.data.likeCount})),f({title:l?"Removed from favorites":"Added to favorites",description:l?"Journey removed from your favorites":"Journey added to your favorites"})}catch(S){console.error("Error toggling like:",S),f({title:"Error",description:"Failed to update favorite status",variant:"destructive"})}},g=async()=>{if(!(!e||!d.trim()))try{p(!0);const S=await As.addComment(e.id,d.trim());S.success&&S.data&&r(_=>_&&{..._,comments:[..._.comments,S.data.comment],commentCount:S.data.commentCount}),h(""),f({title:"Comment added",description:"Your comment has been added successfully"})}catch(S){console.error("Error adding comment:",S),f({title:"Error",description:"Failed to add comment. Please try again.",variant:"destructive"})}finally{p(!1)}},y=async()=>{try{navigator.share?await navigator.share({title:e?.title||"Journey",text:`Check out this amazing journey: ${e?.title}`,url:window.location.href}):(await navigator.clipboard.writeText(window.location.href),f({title:"Link copied",description:"Journey link copied to clipboard"}))}catch(S){console.error("Error sharing:",S),f({title:"Error",description:"Failed to share journey",variant:"destructive"})}};if(a)return s.jsx("div",{className:"max-w-6xl mx-auto px-4 py-6 flex items-center justify-center min-h-screen",children:s.jsxs("div",{className:"text-center",children:[s.jsx(ge,{className:"w-8 h-8 animate-spin mx-auto mb-4"}),s.jsx("p",{className:"text-muted-foreground",children:"Loading journey details..."})]})});if(o)return s.jsx("div",{className:"max-w-6xl mx-auto px-4 py-6 flex items-center justify-center min-h-screen",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-gray-600 mb-4",children:o}),s.jsxs("div",{className:"flex gap-2 justify-center",children:[s.jsx(P,{onClick:()=>window.location.reload(),variant:"outline",children:"Try Again"}),s.jsx(P,{asChild:!0,children:s.jsx(Ne,{to:"/map",children:"Back to Map"})})]})]})});if(!e)return s.jsx("div",{className:"max-w-6xl mx-auto px-4 py-6 flex items-center justify-center min-h-screen",children:s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-gray-600 mb-4",children:"Journey not found"}),s.jsx(P,{asChild:!0,children:s.jsxs(Ne,{to:"/map",children:[s.jsx(ct,{className:"w-4 h-4 mr-2"}),"Back to Travel Map"]})})]})});const w=S=>{try{return new Date(S).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}catch{return"Unknown date"}},v=S=>{const _=[rn,On,Yt,Jr];return _[S%_.length]},x=e?.images||[],j=e?.destinations||[],N=e?.comments||[];return s.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-6",children:[s.jsx(P,{variant:"ghost",asChild:!0,className:"mb-4",children:s.jsxs(Ne,{to:"/map",children:[s.jsx(ct,{className:"w-4 h-4 mr-2"}),"Back to Travel Map"]})}),s.jsx(V,{className:"bg-surface-elevated mb-8",children:s.jsx(G,{className:"p-8",children:s.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("h1",{className:"text-3xl font-bold mb-4",children:e.title}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-2xl font-bold text-primary",children:j.length}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Destinations"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-2xl font-bold text-success",children:e.duration||"N/A"}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Duration"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-2xl font-bold text-warning",children:x.length}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Photos"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-2xl font-bold text-accent",children:e.views}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"Views"})]})]}),s.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:j.map((S,_)=>s.jsxs(Le,{variant:"secondary",children:[s.jsx(Ie,{className:"w-3 h-3 mr-1"}),S]},_))}),s.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:e.tags?.map((S,_)=>s.jsxs(Le,{variant:"outline",children:["#",S]},`tag-${_}`))}),s.jsx("div",{className:"prose prose-sm max-w-none mb-6",children:e.description?.split(`
`).map((S,_)=>s.jsx("p",{className:"mb-3 leading-relaxed",children:S},_))}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"font-semibold text-lg",children:"Destinations"}),e.destinations?.map((S,_)=>s.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[s.jsx("div",{className:"w-2 h-2 bg-primary rounded-full"}),s.jsx("span",{children:S})]},_))]})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsxs(P,{variant:l?"default":"outline",size:"sm",onClick:b,className:"flex items-center gap-2",children:[s.jsx(Ht,{className:`w-4 h-4 ${l?"fill-current":""}`}),e.likes||0]}),s.jsx(P,{variant:"outline",size:"sm",onClick:y,children:s.jsx(Xr,{className:"w-4 h-4"})})]})]})})}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[s.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[s.jsxs(V,{className:"bg-surface-elevated",children:[s.jsx(_e,{children:s.jsxs(Ee,{className:"flex items-center gap-2",children:[s.jsx(lt,{className:"w-5 h-5"}),"Photo Gallery (",x.length,")"]})}),s.jsx(G,{children:x.length>0?s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:x.map((S,_)=>s.jsxs("div",{className:"group cursor-pointer",children:[s.jsx("div",{className:"aspect-square overflow-hidden rounded-lg bg-muted",children:s.jsx("img",{src:S||v(_),alt:`Journey photo ${_+1}`,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",onError:E=>{const k=E.target;k.src=v(_)}})}),s.jsxs("div",{className:"mt-2",children:[s.jsxs("h4",{className:"font-semibold",children:["Journey Photo ",_+1]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:"No caption available"})]})]},_))}):s.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[s.jsx(lt,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"No photos available for this journey."})]})})]}),s.jsxs(V,{className:"bg-surface-elevated",children:[s.jsx(_e,{children:s.jsxs(Ee,{className:"flex items-center gap-2",children:[s.jsx(us,{className:"w-5 h-5"}),"Comments (",N.length,")"]})}),s.jsx(G,{children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"flex gap-3",children:[s.jsxs(Pe,{className:"w-8 h-8",children:[s.jsx(Ae,{src:""}),s.jsx(Re,{children:"You"})]}),s.jsxs("div",{className:"flex-1",children:[s.jsx(xs,{placeholder:"Share your thoughts about this journey...",value:d,onChange:S=>h(S.target.value),className:"min-h-[80px] resize-none"}),s.jsx("div",{className:"flex justify-end mt-2",children:s.jsxs(P,{onClick:g,disabled:!d.trim()||m,size:"sm",children:[m?s.jsx(ge,{className:"w-4 h-4 animate-spin mr-2"}):null,"Post Comment"]})})]})]}),s.jsx("div",{className:"space-y-4",children:N.length>0?N.map(S=>s.jsx("div",{className:"bg-gradient-to-r from-primary/5 to-transparent pl-4 rounded-r-lg",children:s.jsxs("div",{className:"flex gap-3 py-3",children:[s.jsxs(Pe,{className:"w-8 h-8",children:[s.jsx(Ae,{src:S.user.avatar}),s.jsxs(Re,{children:[S.user.firstName," ",S.user.lastName]})]}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[s.jsxs("span",{className:"font-medium text-sm",children:[S.user.firstName," ",S.user.lastName]}),s.jsx("span",{className:"text-xs text-muted-foreground",children:w(S.createdAt)})]}),s.jsx("p",{className:"text-sm leading-relaxed",children:S.content})]})]})},S.id)):s.jsxs("div",{className:"text-center py-4 text-muted-foreground border-t",children:[s.jsx(us,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),s.jsx("p",{className:"text-sm",children:"No comments yet. Be the first to share your thoughts!"})]})})]})})]})]}),s.jsx("div",{className:"lg:col-span-1 space-y-6",children:s.jsxs(V,{className:"bg-surface-elevated",children:[s.jsx(_e,{children:s.jsx(Ee,{children:"Journey Stats"})}),s.jsx(G,{className:"space-y-4",children:s.jsxs("div",{className:"space-y-3 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"Created"}),s.jsx("span",{className:"font-medium",children:w(e.createdAt)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"Updated"}),s.jsx("span",{className:"font-medium",children:w(e.updatedAt)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"Author"}),s.jsxs("span",{className:"font-medium",children:[e.author.firstName," ",e.author.lastName]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"Destinations"}),s.jsx("span",{className:"font-medium",children:j.length})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"Difficulty"}),s.jsx("span",{className:"font-medium capitalize",children:e.difficulty})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{className:"text-muted-foreground",children:"Budget"}),s.jsx("span",{className:"font-medium",children:e.budget})]})]})})]})})]})]})},xC=()=>{const{id:t}=on(),[e,r]=u.useState(null),[a,n]=u.useState([]),[o,i]=u.useState(!0),[l,c]=u.useState(null),[d,h]=u.useState(!1),[m,p]=u.useState(!1),[f,b]=u.useState(!1),[g,y]=u.useState(!1),[w,v]=u.useState({category:"",amount:0,description:"",date:new Date().toISOString().split("T")[0]}),[x,j]=u.useState({startDate:"",endDate:""}),{toast:N}=Ct(),S=async()=>{try{if(i(!0),c(null),!t){c("Budget ID is required"),i(!1);return}console.log(" Fetching budget data for ID:",t);const{budget:I,expenses:L}=await Ts.getTripBudgetDetails(t);if(console.log(" Budget data received:",{hasBudget:!!I,hasExpenses:!!L,expenseCount:L?.length||0}),!I){console.error(" Budget data is null"),c("Budget not found"),i(!1);return}if(r(I),n((L||[]).filter(Boolean)),I.startDate&&I.endDate){const D=I.startDate.includes("T")?I.startDate.split("T")[0]:I.startDate,ie=I.endDate.includes("T")?I.endDate.split("T")[0]:I.endDate;j({startDate:D,endDate:ie})}I.currency&&E(I.currency)}catch(I){c(I.message||"Failed to load budget details"),console.error("Error fetching budget data:",I),N({title:"Error",description:I.message||"Failed to load budget details. Please try again.",variant:"destructive"})}finally{i(!1)}};u.useEffect(()=>{t&&S()},[t]);const[_,E]=u.useState("USD");u.useEffect(()=>{(async()=>{try{const{userService:L}=await we(async()=>{const{userService:ie}=await Promise.resolve().then(()=>Pc);return{userService:ie}},void 0,import.meta.url),D=await L.getUserCurrency();E(D)}catch(L){console.error("Error loading currency preference:",L),e?.currency&&E(e.currency)}})()},[e?.currency]);const k=async I=>{if(!(!t||!e))try{const{userService:L}=await we(async()=>{const{userService:D}=await Promise.resolve().then(()=>Pc);return{userService:D}},void 0,import.meta.url);await L.updateUserPreferences({currency:I}),await Ts.updateBudget({id:t,currency:I}),E(I),await S()}catch(L){console.error("Error saving currency preference:",L),N({title:"Error",description:L.message||"Failed to update currency. Please try again.",variant:"destructive"})}},A={USD:1,EUR:.93,GBP:.79,JPY:151.72,CNY:7.24,INR:83.42,CAD:1.37,AUD:1.52,RUB:91.75,BRL:5.16},B=(I,L,D)=>L===D?I:I/A[L]*A[D],$=e?.noMaxBudget?null:e?B(e.totalBudget||0,e.currency,_):0,H=e?B(e.spent||0,e.currency,_):0,O=e?.noMaxBudget?null:e?B(e.remaining||0,e.currency,_):0,Y=I=>{switch(I){case"USD":case"CAD":case"AUD":return"$";case"EUR":return"";case"GBP":return"";case"JPY":case"CNY":return"";case"INR":return"";case"RUB":return"";case"BRL":return"R$";default:return"$"}},z={Accommodation:"bg-primary",Food:"bg-success",Transport:"bg-warning",Activities:"bg-accent",Shopping:"bg-destructive",Miscellaneous:"bg-muted"},M=(I=>{if(!I||!Array.isArray(I))return Object.keys(z).map(D=>({name:D,spent:0,budget:e?.totalBudget?Math.floor(e.totalBudget/6):0,color:z[D]}));const L=new Map;return I.forEach(D=>{if(D&&D.category&&typeof D.amount=="number"&&!isNaN(D.amount)){const ie=L.get(D.category)||0;L.set(D.category,ie+D.amount)}}),Object.keys(z).map(D=>{const ie=L.get(D)||0;return{name:D,spent:ie,budget:e?.totalBudget?Math.floor(e.totalBudget/6):0,color:z[D]}})})(a),C=I=>{if(!I)return"Not set";try{const L=I.includes("T")?new Date(I):new Date(I+"T00:00:00");return isNaN(L.getTime())?"Invalid Date":L.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(L){return console.error("Date parsing error:",L,I),"Invalid Date"}},q=async()=>{if(!t||!w.category||!w.amount||!w.description||!w.date){N({title:"Error",description:"Please fill in all required fields.",variant:"destructive"});return}try{p(!0);const{supabase:I}=await we(async()=>{const{supabase:ce}=await Promise.resolve().then(()=>Jt);return{supabase:ce}},void 0,import.meta.url),{data:{session:L},error:D}=await I.auth.getSession();if(D||!L?.user)throw new Error("Not authenticated. Please log in.");const ie={category:w.category,amount:Number(w.amount),description:w.description,date:w.date,currency:_,user_id:L.user.id};console.log(" Adding expense:",ie);const oe=await Ts.addBudgetExpense(t,ie);console.log(" Expense created:",oe),console.log(" Refetching budget data after expense addition..."),await S(),console.log(" Budget data refetched successfully"),v({category:"",amount:0,description:"",date:new Date().toISOString().split("T")[0]}),h(!1),N({title:"Success",description:"Expense added successfully!"})}catch(I){console.error("Error adding expense:",I),N({title:"Error",description:I instanceof Error?I.message:"Failed to add expense. Please try again.",variant:"destructive"})}finally{p(!1)}},T=I=>M.find(D=>D.name===I)?.color||"bg-muted",U=I=>{const L=M.find(D=>D.name===I);return L?L.spent/L.budget*100:0},X=async I=>{if(!(!e||!t))try{y(!0),console.log(" Updating budget status:",{id:t,newStatus:I}),await Ts.updateBudget({id:t,status:I}),console.log(" Budget status updated, refetching..."),await S(),console.log(" Budget data refetched after status update"),N({title:"Success",description:`Budget marked as ${I==="completed"?"complete":"active"}.`})}catch(L){console.error("Error updating budget status:",L),N({title:"Error",description:L.message||"Failed to update budget status. Please try again.",variant:"destructive"})}finally{y(!1)}},de=async()=>{if(!e||!t)return;if(!x.startDate||!x.endDate){N({title:"Error",description:"Please provide both start and end dates.",variant:"destructive"});return}const I=new Date(x.startDate),L=new Date(x.endDate);if(isNaN(I.getTime())||isNaN(L.getTime())){N({title:"Error",description:"Invalid date format. Please use YYYY-MM-DD format.",variant:"destructive"});return}if(I>L){N({title:"Error",description:"Start date must be before end date.",variant:"destructive"});return}try{y(!0),console.log(" Updating budget dates:",{id:t,startDate:x.startDate,endDate:x.endDate}),await Ts.updateBudget({id:t,startDate:x.startDate,endDate:x.endDate}),console.log(" Budget dates updated, refetching..."),await S(),console.log(" Budget data refetched after date update"),b(!1),N({title:"Success",description:"Trip dates updated successfully!"})}catch(D){console.error("Error updating dates:",D),N({title:"Error",description:D.message||"Failed to update dates. Please try again.",variant:"destructive"})}finally{y(!1)}};return o?s.jsx("div",{className:"max-w-6xl mx-auto px-4 py-6 flex items-center justify-center min-h-screen",children:s.jsxs("div",{className:"text-center",children:[s.jsx(ge,{className:"w-8 h-8 animate-spin text-primary mx-auto mb-4"}),s.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Loading budget details..."}),s.jsx("p",{className:"text-gray-600",children:"Please wait while we fetch your budget information."})]})}):l?s.jsx("div",{className:"max-w-6xl mx-auto px-4 py-6 flex items-center justify-center min-h-screen",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h2",{className:"text-2xl font-bold text-red-600 mb-2",children:"Error loading budget"}),s.jsx("p",{className:"text-gray-600 mb-4",children:l}),s.jsxs("div",{className:"flex gap-2 justify-center",children:[s.jsx(P,{onClick:()=>window.location.reload(),variant:"outline",children:"Try Again"}),s.jsx(Ne,{to:"/budget",children:s.jsxs(P,{children:[s.jsx(ct,{className:"w-4 h-4 mr-2"}),"Back to Budgets"]})})]})]})}):e?s.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-6",children:[s.jsx(P,{variant:"ghost",asChild:!0,className:"mb-4",children:s.jsxs(Ne,{to:"/budget",children:[s.jsx(ct,{className:"w-4 h-4 mr-2"}),"Back to Budget Planner"]})}),s.jsx(V,{className:"bg-surface-elevated mb-8",children:s.jsx(G,{className:"p-8",children:s.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold mb-2",children:e.title}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 text-muted-foreground",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Ie,{className:"w-4 h-4"}),e.destination]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Be,{className:"w-4 h-4"}),e.startDate&&e.endDate?s.jsxs("span",{children:[C(e.startDate)," - ",C(e.endDate)]}):s.jsx("span",{className:"text-muted-foreground",children:"Dates not set"}),s.jsx(P,{variant:"ghost",size:"sm",className:"h-6 px-2 ml-2",onClick:()=>{if(e.startDate&&e.endDate){const I=e.startDate.includes("T")?e.startDate.split("T")[0]:e.startDate,L=e.endDate.includes("T")?e.endDate.split("T")[0]:e.endDate;j({startDate:I,endDate:L})}b(!0)},children:s.jsx(Un,{className:"w-3 h-3"})})]}),s.jsx(Le,{variant:e.status==="active"?"default":"secondary",children:e.status.charAt(0).toUpperCase()+e.status.slice(1)}),e.noMaxBudget&&s.jsx(Le,{variant:"outline",className:"bg-warning/10 text-warning",children:"No Max Budget"})]})]}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs(fs,{value:_,onValueChange:k,children:[s.jsx(Qt,{className:"w-[120px]",children:s.jsx(ps,{placeholder:"Currency"})}),s.jsxs(Xt,{children:[s.jsx(ae,{value:"USD",children:"USD ($)"}),s.jsx(ae,{value:"EUR",children:"EUR ()"}),s.jsx(ae,{value:"GBP",children:"GBP ()"}),s.jsx(ae,{value:"JPY",children:"JPY ()"}),s.jsx(ae,{value:"CNY",children:"CNY ()"}),s.jsx(ae,{value:"INR",children:"INR ()"}),s.jsx(ae,{value:"CAD",children:"CAD ($)"}),s.jsx(ae,{value:"AUD",children:"AUD ($)"}),s.jsx(ae,{value:"RUB",children:"RUB ()"}),s.jsx(ae,{value:"BRL",children:"BRL (R$)"})]})]}),e.status==="completed"?s.jsxs(P,{className:"bg-gradient-primary text-white",onClick:()=>X("active"),disabled:g,children:[s.jsx(Ep,{className:"w-4 h-4 mr-2"}),g?"Reopening...":"Reopen Budget"]}):s.jsxs(s.Fragment,{children:[s.jsxs(P,{className:"bg-gradient-primary text-white",onClick:()=>h(!0),disabled:e.status==="completed",children:[s.jsx(Qe,{className:"w-4 h-4 mr-2"}),"Add Expense"]}),s.jsxs(P,{variant:"outline",onClick:()=>X("completed"),disabled:g,children:[s.jsx(ri,{className:"w-4 h-4 mr-2"}),g?"Completing...":"Mark Complete"]})]})]}),s.jsx(ut,{open:d,onOpenChange:h,children:s.jsxs(st,{children:[s.jsx(rt,{children:s.jsx(at,{children:"Add New Expense"})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(J,{htmlFor:"category",children:"Category"}),s.jsxs(fs,{value:w.category,onValueChange:I=>v({...w,category:I}),children:[s.jsx(Qt,{children:s.jsx(ps,{placeholder:"Select category"})}),s.jsx(Xt,{children:M.map(I=>s.jsx(ae,{value:I.name,children:I.name},I.name))})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(J,{htmlFor:"amount",children:["Amount (",_,")"]}),s.jsx(se,{id:"amount",type:"number",placeholder:"0.00",value:w.amount||"",onChange:I=>v({...w,amount:Number(I.target.value)})})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(J,{htmlFor:"date",children:"Date"}),s.jsx(se,{id:"date",type:"date",value:w.date,onChange:I=>v({...w,date:I.target.value})})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(J,{htmlFor:"description",children:"Description"}),s.jsx(xs,{id:"description",placeholder:"What did you spend money on?",value:w.description,onChange:I=>v({...w,description:I.target.value})})]}),s.jsxs(P,{onClick:q,disabled:m||!w.category||!w.amount||!w.description||!w.date,className:"w-full bg-gradient-primary text-white",children:[m?s.jsx(ge,{className:"w-4 h-4 mr-2 animate-spin"}):s.jsx(Qe,{className:"w-4 h-4 mr-2"}),m?"Adding...":"Add Expense"]})]})]})}),s.jsx(ut,{open:f,onOpenChange:b,children:s.jsxs(st,{children:[s.jsx(rt,{children:s.jsx(at,{children:"Edit Trip Dates"})}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(J,{htmlFor:"editStartDate",children:"Start Date"}),s.jsx(se,{id:"editStartDate",type:"date",value:x.startDate,onChange:I=>j(L=>({...L,startDate:I.target.value}))})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(J,{htmlFor:"editEndDate",children:"End Date"}),s.jsx(se,{id:"editEndDate",type:"date",value:x.endDate,onChange:I=>j(L=>({...L,endDate:I.target.value}))})]})]}),s.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[s.jsx(P,{variant:"outline",onClick:()=>b(!1),children:"Cancel"}),s.jsx(P,{onClick:de,disabled:g,className:"bg-gradient-primary text-white",children:g?s.jsxs(s.Fragment,{children:[s.jsx(ge,{className:"w-4 h-4 mr-2 animate-spin"}),"Updating..."]}):"Save Dates"})]})]})]})})]})})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[s.jsx(V,{className:"bg-surface-elevated",children:s.jsx(G,{className:"p-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-primary/10 rounded-lg",children:s.jsx(ir,{className:"w-6 h-6 text-primary"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Budget"}),e.noMaxBudget?s.jsx("p",{className:"text-2xl font-bold",children:"No Maximum"}):s.jsxs("p",{className:"text-2xl font-bold",children:[Y(_),($||0).toLocaleString(void 0,{maximumFractionDigits:2})]})]})]})})}),s.jsx(V,{className:"bg-surface-elevated",children:s.jsx(G,{className:"p-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-destructive/10 rounded-lg",children:s.jsx(Or,{className:"w-6 h-6 text-destructive"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Spent"}),s.jsxs("p",{className:"text-2xl font-bold text-destructive",children:[Y(_),(H||0).toLocaleString(void 0,{maximumFractionDigits:2})]})]})]})})}),s.jsx(V,{className:"bg-surface-elevated",children:s.jsx(G,{className:"p-6",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-3 bg-success/10 rounded-lg",children:s.jsx(Da,{className:"w-6 h-6 text-success"})}),s.jsxs("div",{children:[s.jsx("p",{className:"text-sm text-muted-foreground",children:"Remaining"}),e.noMaxBudget?s.jsx("p",{className:"text-2xl font-bold text-success",children:"Unlimited"}):s.jsxs("p",{className:"text-2xl font-bold text-success",children:[Y(_),(O||0).toLocaleString(void 0,{maximumFractionDigits:2})]})]})]})})}),s.jsx(V,{className:"bg-surface-elevated",children:s.jsxs(G,{className:"p-6 text-center",children:[s.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Budget Used"}),s.jsxs("p",{className:"text-3xl font-bold mb-2",children:[e.progress,"%"]}),s.jsx(sn,{value:e.progress,className:"h-2"})]})})]}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[s.jsxs(V,{className:"bg-surface-elevated",children:[s.jsx(_e,{children:s.jsx(Ee,{children:"Spending by Category"})}),s.jsx(G,{children:s.jsx("div",{className:"space-y-6",children:M.map(I=>s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"font-medium",children:I.name}),s.jsxs("span",{className:"text-sm text-muted-foreground",children:[Y(_),B(I.spent,e?.currency||"USD",_).toFixed(2)," / ",Y(_),B(I.budget,e?.currency||"USD",_).toFixed(2)]})]}),s.jsx(sn,{value:U(I.name),className:"h-2"}),s.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[s.jsxs("span",{children:[U(I.name).toFixed(0),"% used"]}),s.jsxs("span",{children:[Y(_),B(I.budget-I.spent,e?.currency||"USD",_).toFixed(2)," remaining"]})]})]},I.name))})})]}),s.jsxs(V,{className:"bg-surface-elevated",children:[s.jsx(_e,{children:s.jsx(Ee,{children:"Recent Expenses"})}),s.jsx(G,{children:s.jsx("div",{className:"space-y-4",children:(a||[]).length===0?s.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[s.jsx("p",{children:"No expenses recorded yet."}),s.jsx("p",{className:"text-sm",children:"Add your first expense to start tracking your budget."})]}):(a||[]).filter(Boolean).slice(0,10).map(I=>s.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/30",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:`w-3 h-3 rounded-full ${T(I.category)}`}),s.jsxs("div",{children:[s.jsx("p",{className:"font-medium text-sm",children:I.description}),s.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[s.jsx("span",{children:I.category}),s.jsx("span",{children:""}),s.jsx("span",{children:C(I.date)})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("span",{className:"font-semibold",children:[Y(e?.currency||"USD"),B(I.amount,e?.currency||"USD",_).toFixed(2)]}),s.jsxs("div",{className:"flex gap-1",children:[s.jsx(P,{variant:"ghost",size:"icon",className:"h-6 w-6",children:s.jsx(Un,{className:"w-3 h-3"})}),s.jsx(P,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive",children:s.jsx(xo,{className:"w-3 h-3"})})]})]})]},I.id))})})]})]}),s.jsxs(V,{className:"bg-surface-elevated mt-8",children:[s.jsx(_e,{children:s.jsxs(Ee,{children:["All Expenses (",(a||[]).length,")"]})}),s.jsx(G,{children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"bg-muted/20",children:[s.jsx("th",{className:"text-left p-2 font-medium",children:"Date"}),s.jsx("th",{className:"text-left p-2 font-medium",children:"Category"}),s.jsx("th",{className:"text-left p-2 font-medium",children:"Description"}),s.jsx("th",{className:"text-right p-2 font-medium",children:"Amount"}),s.jsx("th",{className:"text-center p-2 font-medium",children:"Actions"})]})}),s.jsx("tbody",{children:(a||[]).length===0?s.jsx("tr",{children:s.jsxs("td",{colSpan:5,className:"p-8 text-center text-muted-foreground",children:[s.jsx("p",{children:"No expenses recorded yet."}),s.jsx("p",{className:"text-sm",children:"Add your first expense to start tracking your budget."})]})}):(a||[]).filter(Boolean).map(I=>s.jsxs("tr",{className:"hover:bg-muted/10 transition-colors",children:[s.jsx("td",{className:"p-2 text-sm text-muted-foreground",children:C(I.date)}),s.jsx("td",{className:"p-2",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:`w-2 h-2 rounded-full ${T(I.category)}`}),s.jsx("span",{className:"text-sm",children:I.category})]})}),s.jsx("td",{className:"p-2 text-sm",children:I.description}),s.jsxs("td",{className:"p-2 text-right font-medium",children:[Y(e?.currency||"USD"),B(I.amount,e?.currency||"USD",_).toFixed(2)]}),s.jsx("td",{className:"p-2 text-center",children:s.jsxs("div",{className:"flex justify-center gap-1",children:[s.jsx(P,{variant:"ghost",size:"icon",className:"h-7 w-7",children:s.jsx(Un,{className:"w-3 h-3"})}),s.jsx(P,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive",children:s.jsx(xo,{className:"w-3 h-3"})})]})})]},I.id))})]})})})]})]}):s.jsx("div",{className:"max-w-6xl mx-auto px-4 py-6 flex items-center justify-center min-h-screen",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Budget not found"}),s.jsx("p",{className:"text-gray-600 mb-4",children:"The budget you're looking for doesn't exist."}),s.jsx(Ne,{to:"/budget",children:s.jsxs(P,{children:[s.jsx(ct,{className:"w-4 h-4 mr-2"}),"Back to Budgets"]})})]})})};var Mn="Checkbox",[vC,tE]=Xe(Mn),[yC,Xi]=vC(Mn);function wC(t){const{__scopeCheckbox:e,checked:r,children:a,defaultChecked:n,disabled:o,form:i,name:l,onCheckedChange:c,required:d,value:h="on",internal_do_not_use_render:m}=t,[p,f]=Vt({prop:r,defaultProp:n??!1,onChange:c,caller:Mn}),[b,g]=u.useState(null),[y,w]=u.useState(null),v=u.useRef(!1),x=b?!!i||!!b.closest("form"):!0,j={checked:p,disabled:o,setChecked:f,control:b,setControl:g,name:l,form:i,value:h,hasConsumerStoppedPropagationRef:v,required:d,defaultChecked:ds(n)?!1:n,isFormControl:x,bubbleInput:y,setBubbleInput:w};return s.jsx(yC,{scope:e,...j,children:bC(m)?m(j):a})}var Uf="CheckboxTrigger",Bf=u.forwardRef(({__scopeCheckbox:t,onKeyDown:e,onClick:r,...a},n)=>{const{control:o,value:i,disabled:l,checked:c,required:d,setControl:h,setChecked:m,hasConsumerStoppedPropagationRef:p,isFormControl:f,bubbleInput:b}=Xi(Uf,t),g=xe(n,h),y=u.useRef(c);return u.useEffect(()=>{const w=o?.form;if(w){const v=()=>m(y.current);return w.addEventListener("reset",v),()=>w.removeEventListener("reset",v)}},[o,m]),s.jsx(ne.button,{type:"button",role:"checkbox","aria-checked":ds(c)?"mixed":c,"aria-required":d,"data-state":Vf(c),"data-disabled":l?"":void 0,disabled:l,value:i,...a,ref:g,onKeyDown:W(e,w=>{w.key==="Enter"&&w.preventDefault()}),onClick:W(r,w=>{m(v=>ds(v)?!0:!v),b&&f&&(p.current=w.isPropagationStopped(),p.current||w.stopPropagation())})})});Bf.displayName=Uf;var Zi=u.forwardRef((t,e)=>{const{__scopeCheckbox:r,name:a,checked:n,defaultChecked:o,required:i,disabled:l,value:c,onCheckedChange:d,form:h,...m}=t;return s.jsx(wC,{__scopeCheckbox:r,checked:n,defaultChecked:o,disabled:l,required:i,onCheckedChange:d,name:a,form:h,value:c,internal_do_not_use_render:({isFormControl:p})=>s.jsxs(s.Fragment,{children:[s.jsx(Bf,{...m,ref:e,__scopeCheckbox:r}),p&&s.jsx(Hf,{__scopeCheckbox:r})]})})});Zi.displayName=Mn;var zf="CheckboxIndicator",qf=u.forwardRef((t,e)=>{const{__scopeCheckbox:r,forceMount:a,...n}=t,o=Xi(zf,r);return s.jsx(ht,{present:a||ds(o.checked)||o.checked===!0,children:s.jsx(ne.span,{"data-state":Vf(o.checked),"data-disabled":o.disabled?"":void 0,...n,ref:e,style:{pointerEvents:"none",...t.style}})})});qf.displayName=zf;var Wf="CheckboxBubbleInput",Hf=u.forwardRef(({__scopeCheckbox:t,...e},r)=>{const{control:a,hasConsumerStoppedPropagationRef:n,checked:o,defaultChecked:i,required:l,disabled:c,name:d,value:h,form:m,bubbleInput:p,setBubbleInput:f}=Xi(Wf,t),b=xe(r,f),g=Hi(o),y=xi(a);u.useEffect(()=>{const v=p;if(!v)return;const x=window.HTMLInputElement.prototype,N=Object.getOwnPropertyDescriptor(x,"checked").set,S=!n.current;if(g!==o&&N){const _=new Event("click",{bubbles:S});v.indeterminate=ds(o),N.call(v,ds(o)?!1:o),v.dispatchEvent(_)}},[p,g,o,n]);const w=u.useRef(ds(o)?!1:o);return s.jsx(ne.input,{type:"checkbox","aria-hidden":!0,defaultChecked:i??w.current,required:l,disabled:c,name:d,value:h,form:m,...e,tabIndex:-1,ref:b,style:{...e.style,...y,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});Hf.displayName=Wf;function bC(t){return typeof t=="function"}function ds(t){return t==="indeterminate"}function Vf(t){return ds(t)?"indeterminate":t?"checked":"unchecked"}const el=u.forwardRef(({className:t,...e},r)=>s.jsx(Zi,{ref:r,className:Z("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...e,children:s.jsx(qf,{className:Z("flex items-center justify-center text-current"),children:s.jsx(Yr,{className:"h-4 w-4"})})}));el.displayName=Zi.displayName;const Uc={login:["Your Next Adventure Awaits.","Welcome Back, Explorer.","Continue Your Journey."],register:["Join a Community of Explorers.","Your Journey Begins Here.","Plan. Discover. Remember."]},Gf=({children:t,type:e})=>{const[r,a]=u.useState({x:0,y:0}),[n,o]=u.useState(0);return u.useEffect(()=>{const i=l=>{a({x:l.clientX/window.innerWidth,y:l.clientY/window.innerHeight})};return window.addEventListener("mousemove",i),()=>window.removeEventListener("mousemove",i)},[]),u.useEffect(()=>{const i=setInterval(()=>{o(l=>l===Uc[e].length-1?0:l+1)},5e3);return()=>clearInterval(i)},[e]),s.jsxs("div",{className:"min-h-screen w-full flex flex-col md:flex-row overflow-hidden",children:[s.jsxs(Q.div,{className:"relative h-[30vh] md:h-screen md:w-1/2 overflow-hidden",initial:{opacity:0},animate:{opacity:1},transition:{duration:1},children:[s.jsxs("div",{className:"absolute inset-0 z-0",children:[s.jsxs("video",{autoPlay:!0,muted:!0,loop:!0,className:"object-cover h-full w-full",style:{transform:`translate(${r.x*-20}px, ${r.y*-20}px) scale(1.1)`},children:[s.jsx("source",{src:e==="login"?"https://assets.mixkit.co/videos/preview/mixkit-aerial-view-of-a-beach-with-turquoise-water-4868-large.mp4":"https://assets.mixkit.co/videos/preview/mixkit-top-aerial-shot-of-seashore-with-rocks-1090-large.mp4",type:"video/mp4"}),"Your browser does not support the video tag."]}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-900/60 to-purple-900/60 backdrop-blur-[2px]"})]}),s.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-10",children:s.jsxs("div",{className:"text-center px-6",children:[s.jsx(Q.h1,{className:"text-4xl md:text-6xl font-bold text-white mb-4",initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.8},style:{transform:`translate(${r.x*10}px, ${r.y*10}px)`},children:Uc[e][n]},n),s.jsx(Q.p,{className:"text-xl text-white/80",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5,duration:.8},style:{transform:`translate(${r.x*5}px, ${r.y*5}px)`},children:e==="login"?"Sign in to continue your travel story.":"Create an account to start your travel journey."})]})})]}),s.jsx("div",{className:"flex-1 flex items-center justify-center p-6 md:p-12 bg-gradient-to-br from-blue-50 via-white to-purple-50",children:s.jsx(Q.div,{className:"w-full max-w-md",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.8},children:t})})]})},jC=()=>{const[t,e]=u.useState({email:"",password:"",rememberMe:!1}),[r,a]=u.useState(!1),[n,o]=u.useState(!1),{login:i}=mt(),l=Ls(),c=()=>{a(!r)},d=m=>{const{name:p,value:f,type:b,checked:g}=m.target;e(y=>({...y,[p]:b==="checkbox"?g:f}))},h=async m=>{if(m.preventDefault(),!t.email||!t.password){ee({title:"Validation Error",description:"Please fill in all required fields.",variant:"destructive"});return}o(!0);try{const p=await i(t.email,t.password);await new Promise(b=>setTimeout(b,100));const f=localStorage.getItem("redirectAfterAuth");f?(localStorage.removeItem("redirectAfterAuth"),l(f,{replace:!0})):l("/",{replace:!0})}catch(p){console.error("Login failed:",p),o(!1)}};return s.jsx(Gf,{type:"login",children:s.jsxs("div",{className:"w-full max-w-md p-8 space-y-8 bg-white rounded-xl border border-gray-200 shadow-2xl",children:[s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx(Q.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200,damping:15},className:"flex justify-center",children:s.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center shadow-lg",children:s.jsx(nn,{className:"w-8 h-8 text-white"})})}),s.jsxs(Q.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},children:[s.jsx("h1",{className:"text-3xl font-bold tracking-tight text-gray-900",children:"WanderSphere"}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Welcome Back"})]})]}),s.jsxs("form",{onSubmit:h,className:"space-y-6",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx(J,{htmlFor:"email",className:"text-gray-700 text-sm font-medium",children:"Email"}),s.jsx(se,{id:"email",name:"email",type:"email",value:t.email,onChange:d,placeholder:"Enter your email",required:!0,className:"h-12 bg-white border-gray-300 text-gray-900 placeholder:text-gray-400 focus:border-blue-500 focus:ring-blue-500"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx(J,{htmlFor:"password",className:"text-gray-700 text-sm font-medium",children:"Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(se,{id:"password",name:"password",type:r?"text":"password",value:t.password,onChange:d,placeholder:"Enter your password",required:!0,className:"h-12 bg-white border-gray-300 text-gray-900 placeholder:text-gray-400 focus:border-blue-500 focus:ring-blue-500 pr-10"}),s.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 transition-colors",onClick:c,children:r?s.jsx(vo,{className:"h-5 w-5"}):s.jsx(yo,{className:"h-5 w-5"})})]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(el,{id:"rememberMe",name:"rememberMe",checked:t.rememberMe,onCheckedChange:m=>e(p=>({...p,rememberMe:m===!0})),className:"border-gray-300 data-[state=checked]:bg-blue-500 data-[state=checked]:border-blue-500"}),s.jsx(J,{htmlFor:"rememberMe",className:"text-sm font-medium text-gray-700 cursor-pointer select-none",children:"Remember me"})]}),s.jsx(Ne,{to:"/forgot-password",className:"text-sm font-medium text-blue-600 hover:text-blue-700 transition-colors",children:"Forgot password?"})]}),s.jsx(P,{type:"submit",className:"w-full h-12 bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white font-medium shadow-lg transition-all duration-200",disabled:n,children:n?s.jsxs(s.Fragment,{children:[s.jsx(ge,{className:"mr-2 h-4 w-4 animate-spin"}),"Signing in..."]}):"Sign In"})]}),s.jsx("div",{className:"text-center pt-4",children:s.jsxs("p",{className:"text-sm text-gray-600",children:["Don't have an account?"," ",s.jsx(Ne,{to:"/register",className:"font-medium text-blue-600 hover:text-blue-700 transition-colors",children:"Sign up"})]})})]})})},Bc=[{regex:/.{8,}/,label:"At least 8 characters"},{regex:/[A-Z]/,label:"At least one uppercase letter"},{regex:/[a-z]/,label:"At least one lowercase letter"},{regex:/[0-9]/,label:"At least one number"},{regex:/[^A-Za-z0-9]/,label:"At least one special character"}],NC=()=>{const[t,e]=u.useState({firstName:"",lastName:"",email:"",username:"",password:"",confirmPassword:"",agreeToTerms:!1}),[r,a]=u.useState(!1),[n,o]=u.useState(!1),[i,l]=u.useState(!1),[c,d]=u.useState(!1),[h,m]=u.useState({}),{register:p}=mt(),f=Ls(),b=w=>{const{name:v,value:x,type:j,checked:N}=w.target;e(S=>({...S,[v]:j==="checkbox"?N:x})),h[v]&&m(S=>({...S,[v]:""}))},g=()=>{const w={};return t.firstName.trim()||(w.firstName="First name is required"),t.lastName.trim()||(w.lastName="Last name is required"),t.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t.email)||(w.email="Please enter a valid email address"):w.email="Email is required",t.password?Bc.every(v=>v.regex.test(t.password))||(w.password="Password does not meet all requirements"):w.password="Password is required",t.password!==t.confirmPassword&&(w.confirmPassword="Passwords do not match"),t.agreeToTerms||(w.agreeToTerms="You must agree to the Terms of Service"),m(w),Object.keys(w).length===0},y=async w=>{if(w.preventDefault(),!g()){ee({title:"Validation Error",description:"Please fix the errors in the form.",variant:"destructive"});return}l(!0);try{await p({firstName:t.firstName.trim(),lastName:t.lastName.trim(),email:t.email.trim(),username:t.username.trim()||void 0,password:t.password,confirmPassword:t.confirmPassword}),await new Promise(x=>setTimeout(x,100));const v=localStorage.getItem("redirectAfterAuth");v?(localStorage.removeItem("redirectAfterAuth"),f(v,{replace:!0})):f("/",{replace:!0})}catch(v){console.error("Registration failed:",v),l(!1)}};return s.jsx(Gf,{type:"register",children:s.jsxs(Q.div,{className:"w-full max-w-md p-8 space-y-8 bg-white rounded-xl border border-gray-200 shadow-2xl",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[s.jsxs("div",{className:"text-center space-y-4",children:[s.jsx(Q.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",stiffness:200,damping:15},className:"flex justify-center",children:s.jsxs("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center shadow-lg relative",children:[s.jsx(nn,{className:"w-8 h-8 text-white z-10"}),s.jsx(Q.div,{className:"absolute inset-0 rounded-full bg-gradient-to-br from-blue-400 to-purple-400",animate:{scale:[1,1.2,1],opacity:[.5,0,.5]},transition:{duration:2,repeat:1/0}})]})}),s.jsxs(Q.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},children:[s.jsx("h1",{className:"text-3xl font-bold tracking-tight text-gray-900",children:"Join WanderSphere"}),s.jsx("p",{className:"text-gray-600 mt-2",children:"Start your travel adventure today"})]})]}),s.jsxs("form",{onSubmit:y,className:"space-y-5",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs(Q.div,{className:"space-y-2",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.3},children:[s.jsx(J,{htmlFor:"firstName",className:"text-gray-700 text-sm font-medium",children:"First Name"}),s.jsx(se,{id:"firstName",name:"firstName",type:"text",placeholder:"John",value:t.firstName,onChange:b,required:!0,className:`h-12 ${h.firstName?"border-red-500":"border-gray-300"}`,disabled:i}),h.firstName&&s.jsx("p",{className:"text-xs text-red-500",children:h.firstName})]}),s.jsxs(Q.div,{className:"space-y-2",initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.4},children:[s.jsx(J,{htmlFor:"lastName",className:"text-gray-700 text-sm font-medium",children:"Last Name"}),s.jsx(se,{id:"lastName",name:"lastName",type:"text",placeholder:"Doe",value:t.lastName,onChange:b,required:!0,className:`h-12 ${h.lastName?"border-red-500":"border-gray-300"}`,disabled:i}),h.lastName&&s.jsx("p",{className:"text-xs text-red-500",children:h.lastName})]})]}),s.jsxs(Q.div,{className:"space-y-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},children:[s.jsx(J,{htmlFor:"email",className:"text-gray-700 text-sm font-medium",children:"Email Address"}),s.jsx(se,{id:"email",name:"email",type:"email",placeholder:"your.email@example.com",value:t.email,onChange:b,required:!0,className:`h-12 ${h.email?"border-red-500":"border-gray-300"}`,disabled:i}),h.email&&s.jsx("p",{className:"text-xs text-red-500",children:h.email})]}),s.jsxs(Q.div,{className:"space-y-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.6},children:[s.jsxs(J,{htmlFor:"username",className:"text-gray-700 text-sm font-medium",children:["Username ",s.jsx("span",{className:"text-gray-400 text-xs",children:"(Optional)"})]}),s.jsx(se,{id:"username",name:"username",type:"text",placeholder:"your_username",value:t.username,onChange:b,className:"h-12 border-gray-300",disabled:i})]}),s.jsxs(Q.div,{className:"space-y-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.7},children:[s.jsx(J,{htmlFor:"password",className:"text-gray-700 text-sm font-medium",children:"Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(se,{id:"password",name:"password",type:r?"text":"password",placeholder:"Create a strong password",value:t.password,onChange:b,onFocus:()=>d(!0),onBlur:()=>d(!1),required:!0,className:`h-12 pr-10 ${h.password?"border-red-500":"border-gray-300"}`,disabled:i}),s.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 transition-colors",onClick:()=>a(!r),disabled:i,children:r?s.jsx(vo,{className:"h-5 w-5"}):s.jsx(yo,{className:"h-5 w-5"})})]}),s.jsx(ur,{children:(c||t.password)&&s.jsxs(Q.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-2 p-3 bg-gradient-to-br from-blue-50 to-purple-50 rounded-lg border border-blue-100",children:[s.jsxs("p",{className:"text-xs font-medium text-gray-700 mb-2 flex items-center gap-1",children:[s.jsx(kp,{className:"w-3 h-3"}),"Password requirements:"]}),s.jsx("div",{className:"space-y-1.5",children:Bc.map((w,v)=>{const x=w.regex.test(t.password);return s.jsxs(Q.div,{className:"flex items-center space-x-2",initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:v*.05},children:[x?s.jsx(Yr,{className:"h-3.5 w-3.5 text-green-500"}):s.jsx(gr,{className:"h-3.5 w-3.5 text-gray-400"}),s.jsx("span",{className:`text-xs transition-colors ${x?"text-green-600 font-medium":"text-gray-500"}`,children:w.label})]},v)})})]})}),h.password&&s.jsx("p",{className:"text-xs text-red-500",children:h.password})]}),s.jsxs(Q.div,{className:"space-y-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.8},children:[s.jsx(J,{htmlFor:"confirmPassword",className:"text-gray-700 text-sm font-medium",children:"Confirm Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(se,{id:"confirmPassword",name:"confirmPassword",type:n?"text":"password",placeholder:"Confirm your password",value:t.confirmPassword,onChange:b,required:!0,className:`h-12 pr-10 ${h.confirmPassword?"border-red-500":"border-gray-300"}`,disabled:i}),s.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600 transition-colors",onClick:()=>o(!n),disabled:i,children:n?s.jsx(vo,{className:"h-5 w-5"}):s.jsx(yo,{className:"h-5 w-5"})})]}),t.confirmPassword&&t.password!==t.confirmPassword&&s.jsx(Q.p,{className:"text-xs text-red-500",initial:{opacity:0},animate:{opacity:1},children:"Passwords do not match"}),h.confirmPassword&&s.jsx("p",{className:"text-xs text-red-500",children:h.confirmPassword})]}),s.jsxs(Q.div,{className:"flex items-start space-x-2",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.9},children:[s.jsx(el,{id:"agreeToTerms",name:"agreeToTerms",checked:t.agreeToTerms,onCheckedChange:w=>e(v=>({...v,agreeToTerms:w})),disabled:i,className:`mt-1 ${h.agreeToTerms?"border-red-500":""}`}),s.jsxs(J,{htmlFor:"agreeToTerms",className:"text-sm font-normal leading-5 text-gray-700 cursor-pointer",children:["I agree to the"," ",s.jsx(Ne,{to:"/terms",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Terms of Service"})," ","and"," ",s.jsx(Ne,{to:"/privacy",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Privacy Policy"})]})]}),h.agreeToTerms&&s.jsx("p",{className:"text-xs text-red-500",children:h.agreeToTerms}),s.jsx(Q.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:1},children:s.jsxs(P,{type:"submit",className:"w-full h-12 bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white font-medium shadow-lg transition-all duration-200 relative overflow-hidden group",disabled:i,children:[s.jsx("span",{className:"relative z-10 flex items-center justify-center",children:i?s.jsxs(s.Fragment,{children:[s.jsx(ge,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating Account..."]}):"Create Account"}),s.jsx(Q.div,{className:"absolute inset-0 bg-gradient-to-r from-purple-500 to-blue-500",initial:{x:"-100%"},animate:i?{x:"100%"}:{},transition:{duration:1.5,repeat:1/0,ease:"linear"}})]})})]}),s.jsx(Q.div,{className:"text-center pt-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:1.1},children:s.jsxs("p",{className:"text-sm text-gray-600",children:["Already have an account?"," ",s.jsx(Ne,{to:"/login",className:"font-medium text-blue-600 hover:text-blue-700 transition-colors",children:"Sign in"})]})})]})})},SC=()=>{const[t,e]=u.useState([]),[r,a]=u.useState(!0),[n,o]=u.useState(0),[i,l]=u.useState("all"),[c,d]=u.useState(1),[h,m]=u.useState(1),{toast:p}=Ct();u.useEffect(()=>{f(),b()},[c,i]);const f=async()=>{try{a(!0);const N=i==="all"?void 0:i,S=await Es.getNotifications(c,20,N);S.success&&(e(S.data.notifications),m(S.data.pagination.totalPages))}catch(N){console.error("Error fetching notifications:",N),p({title:"Error",description:"Failed to load notifications",variant:"destructive"})}finally{a(!1)}},b=async()=>{try{const N=await Es.getUnreadCount();N.success&&o(N.data.unreadCount)}catch(N){console.error("Error fetching unread count:",N)}},g=async N=>{try{await Es.markAsRead(N),e(S=>S.map(_=>_.id===N?{..._,read:!0}:_)),o(S=>Math.max(0,S-1)),p({title:"Success",description:"Notification marked as read"})}catch(S){console.error("Error marking notification as read:",S),p({title:"Error",description:"Failed to mark notification as read",variant:"destructive"})}},y=async()=>{try{await Es.markAllAsRead(),e(N=>N.map(S=>({...S,read:!0}))),o(0),p({title:"Success",description:"All notifications marked as read"})}catch(N){console.error("Error marking all notifications as read:",N),p({title:"Error",description:"Failed to mark all notifications as read",variant:"destructive"})}},w=async N=>{try{await Es.deleteNotification(N),e(S=>S.filter(_=>_.id!==N)),p({title:"Success",description:"Notification deleted"})}catch(S){console.error("Error deleting notification:",S),p({title:"Error",description:"Failed to delete notification",variant:"destructive"})}},v=N=>{switch(N){case"like":return s.jsx(Ht,{className:"h-4 w-4 text-red-500"});case"comment":return s.jsx(us,{className:"h-4 w-4 text-blue-500"});case"follow":return s.jsx(go,{className:"h-4 w-4 text-green-500"});default:return s.jsx(Dr,{className:"h-4 w-4 text-gray-500"})}},x=N=>{const S=new Date(N),E=Math.floor((new Date().getTime()-S.getTime())/(1e3*60*60));return E<1?"Just now":E<24?`${E}h ago`:E<168?`${Math.floor(E/24)}d ago`:S.toLocaleDateString()},j=t.filter(N=>i==="all"?!0:N.type===i);return s.jsx("div",{className:"container mx-auto px-4 py-8 max-w-4xl",children:s.jsxs(V,{children:[s.jsx(_e,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(Dr,{className:"h-6 w-6 text-primary"}),s.jsx(Ee,{className:"text-2xl",children:"Notifications"}),n>0&&s.jsx(Le,{variant:"destructive",className:"rounded-full",children:n})]}),s.jsx("div",{className:"flex gap-2",children:n>0&&s.jsxs(P,{variant:"outline",size:"sm",onClick:y,className:"flex items-center gap-2",children:[s.jsx(Tp,{className:"h-4 w-4"}),"Mark all read"]})})]})}),s.jsx(G,{children:s.jsxs(Zt,{value:i,onValueChange:l,className:"w-full",children:[s.jsxs($t,{className:"grid w-full grid-cols-5",children:[s.jsx(ye,{value:"all",children:"All"}),s.jsxs(ye,{value:"like",className:"flex items-center gap-1",children:[s.jsx(Ht,{className:"h-3 w-3"})," Likes"]}),s.jsxs(ye,{value:"comment",className:"flex items-center gap-1",children:[s.jsx(us,{className:"h-3 w-3"})," Comments"]}),s.jsxs(ye,{value:"follow",className:"flex items-center gap-1",children:[s.jsx(go,{className:"h-3 w-3"})," Follows"]}),s.jsx(ye,{value:"system",children:"System"})]}),s.jsxs(be,{value:i,className:"mt-6",children:[r?s.jsx("div",{className:"flex justify-center py-8",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):j.length===0?s.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[s.jsx(Dr,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"No notifications found"})]}):s.jsx("div",{className:"space-y-2",children:j.map(N=>s.jsxs("div",{className:`flex items-start gap-3 p-4 rounded-lg border transition-colors hover:bg-muted/50 ${N.read?"bg-background":"bg-blue-50 border-blue-200"}`,children:[s.jsx("div",{className:"flex-shrink-0 mt-1",children:v(N.type)}),s.jsxs(Pe,{className:"h-10 w-10 flex-shrink-0",children:[s.jsx(Ae,{src:"/avatars/user.png",alt:"User"}),s.jsx(Re,{children:N.data?.followerName?.[0]||N.data?.likerName?.[0]||"U"})]}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-start justify-between gap-2",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium",children:N.title}),s.jsx("p",{className:"text-sm text-muted-foreground",children:N.message})]}),s.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:x(N.createdAt)})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[!N.read&&s.jsxs(P,{variant:"ghost",size:"sm",onClick:()=>g(N.id),className:"h-7 px-2 text-xs",children:[s.jsx(Yr,{className:"h-3 w-3 mr-1"}),"Mark read"]}),s.jsxs(P,{variant:"ghost",size:"sm",onClick:()=>w(N.id),className:"h-7 px-2 text-xs text-red-600 hover:text-red-700",children:[s.jsx(xo,{className:"h-3 w-3 mr-1"}),"Delete"]})]})]})]},N.id))}),h>1&&s.jsxs("div",{className:"flex justify-center gap-2 mt-6",children:[s.jsx(P,{variant:"outline",size:"sm",onClick:()=>d(N=>Math.max(1,N-1)),disabled:c===1,children:"Previous"}),s.jsxs("span",{className:"flex items-center px-3 text-sm text-muted-foreground",children:["Page ",c," of ",h]}),s.jsx(P,{variant:"outline",size:"sm",onClick:()=>d(N=>Math.min(h,N+1)),disabled:c===h,children:"Next"})]})]})]})})]})})},_C=()=>{const t=ai();return u.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",t.pathname)},[t.pathname]),s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:s.jsxs("div",{className:"text-center",children:[s.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),s.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),s.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},CC=({onSearch:t,isLoading:e=!1})=>{const[r,a]=u.useState(""),[n,o]=u.useState(""),[i,l]=u.useState(""),[c,d]=u.useState(1),h=()=>{const f=r;a(n),o(f)},m=f=>{f.preventDefault(),!(!r||!n||!i)&&t({from:r,to:n,date:i,adults:c})},p=new Date().toISOString().split("T")[0];return s.jsx(V,{className:"w-full shadow-lg border-2",children:s.jsx(G,{className:"p-6",children:s.jsxs("form",{onSubmit:m,className:"space-y-4",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(J,{htmlFor:"from",className:"flex items-center gap-2",children:[s.jsx(Ie,{className:"w-4 h-4"}),"From"]}),s.jsx(se,{id:"from",type:"text",placeholder:"Enter origin city",value:r,onChange:f=>a(f.target.value),required:!0,className:"h-12"})]}),s.jsx("div",{className:"flex items-end justify-center",children:s.jsx(P,{type:"button",variant:"outline",size:"icon",onClick:h,className:"rounded-full",children:s.jsx(Pp,{className:"w-4 h-4"})})}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(J,{htmlFor:"to",className:"flex items-center gap-2",children:[s.jsx(Ie,{className:"w-4 h-4"}),"To"]}),s.jsx(se,{id:"to",type:"text",placeholder:"Enter destination city",value:n,onChange:f=>o(f.target.value),required:!0,className:"h-12"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsxs(J,{htmlFor:"date",className:"flex items-center gap-2",children:[s.jsx(Be,{className:"w-4 h-4"}),"Travel Date"]}),s.jsx(se,{id:"date",type:"date",value:i,onChange:f=>l(f.target.value),min:p,required:!0,className:"h-12"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs(J,{htmlFor:"adults",className:"flex items-center gap-2",children:[s.jsx(ze,{className:"w-4 h-4"}),"Passengers"]}),s.jsx(se,{id:"adults",type:"number",min:"1",max:"10",value:c,onChange:f=>d(parseInt(f.target.value)||1),required:!0,className:"h-12"})]}),s.jsx("div",{className:"flex items-end",children:s.jsx(P,{type:"submit",disabled:e||!r||!n||!i,className:"w-full h-12 bg-gradient-to-r from-primary to-primary/80 hover:from-primary/90 hover:to-primary/70",size:"lg",children:e?s.jsxs(s.Fragment,{children:[s.jsx(Wt,{className:"w-4 h-4 mr-2 animate-spin"}),"Searching..."]}):s.jsxs(s.Fragment,{children:[s.jsx(Wt,{className:"w-4 h-4 mr-2"}),"Search Buses"]})})})]})]})})})},EC=({bus:t,onSelect:e})=>{const r=o=>{try{return new Date(o).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit"})}catch{return o}},a=o=>o.toLowerCase().includes("sleeper")?"":"",n=t.amenities||[];return s.jsx(V,{className:"hover:shadow-lg transition-shadow border-2",children:s.jsx(G,{className:"p-6",children:s.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[s.jsxs("div",{className:"flex-1 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold",children:t.operatorName||"Bus Operator"}),s.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-2 mt-1",children:[s.jsx("span",{children:a(t.busType)}),s.jsx("span",{children:t.busType||"Standard"})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"text-2xl font-bold text-primary",children:["",t.price?.toLocaleString("en-IN")||"N/A"]}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"per seat"})]})]}),s.jsxs("div",{className:"flex items-center gap-6",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Oa,{className:"w-4 h-4 text-primary"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:r(t.departureTime)}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Departure"})]})]}),s.jsx("div",{className:"flex-1 border-t-2 border-dashed border-muted"}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Oa,{className:"w-4 h-4 text-primary"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:r(t.arrivalTime)}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"Arrival"})]})]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[s.jsx(Oa,{className:"w-4 h-4"}),s.jsxs("span",{children:["Duration: ",t.duration||"N/A"]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[s.jsx(ze,{className:"w-4 h-4 text-green-600"}),s.jsxs("span",{className:"text-green-600 font-medium",children:[t.availableSeats||0," seats available"]})]}),n.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2",children:n.map((o,i)=>s.jsx("span",{className:"text-xs bg-muted px-2 py-1 rounded-full",children:o},i))})]}),s.jsx("div",{className:"flex items-center justify-end md:justify-start",children:s.jsx(P,{onClick:()=>e(t),className:"bg-primary hover:bg-primary/90 min-w-[120px]",children:"Select Bus"})})]})})})},kC=({seatLayout:t,onSeatSelect:e,selectedSeats:r,maxSeats:a=6})=>{const[n,o]=u.useState(r);u.useEffect(()=>{o(r)},[r]);const i=(h,m)=>{if(!m.isAvailable||m.isBooked){ee({title:"Seat Unavailable",description:"This seat is already booked or not available",variant:"destructive"});return}if(n.includes(h))o(n.filter(f=>f!==h));else{if(n.length>=a){ee({title:"Maximum Seats Reached",description:`You can select up to ${a} seats`,variant:"destructive"});return}o([...n,h])}},l=()=>{if(n.length===0){ee({title:"No Seats Selected",description:"Please select at least one seat",variant:"destructive"});return}e(n)},c=(h,m)=>h.isBooked||!h.isAvailable?"bg-red-500 text-white cursor-not-allowed":h.isLadiesSeat?n.includes(m)?"bg-pink-600 text-white":"bg-pink-200 text-pink-800 hover:bg-pink-300":n.includes(m)?"bg-green-600 text-white":"bg-gray-200 text-gray-800 hover:bg-gray-300",d=h=>h.seatType==="Sleeper"?s.jsx(Ap,{className:"w-4 h-4"}):s.jsx(ua,{className:"w-4 h-4"});return s.jsxs(V,{children:[s.jsx(_e,{children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs(Ee,{className:"flex items-center gap-2",children:[s.jsx(ze,{className:"w-5 h-5"}),"Select Your Seats"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs(Le,{variant:"outline",className:"bg-green-100 text-green-800",children:[n.length," Selected"]}),s.jsx(P,{onClick:l,disabled:n.length===0,size:"sm",children:"Confirm Selection"})]})]})}),s.jsxs(G,{children:[s.jsxs("div",{className:"flex flex-wrap gap-4 mb-6 p-4 bg-muted rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-8 h-8 bg-gray-200 rounded flex items-center justify-center",children:s.jsx(ua,{className:"w-4 h-4"})}),s.jsx("span",{className:"text-sm",children:"Available"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-8 h-8 bg-green-600 rounded flex items-center justify-center text-white",children:s.jsx(ua,{className:"w-4 h-4"})}),s.jsx("span",{className:"text-sm",children:"Selected"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-8 h-8 bg-pink-200 rounded flex items-center justify-center",children:s.jsx(ua,{className:"w-4 h-4"})}),s.jsx("span",{className:"text-sm",children:"Ladies Seat"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"w-8 h-8 bg-red-500 rounded flex items-center justify-center text-white",children:s.jsx(gr,{className:"w-4 h-4"})}),s.jsx("span",{className:"text-sm",children:"Booked"})]})]}),s.jsx("div",{className:"space-y-4",children:t.seatMap.map((h,m)=>s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("div",{className:"w-12 text-center text-sm font-medium",children:["Row ",m+1]}),s.jsx("div",{className:"flex-1 flex gap-2",children:h.map((p,f)=>{const b=p.seatNumber||`${m+1}-${f+1}`,g=n.includes(b);return s.jsxs("button",{onClick:()=>i(b,p),disabled:p.isBooked||!p.isAvailable,className:`
                        w-12 h-12 rounded-lg flex flex-col items-center justify-center
                        transition-all duration-200
                        ${c(p,b)}
                        ${g?"ring-2 ring-primary ring-offset-2":""}
                      `,title:`${b} - ${p.seatType}${p.isLadiesSeat?" (Ladies)":""}`,children:[d(p),s.jsx("span",{className:"text-xs font-medium mt-0.5",children:b})]},f)})})]},m))}),n.length>0&&s.jsxs("div",{className:"mt-6 p-4 bg-primary/10 rounded-lg",children:[s.jsx("p",{className:"font-semibold mb-2",children:"Selected Seats:"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:n.map(h=>s.jsx(Le,{variant:"secondary",className:"bg-primary text-primary-foreground",children:h},h))})]})]})]})};class TC{async searchBuses(e){const{endpoints:r}=await we(async()=>{const{endpoints:n}=await Promise.resolve().then(()=>Ve);return{endpoints:n}},void 0,import.meta.url),a=await ot();return await te(K(r.etrav.bus.search),{method:"POST",headers:a,body:e})}async getBusSeatLayout(e){const{endpoints:r}=await we(async()=>{const{endpoints:n}=await Promise.resolve().then(()=>Ve);return{endpoints:n}},void 0,import.meta.url),a=await ot();return await te(K(r.etrav.bus.seatLayout),{method:"POST",headers:a,body:{tripId:e}})}async blockBusSeats(e,r,a){const{endpoints:n}=await we(async()=>{const{endpoints:i}=await Promise.resolve().then(()=>Ve);return{endpoints:i}},void 0,import.meta.url),o=await ot();return await te(K(n.etrav.bus.block),{method:"POST",headers:o,body:{tripId:e,seatNumbers:r,passengerDetails:a}})}async bookBus(e,r,a,n){const{endpoints:o}=await we(async()=>{const{endpoints:l}=await Promise.resolve().then(()=>Ve);return{endpoints:l}},void 0,import.meta.url),i=await ot();return await te(K(o.etrav.bus.book),{method:"POST",headers:i,body:{blockId:e,paymentId:r,razorpayOrderId:a,bookingDetails:n}})}async searchFlights(e){const{endpoints:r}=await we(async()=>{const{endpoints:n}=await Promise.resolve().then(()=>Ve);return{endpoints:n}},void 0,import.meta.url),a=await ot();return await te(K(r.etrav.flight.search),{method:"POST",headers:a,body:e})}async getFareRules(e,r){const{endpoints:a}=await we(async()=>{const{endpoints:o}=await Promise.resolve().then(()=>Ve);return{endpoints:o}},void 0,import.meta.url),n=await ot();return await te(K(a.etrav.flight.fareRules),{method:"POST",headers:n,body:{resultIndex:e,traceId:r}})}async bookFlight(e,r,a,n,o){const{endpoints:i}=await we(async()=>{const{endpoints:c}=await Promise.resolve().then(()=>Ve);return{endpoints:c}},void 0,import.meta.url),l=await ot();return await te(K(i.etrav.flight.book),{method:"POST",headers:l,body:{resultIndex:e,traceId:r,paymentId:a,passengerDetails:n,bookingDetails:o}})}async searchHotels(e){const{endpoints:r}=await we(async()=>{const{endpoints:n}=await Promise.resolve().then(()=>Ve);return{endpoints:n}},void 0,import.meta.url),a=await ot();return await te(K(r.etrav.hotel.search),{method:"POST",headers:a,body:e})}async getRoomTypes(e,r){const{endpoints:a}=await we(async()=>{const{endpoints:o}=await Promise.resolve().then(()=>Ve);return{endpoints:o}},void 0,import.meta.url),n=await ot();return await te(K(a.etrav.hotel.roomTypes),{method:"POST",headers:n,body:{hotelId:e,resultIndex:r}})}async bookHotel(e,r,a,n,o){const{endpoints:i}=await we(async()=>{const{endpoints:c}=await Promise.resolve().then(()=>Ve);return{endpoints:c}},void 0,import.meta.url),l=await ot();return await te(K(i.etrav.hotel.book),{method:"POST",headers:l,body:{hotelId:e,roomId:r,paymentId:a,guestDetails:n,bookingDetails:o}})}}const Ia=new TC,PC=()=>{const{user:t}=mt(),e=Ls(),[r,a]=u.useState("search"),[n,o]=u.useState(!1),[i,l]=u.useState(null),[c,d]=u.useState([]),[h,m]=u.useState(null),[p,f]=u.useState(null),[b,g]=u.useState([]),[y,w]=u.useState(null),[v,x]=u.useState([]),[j,N]=u.useState(!1),[S,_]=u.useState(null),E=async H=>{o(!0),l(H);try{const O=await Ia.searchBuses(H);O.success&&O.data?(d(O.data),a("results")):ee({title:"Search Failed",description:O.message||"No buses found for this route",variant:"destructive"})}catch(O){ee({title:"Error",description:O.message||"Failed to search buses",variant:"destructive"})}finally{o(!1)}},k=async H=>{m(H),o(!0);try{const O=await Ia.getBusSeatLayout(H.tripId);O.success&&O.data?(f(O.data),a("seats")):ee({title:"Error",description:"Failed to load seat layout",variant:"destructive"})}catch(O){ee({title:"Error",description:O.message||"Failed to load seat layout",variant:"destructive"})}finally{o(!1)}},A=async H=>{if(!(!h||H.length===0)){o(!0);try{const O=H.map((z,R)=>({title:"Mr",firstName:t?.firstName||"Passenger",lastName:t?.lastName||`${R+1}`,age:25,gender:"Male",email:t?.email||"",phone:t?.phone||""}));x(O);const Y=await Ia.blockBusSeats(h.tripId,H,O);Y.success&&Y.data?(w(Y.data.blockId),g(H),a("payment")):ee({title:"Error",description:"Failed to block seats",variant:"destructive"})}catch(O){ee({title:"Error",description:O.message||"Failed to block seats",variant:"destructive"})}finally{o(!1)}}},B=async()=>{if(!(!h||!y||b.length===0)){o(!0);try{const H=b.length*(h.price||0),{orderId:O,razorpayOrder:Y}=await pr.addFunds(H),z=document.createElement("script");z.src="https://checkout.razorpay.com/v1/checkout.js",z.async=!0,z.onload=()=>{const R={key:"",amount:Y.amount,currency:Y.currency,name:"WanderSphere",description:`Bus booking - ${b.length} seat(s)`,order_id:O,handler:async C=>{try{const q=await Ia.bookBus(y,C.razorpay_payment_id,C.razorpay_order_id,{totalAmount:H,currency:"INR"});if(q.success&&q.data)_(q.data.pnr),N(!0),a("confirmation"),ee({title:"Booking Confirmed!",description:`Your PNR is: ${q.data.pnr}`});else throw new Error(q.message||"Booking failed")}catch(q){ee({title:"Booking Failed",description:q.message||"Failed to confirm booking",variant:"destructive"})}finally{o(!1)}},prefill:{email:t?.email||"",name:`${t?.firstName} ${t?.lastName}`.trim()||"User"},theme:{color:"#6366f1"},modal:{ondismiss:()=>{o(!1)}}};new window.Razorpay(R).open()},document.body.appendChild(z)}catch(H){ee({title:"Payment Error",description:H.message||"Failed to initiate payment",variant:"destructive"}),o(!1)}}},$=()=>{switch(r){case"search":return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsxs(P,{variant:"ghost",onClick:()=>e("/booking"),children:[s.jsx(ct,{className:"w-4 h-4 mr-2"}),"Back"]}),s.jsx("h1",{className:"text-3xl font-bold",children:"Book Bus Tickets"})]}),s.jsx(CC,{onSearch:E,isLoading:n})]});case"results":return s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsxs(P,{variant:"ghost",onClick:()=>a("search"),children:[s.jsx(ct,{className:"w-4 h-4 mr-2"}),"Back to Search"]}),s.jsxs("h2",{className:"text-2xl font-bold mt-2",children:[c.length," buses found"]})]})}),s.jsx("div",{className:"space-y-4",children:c.map((H,O)=>s.jsx(EC,{bus:H,onSelect:k},O))})]});case"seats":return p?s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsxs(P,{variant:"ghost",onClick:()=>a("results"),children:[s.jsx(ct,{className:"w-4 h-4 mr-2"}),"Back to Results"]}),s.jsx("h2",{className:"text-2xl font-bold mt-2",children:"Select Your Seats"}),s.jsxs("p",{className:"text-muted-foreground",children:[h?.operatorName," - ",h?.busType]})]})}),s.jsx(kC,{seatLayout:p,onSeatSelect:A,selectedSeats:b,maxSeats:6})]}):s.jsxs("div",{className:"text-center py-12",children:[s.jsx(ge,{className:"w-8 h-8 animate-spin mx-auto mb-4"}),s.jsx("p",{children:"Loading seat layout..."})]});case"payment":return s.jsx("div",{className:"space-y-6",children:s.jsxs(V,{children:[s.jsx(_e,{children:s.jsx(Ee,{children:"Booking Summary"})}),s.jsxs(G,{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold",children:h?.operatorName}),s.jsxs("p",{className:"text-sm text-muted-foreground",children:[h?.busType,"  ",b.length," seat(s)"]})]}),s.jsx("div",{children:s.jsxs("p",{className:"text-2xl font-bold",children:["",(b.length*(h?.price||0)).toLocaleString("en-IN")]})}),s.jsx(P,{onClick:B,disabled:n,className:"w-full",size:"lg",children:n?s.jsxs(s.Fragment,{children:[s.jsx(ge,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):"Proceed to Payment"})]})]})});case"confirmation":return s.jsx("div",{className:"space-y-6",children:s.jsx(V,{className:"border-green-500",children:s.jsxs(G,{className:"p-8 text-center",children:[s.jsx(ri,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),s.jsx("h2",{className:"text-3xl font-bold mb-2",children:"Booking Confirmed!"}),S&&s.jsxs("p",{className:"text-xl mb-4",children:["Your PNR: ",s.jsx("span",{className:"font-bold text-primary",children:S})]}),s.jsx("p",{className:"text-muted-foreground mb-6",children:"Your booking details have been sent to your email."}),s.jsxs("div",{className:"flex gap-4 justify-center",children:[s.jsx(P,{onClick:()=>e("/booking"),children:"View My Bookings"}),s.jsx(P,{variant:"outline",onClick:()=>{a("search"),d([]),m(null),g([]),N(!1)},children:"Book Another"})]})]})})});default:return null}};return s.jsx("div",{className:"max-w-6xl mx-auto px-4 py-6",children:$()})},AC=new lw({defaultOptions:{queries:{refetchOnWindowFocus:!1,refetchOnMount:!1,staleTime:300*1e3,gcTime:600*1e3,retry:1,retryDelay:1e3}}}),He=({children:t})=>{const{isAuthenticated:e,isLoading:r}=mt();return r?s.jsx("div",{className:"flex items-center justify-center min-h-screen",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):e?s.jsx(s.Fragment,{children:t}):s.jsx(Qc,{to:"/login",replace:!0})},RC=()=>s.jsxs(Lp,{children:[s.jsx($e,{path:"/login",element:s.jsx(jC,{})}),s.jsx($e,{path:"/register",element:s.jsx(NC,{})}),s.jsx($e,{path:"/",element:s.jsx(He,{children:s.jsx(FS,{})})}),s.jsx($e,{path:"/clubs",element:s.jsx(He,{children:s.jsx(y_,{})})}),s.jsx($e,{path:"/clubs/:id",element:s.jsx(He,{children:s.jsx(uC,{})})}),s.jsx($e,{path:"/find-trips",element:s.jsx(He,{children:s.jsx(w_,{})})}),s.jsx($e,{path:"/trips/:id",element:s.jsx(He,{children:s.jsx(pC,{})})}),s.jsx($e,{path:"/budget",element:s.jsx(He,{children:s.jsx(X_,{})})}),s.jsx($e,{path:"/budget/:id",element:s.jsx(He,{children:s.jsx(xC,{})})}),s.jsx($e,{path:"/map",element:s.jsx(He,{children:s.jsx(O_,{})})}),s.jsx($e,{path:"/journeys/:id",element:s.jsx(He,{children:s.jsx(gC,{})})}),s.jsx($e,{path:"/profile",element:s.jsx(He,{children:s.jsx(rC,{})})}),s.jsx($e,{path:"/settings",element:s.jsx(He,{children:s.jsx(iC,{})})}),s.jsx($e,{path:"/search",element:s.jsx(He,{children:s.jsx(lC,{})})}),s.jsx($e,{path:"/booking",element:s.jsx(He,{children:s.jsx(dC,{})})}),s.jsx($e,{path:"/booking/bus",element:s.jsx(He,{children:s.jsx(PC,{})})}),s.jsx($e,{path:"/notifications",element:s.jsx(He,{children:s.jsx(SC,{})})}),s.jsx($e,{path:"*",element:s.jsx(_C,{})})]}),IC=()=>s.jsx(jx,{children:s.jsx(dw,{client:AC,children:s.jsx(p0,{children:s.jsx(g0,{children:s.jsxs($y,{children:[s.jsx(yx,{}),s.jsx(ev,{}),s.jsx(Mp,{children:s.jsx(cS,{children:s.jsx(RC,{})})})]})})})})});zp.createRoot(document.getElementById("root")).render(s.jsx(IC,{}));
